function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"9JbG":function(e,t,i){"use strict";i.r(t),i.d(t,"InventoryPageModule",(function(){return te}));var n=i("ofXK"),c=i("3Pt+"),r=i("TEn/"),o=i("tyNb"),a=i("mrSG"),d=i("dfJG"),s=i("fXoL"),l=i("Sjme"),g=i("mvyS");function b(e,t){if(1&e&&(s.Ob(0,"div",5),s.pc(1),s.Nb()),2&e){var i=s.Yb(2);s.zb(1),s.rc(" ",i.dgService.toast.title," ")}}function f(e,t){if(1&e&&(s.Ob(0,"div",6),s.pc(1),s.Nb()),2&e){var i=s.Yb(2);s.zb(1),s.rc(" ",i.dgService.toast.body," ")}}function u(e,t){if(1&e&&(s.Ob(0,"div",9),s.Ob(1,"ion-button",10),s.Wb("click",(function(){return t.$implicit.fn()})),s.pc(2),s.Nb(),s.Nb()),2&e){var i=t.$implicit;s.zb(1),s.cc("color",i.color),s.zb(1),s.qc(i.action)}}function v(e,t){if(1&e&&(s.Ob(0,"div",7),s.oc(1,u,3,2,"div",8),s.Nb()),2&e){var i=s.Yb(2);s.zb(1),s.bc("ngForOf",i.dgService.toast.actions)}}function p(e,t){if(1&e&&(s.Ob(0,"div",1),s.oc(1,b,2,1,"div",2),s.oc(2,f,2,1,"div",3),s.oc(3,v,2,1,"div",4),s.Nb()),2&e){var i=s.Yb();s.zb(1),s.bc("ngIf",i.dgService.toast.title.length>0),s.zb(1),s.bc("ngIf",i.dgService.toast.body.length>0),s.zb(1),s.bc("ngIf",i.dgService.toast.actions.length>0)}}var h,m=((h=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||h)},h.\u0275cmp=s.Fb({type:h,selectors:[["app-toast"]],inputs:{dgService:"dgService"},decls:1,vars:1,consts:[["class","toast",4,"ngIf"],[1,"toast"],["class","title",4,"ngIf"],["class","body",4,"ngIf"],["class","actions",4,"ngIf"],[1,"title"],[1,"body"],[1,"actions"],["class","action",4,"ngFor","ngForOf"],[1,"action"],[3,"color","click"]],template:function(e,t){1&e&&s.oc(0,p,4,3,"div",0),2&e&&s.bc("ngIf",t.dgService.toast.visible)},directives:[n.j,n.i],styles:[".toast[_ngcontent-%COMP%]{width:600px;position:relative;left:calc(50% - 300px);background-color:#070709;color:#fff;border:2px solid #29383f;border-radius:10px;padding:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;box-shadow:0 0 10px #29383f;margin:20px 0}.actions[_ngcontent-%COMP%], .body[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{margin:20px 10px}.body[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{width:100%;text-align:center}.title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:700}.actions[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-evenly;align-items:center}.actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{min-width:150px;width:30%}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}"]}),h),k=i("PvpL"),C=i("Vtdy"),O=i("yqEA"),x=i("Y5WK");function y(e,t){if(1&e){var i=s.Pb();s.Ob(0,"div",15),s.Wb("click",(function(){s.jc(i);var e=t.$implicit;return s.Yb().setFilterAttribute(e)})),s.Mb(1,"ion-img",16),s.Nb()}if(2&e){var n=t.$implicit,c=s.Yb();s.Bb("attribute-filter-item filter-item filter-item-",n,""),s.zb(1),s.cc("src",c.util.getDiceFace(n))}}function M(e,t){if(1&e){var i=s.Pb();s.Ob(0,"app-dice-full",25),s.Wb("dblclick",(function(){s.jc(i);var e=s.Yb().$implicit;return s.Yb(2).selectAndClick(e)})),s.Nb()}if(2&e){var n=s.Yb().$implicit;s.bc("dice",n)}}function S(e,t){if(1&e&&(s.Ob(0,"div",23),s.oc(1,M,1,1,"app-dice-full",24),s.Nb()),2&e){var i=t.$implicit;s.zb(1),s.bc("ngIf",i.values.copies>0)}}function w(e,t){if(1&e&&(s.Ob(0,"h2"),s.pc(1),s.Nb()),2&e){var i=s.Yb(2);s.zb(1),s.rc("Dice Deck (",i.dgService.profile.diceCaboodle.getFiltered("isInDeck",!0).length,"/5)")}}function P(e,t){if(1&e){var i=s.Pb();s.Ob(0,"app-dice-full",25),s.Wb("dblclick",(function(){s.jc(i);var e=t.$implicit;return s.Yb(2).deselectAndClick(e)})),s.Nb()}2&e&&s.bc("dice",t.$implicit)}function _(e,t){if(1&e&&(s.Ob(0,"div",17),s.Ob(1,"h1"),s.pc(2,"Dice Collection"),s.Nb(),s.Ob(3,"div",18),s.oc(4,S,2,1,"div",19),s.Nb(),s.oc(5,w,2,1,"h2",20),s.Ob(6,"div",21),s.oc(7,P,1,1,"app-dice-full",22),s.Nb(),s.Nb()),2&e){var i=s.Yb();s.zb(4),s.bc("ngForOf",i.getDiceCollection()),s.zb(1),s.bc("ngIf",i.dgService.profile.sm.values.canModifyDeck),s.zb(2),s.bc("ngForOf",i.dgService.profile.diceCaboodle.getFiltered("isInDeck",!0))}}function I(e,t){if(1&e){var i=s.Pb();s.Ob(0,"app-card-mini",28),s.Wb("dblclick",(function(){s.jc(i);var e=s.Yb().$implicit;return s.Yb().selectAndClick(e)})),s.Nb()}if(2&e){var n=s.Yb().$implicit,c=s.Yb();s.bc("card",n)("numberCopies",n.values.copies)("board",c.dgService.board)}}function D(e,t){if(1&e&&(s.Ob(0,"div",26),s.oc(1,I,1,3,"app-card-mini",27),s.Nb()),2&e){var i=t.$implicit;s.zb(1),s.bc("ngIf",i.values.copies>0)}}function N(e,t){if(1&e){var i=s.Pb();s.Ob(0,"app-card-mini",29),s.Wb("dblclick",(function(){s.jc(i);var e=t.$implicit,n=t.index;return s.Yb().deselectAndClick(e,n)})),s.Nb()}if(2&e){var n=t.$implicit,c=s.Yb();s.bc("card",n)("board",c.dgService.board)}}var F,j=((F=function(){function e(t){_classCallCheck(this,e),this.util=d.k,this.isCardSelected=!1,this.isDiceSelected=!1,this.filters={attribute:"",cost:-1},this.diceCollectionLength=-1,this.dgService=t}return _createClass(e,[{key:"ngOnInit",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"selectCard",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.clearSelectedDice(),this.clearSelectedCards(),this.isDiceSelected=!1,this.isCardSelected=!0,i=this.dgService.profile.cardsCaboodle.getFiltered("originalHash",e.originalHash),e.sm.toggle("isSelected"),(n=i.filter((function(e){return!e.sm.values.isInDeck}))[0])||(n=e),n.sm.enable("isSelected");case 5:case"end":return t.stop()}}),t,this)})))}},{key:"selectDeckCard",value:function(e){this.clearSelectedCards(),e.sm.toggle("isSelected")}},{key:"selectDice",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.clearSelectedDice(),this.clearSelectedCards(),this.isDiceSelected=!0,this.isCardSelected=!1,e.sm.setValue("isSelected",!e.sm.values.isSelected);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"addToDeck",value:function(){this.isCardSelected&&!this.isDiceSelected&&this.addCardsToDeck(),this.isDiceSelected&&!this.isCardSelected&&this.addDiceToDeck()}},{key:"rmFromDeck",value:function(){}},{key:"viewItem",value:function(){}},{key:"addCardsToDeck",value:function(){for(var e=this.dgService.profile.cardsCaboodle.getFiltered("isSelected",!0),t=0;t<e.length;t++)e[t].sm.enable("isInDeck");this.clearSelectedCards()}},{key:"clearSelectedCards",value:function(){}},{key:"clearSelectedDice",value:function(){for(var e=this.dgService.profile.diceCaboodle.items,t=0;t<e.length;t++)e[t].sm.setState("deselected-"+e[t].hash)}},{key:"rmCardsFromDeck",value:function(){for(var e=this.dgService.profile.cardsCaboodle.getFiltered("isSelected",!0),t=0;t<e.length;t++)e[t].sm.setState("rmFromDeck-"+e[t].hash);this.clearSelectedCards()}},{key:"addDiceToDeck",value:function(){for(var e=this.dgService.profile.diceCaboodle.getFiltered("isSelected",!0),t=0;t<e.length;t++)e[t].sm.setState("addToDeck-"+e[t].hash);this.clearSelectedDice()}},{key:"rmDiceFromDeck",value:function(){for(var e=this.dgService.profile.diceCaboodle.getFiltered("isSelected",!0),t=0;t<e.length;t++)e[t].sm.setState("rmFromDeck-"+e[t].hash);this.clearSelectedDice()}},{key:"getBoosterPack",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dgService.profile.getBalance();case 2:this.dgService.profile.events.on("purchaseFn",(function(e){})),this.dgService.profile.events.emit("purchaseBg",{profile:this.dgService.profile,httpMessenger:this.httpMessenger});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"storeLocalDeck",value:function(){var e=this.dgService.profile.cardsCaboodle.getFiltered("isInDeck",!0).map((function(e){return{hash:e.hash,originalHash:e.originalHash}}));localStorage.setItem("deck",JSON.stringify(e));var t=this.dgService.profile.diceCaboodle.getFiltered("isInDeck",!0).map((function(e){return{hash:e.hash,originalHash:e.originalHash}}));localStorage.setItem("dice-deck",JSON.stringify(t))}},{key:"closeModal",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=this.dgService.profile.cardsCaboodle.getFiltered("isInDeck",!0),i=this.dgService.profile.diceCaboodle.getFiltered("isInDeck",!0),10===t.length&&5===i.length){e.next=4;break}return e.abrupt("return",this.dgService.showToast("Your deck must contain 10 cards and 5 dice"));case 4:return e.next=6,this.storeRemoteDeck();case 6:return e.next=8,d.k.sleep(500);case 8:return e.next=10,this.dgService.profile.getInventory();case 10:this.dgService.profile.loadActiveDeck(),this.dgService.profile.sm.disable("showCardCollectionModal"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error(e.t0);case 17:case"end":return e.stop()}}),e,this,[[0,14]])})))}},{key:"selectAndClick",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e instanceof x.a)){t.next=4;break}if(!(this.dgService.profile.diceCaboodle.getFiltered("isInDeck",!0).length>=5)){t.next=3;break}return t.abrupt("return");case 3:this.dgService.profile.diceCaboodle.getFiltered("originalHash",e.hash).length<=2&&(e.values.copies-=1,e.values.copiesInDeck+=1,this.dgService.board.diceCollection.update(e),(i=d.d.fromAbstract(this.dgService.events,e)).sm.enable("isInDeck"),i.sm.enable("isOwned"),console.log("dice",i),this.dgService.profile.diceCaboodle.add(i));case 4:if(!(e instanceof O.a)){t.next=8;break}if(!(this.dgService.profile.cardsCaboodle.getFiltered("isInDeck",!0).length>=10)){t.next=7;break}return t.abrupt("return");case 7:this.dgService.profile.cardsCaboodle.getFiltered("originalHash",e.hash).length<=2&&(e.values.copies-=1,e.values.copiesInDeck+=1,this.dgService.board.cardCollection.update(e),(n=d.b.fromAbstract(this.dgService.events,e)).sm.enable("isInDeck"),n.sm.enable("isOwned"),console.log("card",n),this.dgService.profile.cardsCaboodle.add(n));case 8:console.log("caboodle",this.dgService.profile.cardsCaboodle);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"deselectAndClick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=e instanceof d.d,!i.t0){i.next=5;break}return i.next=4,this.selectDice(e);case 4:this.rmDiceFromDeck();case 5:if(!(e instanceof d.b)){i.next=9;break}this.dgService.profile.cardsCaboodle.items.splice(t,1),(n=this.dgService.board.cardCollection.getFiltered("title",e.title)[0])&&(n.values.copies+=1,n.values.copiesInDeck-=1,this.dgService.board.cardCollection.update(n));case 9:case"end":return i.stop()}}),i,this)})))}},{key:"getFiltersAttributes",value:function(){return["water","fire","forest","wind","thunder","metal","light","dark","aether","neutral"]}},{key:"setFilterAttribute",value:function(e){var t=document.querySelectorAll(".attribute-filter-item"),i=!0;document.querySelector(".filter-item-"+e).classList.contains("active")&&(i=!1);for(var n=0;n<t.length;n++)t[n].classList.remove("active");i?(this.filters.attribute=e,document.querySelector(".filter-item-"+e).classList.add("active")):this.filters.attribute=""}},{key:"getDiceCollection",value:function(){var e=this;return this.dgService.profile.diceCaboodle.getFiltered("isInDeck",!0).map((function(e){return e.sm.values.originalHash})),""===this.filters.attribute?this.dgService.board.diceCollection.getAllCopiesOwned():this.dgService.board.diceCollection.getAllCopiesOwned().filter((function(t){return t.faces.includes(e.filters.attribute)}))}},{key:"getCardCollection",value:function(){var e=this,t=[],i=this.dgService.profile.cardsCaboodle.getFiltered("isInDeck",!0).map((function(e){return e.sm.values.originalHash}));if(""===this.filters.attribute)t=this.dgService.board.cardCollection.getFiltered("isOwned",!0,"attribute").filter((function(e){return!i.includes(e.hash)}));else{var n=this.dgService.board.cardCollection.getFiltered("isOwned",!0,"attribute");console.log("inDeck",n),t=n.filter((function(t){return!n.includes(t.hash)&&t.attribute===e.filters.attribute}))}return t}},{key:"getDiceDeck",value:function(){}},{key:"storeRemoteDeck",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,n,c,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.dgService.profile.cardsCaboodle.getFiltered("isInDeck",!0),i=this.dgService.profile.diceCaboodle.getFiltered("isInDeck",!0),n=[],c=0;c<t.length;c++)n.push({hash:t[c].sm.values.hash,originalHash:t[c].originalHash});for(r=[],o=0;o<i.length;o++)r.push({hash:i[o].sm.values.hash,originalHash:i[o].originalHash});return this.dgService.profile.sm.values.activeDeck.cards=n,this.dgService.profile.sm.values.activeDeck.dice=r,e.next=7,this.dgService.profile.postDeck(this.httpMessenger,this.dgService.profile.sm.values.activeDeck.title,{dice:r,cards:n},1);case 7:a=e.sent,console.log("postdeck res",a);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"cancelAndClose",value:function(){this.dgService.profile.sm.disable("showCardCollectionModal")}}]),e}()).\u0275fac=function(e){return new(e||F)(s.Lb(l.a))},F.\u0275cmp=s.Fb({type:F,selectors:[["app-card-collection"]],inputs:{httpMessenger:"httpMessenger"},decls:22,vars:7,consts:[[1,"main"],[1,"panel"],[1,"filters-container"],[1,"deck-title"],[1,"filter","attribute-filter"],[3,"class","click",4,"ngFor","ngForOf"],["class","dice-side",4,"ngIf"],[1,"cards-side",3,"ngClass"],[1,"grid","card-collection"],["class","deck-card-container",4,"ngFor","ngForOf"],[1,"card-deck-grid"],[3,"card","board","dblclick",4,"ngFor","ngForOf"],[1,"close-modal"],["color","light",3,"click"],["color","primary",3,"click"],[3,"click"],[1,"filter-icon",3,"src"],[1,"dice-side"],[1,"dice-grid"],["class","collection-dice-container",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"dice-grid","dice-grid-bottom"],[3,"dice","dblclick",4,"ngFor","ngForOf"],[1,"collection-dice-container"],[3,"dice","dblclick",4,"ngIf"],[3,"dice","dblclick"],[1,"deck-card-container"],[3,"card","numberCopies","board","dblclick",4,"ngIf"],[3,"card","numberCopies","board","dblclick"],[3,"card","board","dblclick"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"div",1),s.Ob(2,"div",2),s.Ob(3,"div",3),s.pc(4),s.Nb(),s.Ob(5,"div",4),s.oc(6,y,2,4,"div",5),s.Nb(),s.Nb(),s.oc(7,_,8,3,"div",6),s.Ob(8,"div",7),s.Ob(9,"h1"),s.pc(10,"Card Collection"),s.Nb(),s.Ob(11,"div",8),s.oc(12,D,2,1,"div",9),s.Nb(),s.Ob(13,"h2"),s.pc(14),s.Nb(),s.Ob(15,"div",10),s.oc(16,N,1,2,"app-card-mini",11),s.Nb(),s.Nb(),s.Nb(),s.Ob(17,"div",12),s.Ob(18,"ion-button",13),s.Wb("click",(function(){return t.cancelAndClose()})),s.pc(19,"Cancel"),s.Nb(),s.Ob(20,"ion-button",14),s.Wb("click",(function(){return t.closeModal()})),s.pc(21,"Done"),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.zb(4),s.rc(" ",t.dgService.profile.sm.values.activeDeck.title," "),s.zb(2),s.bc("ngForOf",t.getFiltersAttributes()),s.zb(1),s.bc("ngIf",t.dgService.profile.sm.values.canModifyDeck),s.zb(1),s.bc("ngClass",t.dgService.profile.sm.values.canModifyDeck?"":"cannot-edit"),s.zb(4),s.bc("ngForOf",t.getCardCollection()),s.zb(2),s.rc("Card Deck (",t.dgService.profile.cardsCaboodle.getFiltered("isInDeck",!0).length,"/10)"),s.zb(2),s.bc("ngForOf",t.dgService.profile.cardsCaboodle.getFiltered("isInDeck",!0)))},directives:[n.i,n.j,n.h,k.a,C.a],styles:[".main[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#070709;display:flex;justify-content:center;align-items:center}.close-modal[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px}.panel[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:space-evenly;align-items:center;background-color:#12191f;width:95%;height:90%;border-bottom:4px solid #243338;border-top:8px solid #c4812a;margin-top:80px;padding:20px}.filters-container[_ngcontent-%COMP%]{position:absolute;height:74px;top:-74px;width:95vw}.filter-item[_ngcontent-%COMP%], .filters-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.filter-item[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #243338;overflow:hidden;border-radius:100%}.filter-item.active[_ngcontent-%COMP%]{background-color:#c4812a}.filter-icon[_ngcontent-%COMP%]{width:80%}.attribute-filter[_ngcontent-%COMP%]{width:-webkit-min-content;width:-moz-min-content;width:min-content;border-color:#c4812a #c4812a #12191f;padding:0 20px}.attribute-filter[_ngcontent-%COMP%], .deck-title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background-color:#12191f;border-style:solid;border-width:8px 4px 4px;height:100%}.deck-title[_ngcontent-%COMP%]{position:absolute;left:0;width:20%;max-width:400px;text-overflow:ellipsis;border-color:#c4812a #c4812a #12191f #12191f;font-size:1.3em;color:#fff}.dice-side[_ngcontent-%COMP%]{width:400px;height:100%;justify-content:center}.dice-grid[_ngcontent-%COMP%], .dice-side[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column}.dice-grid[_ngcontent-%COMP%]{height:calc(100% - 400px);width:100%;overflow-y:scroll;overflow-x:hidden;justify-content:flex-start;background-color:#070709;border:2px solid #243338}.dice-grid-bottom[_ngcontent-%COMP%]{height:300px}.cards-side[_ngcontent-%COMP%]{height:100%;width:calc(95% - 400px);display:flex;justify-content:center;align-items:center;flex-direction:column}app-card-mini[_ngcontent-%COMP%]{margin:20px}.card-collection[_ngcontent-%COMP%]{justify-content:center;align-items:flex-start;flex-wrap:wrap;overflow-y:scroll;height:calc(100% - 400px)}.card-collection[_ngcontent-%COMP%], .card-deck-grid[_ngcontent-%COMP%]{display:flex;background-color:#070709;border:2px solid #243338}.card-deck-grid[_ngcontent-%COMP%]{justify-content:flex-start;align-items:center;overflow-y:hidden;overflow-x:scroll;height:300px;width:100%}.separator[_ngcontent-%COMP%]{width:90%;position:relative;left:5%;height:1px;background-color:#243338;margin:20px 0}h1[_ngcontent-%COMP%]{color:#c4812a;font-size:1.5em}h2[_ngcontent-%COMP%]{color:#fff;font-size:1.2em}.deck-card-container[_ngcontent-%COMP%]{padding:20px}"]}),F),z=i("aVLY"),A=function(e){return{active:e}};function Y(e,t){if(1&e){var i=s.Pb();s.Ob(0,"div",17),s.Wb("click",(function(){s.jc(i);var e=t.$implicit;return s.Yb().selectItem(e)})),s.Ob(1,"div",18),s.pc(2),s.Nb(),s.Ob(3,"div",19),s.Mb(4,"ion-img",20),s.Nb(),s.Ob(5,"div",21),s.pc(6),s.Nb(),s.Nb()}if(2&e){var n=t.$implicit;s.bc("ngClass",s.fc(4,A,1===n.active)),s.zb(2),s.rc(" ",n.title," "),s.zb(2),s.cc("src",n.data.url||"assets/icons/deck.png"),s.zb(2),s.rc(" \xb7 ",n.type.toUpperCase()," \xb7 ")}}function R(e,t){if(1&e&&(s.Ob(0,"div",28),s.Ob(1,"div",18),s.pc(2),s.Nb(),s.Ob(3,"div",19),s.Mb(4,"ion-img",20),s.Nb(),s.Ob(5,"div",21),s.pc(6),s.Nb(),s.Nb()),2&e){var i=s.Yb(2);s.zb(2),s.rc(" ",i.activeItem.title," "),s.zb(2),s.cc("src","assets/icons/deck.png"),s.zb(2),s.rc(" \xb7 ",i.activeItem.type.toUpperCase()," \xb7 ")}}function H(e,t){if(1&e&&(s.Ob(0,"div",28),s.Ob(1,"div",18),s.pc(2),s.Nb(),s.Ob(3,"div",19),s.Mb(4,"ion-img",20),s.Nb(),s.Ob(5,"div",21),s.pc(6),s.Nb(),s.Nb()),2&e){var i=s.Yb(2);s.zb(2),s.rc(" ",i.activeItem.title," "),s.zb(2),s.cc("src",i.activeItem.data.url),s.zb(2),s.rc(" \xb7 ",i.activeItem.type.toUpperCase()," \xb7 ")}}function $(e,t){if(1&e){var i=s.Pb();s.Ob(0,"ion-button",31),s.Wb("click",(function(){s.jc(i);var e=s.Yb(3);return e.activateAvatar(e.activeItem)})),s.pc(1,"Activate"),s.Nb()}}function W(e,t){if(1&e&&(s.Ob(0,"div",29),s.oc(1,$,2,0,"ion-button",30),s.Nb()),2&e){var i=s.Yb(2);s.zb(1),s.bc("ngIf",i.activeItem.active<1)}}function T(e,t){if(1&e){var i=s.Pb();s.Ob(0,"ion-button",36),s.Wb("click",(function(){s.jc(i);var e=s.Yb(3);return e.activateDeck(e.activeItem)})),s.pc(1,"Activate"),s.Nb()}}function q(e,t){if(1&e){var i=s.Pb();s.Ob(0,"div",32),s.oc(1,T,2,0,"ion-button",33),s.Ob(2,"ion-button",34),s.Wb("click",(function(){s.jc(i);var e=s.Yb(2);return e.editDeck(e.activeItem)})),s.pc(3,"Edit"),s.Nb(),s.Ob(4,"ion-button",35),s.Wb("click",(function(){s.jc(i);var e=s.Yb(2);return e.deleteDeck(e.activeItem)})),s.pc(5,"Delete"),s.Nb(),s.Nb()}if(2&e){var n=s.Yb(2);s.zb(1),s.bc("ngIf",n.activeItem.active<1)}}function L(e,t){1&e&&s.Mb(0,"app-dice-full",42),2&e&&s.bc("dice",t.$implicit)}function J(e,t){if(1&e&&s.Mb(0,"app-card-mini",43),2&e){var i=t.$implicit,n=s.Yb(3);s.bc("card",i)("board",n.dgService.board)}}function B(e,t){if(1&e&&(s.Ob(0,"div",37),s.Ob(1,"div",38),s.oc(2,L,1,1,"app-dice-full",39),s.Nb(),s.Ob(3,"div",40),s.oc(4,J,1,2,"app-card-mini",41),s.Nb(),s.Nb()),2&e){var i=s.Yb(2);s.zb(2),s.bc("ngForOf",i.getDiceInDeck(i.activeItem.data.dice)),s.zb(2),s.bc("ngForOf",i.getCardsInDeck(i.activeItem.data.cards))}}function E(e,t){if(1&e&&(s.Ob(0,"div",22),s.oc(1,R,7,3,"div",23),s.oc(2,H,7,3,"div",23),s.oc(3,W,2,1,"div",24),s.oc(4,q,6,1,"div",25),s.Ob(5,"div",26),s.oc(6,B,5,2,"div",27),s.Nb(),s.Nb()),2&e){var i=s.Yb();s.zb(1),s.bc("ngIf","deck"===i.activeItem.type),s.zb(1),s.bc("ngIf","avatar"===i.activeItem.type),s.zb(1),s.bc("ngIf","avatar"===i.activeItem.type),s.zb(1),s.bc("ngIf","deck"===i.activeItem.type),s.zb(2),s.bc("ngIf","deck"===i.activeItem.type)}}function V(e,t){if(1&e&&(s.Ob(0,"div",44),s.Mb(1,"app-card-collection",45),s.Nb()),2&e){var i=s.Yb();s.zb(1),s.bc("httpMessenger",i.dgService.httpMessenger)}}function G(e,t){if(1&e&&(s.Ob(0,"div",46),s.Mb(1,"app-card-full",43),s.Nb()),2&e){var i=s.Yb();s.zb(1),s.bc("card",i.dgService.board.sm.values.cardInDisplay)("board",i.dgService.board)}}var U,K,X,Z=[{path:"",component:(U=function(){function e(t){_classCallCheck(this,e),this.activeItem={},localStorage.getItem("auth-token")||(window.location.href="/access"),this.dgService=t}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"selectItem",value:function(e){this.activeItem=e,console.log("selected",e)}},{key:"getDiceInDeck",value:function(e){for(var t=[],i=0;i<e.length;i++){e[i].originalHash=d.k.hashPrefix(e[i].originalHash);var n=this.dgService.board.diceCollection.getFiltered("hash",e[i].originalHash)[0];n&&t.push(n)}return console.log(t),t}},{key:"createDeck",value:function(){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.querySelector("#new-deck-name").value.trim(),e.t0=0!==t.length,!e.t0){e.next=10;break}return e.next=5,this.dgService.profile.postDeck(this.dgService.httpMessenger,t,{cards:[],dice:[]},0);case 5:return e.next=7,d.k.sleep(500);case 7:return e.next=9,this.dgService.profile.getInventory();case 9:document.querySelector("#new-deck-name").value="";case 10:case"end":return e.stop()}}),e,this)})))}},{key:"getCardsInDeck",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],i=0;i<e.length;i++){e[i].originalHash=d.k.hashPrefix(e[i].originalHash);var n=this.dgService.board.cardCollection.getFiltered("hash",e[i].originalHash)[0];n&&t.push(n)}return t}},{key:"editDeck",value:function(e){var t=document.querySelector("#edit-deck");t.hasAttribute("disabled")||(t.setAttribute("disabled","true"),this.dgService.profile.sm.enable("showCardCollectionModal"),this.dgService.profile.sm.values.activeDeck.title=e.title,this.dgService.profile.sm.values.activeDeck.cards=e.data.cards,this.dgService.profile.sm.values.activeDeck.dice=e.data.dice,console.log(e.data.cards),this.dgService.profile.loadActiveDeck(e.data.cards,e.data.dice),console.log(this.dgService.profile.diceCaboodle),this.activeItem={},t.removeAttribute("disabled"))}},{key:"activateDeck",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=document.querySelector("#activate-deck"),t.t0=i.hasAttribute("disabled"),t.t0){t.next=16;break}return i.setAttribute("disabled","true"),this.dgService.profile.sm.values.activeDeck.title=e.title,this.dgService.profile.sm.values.activeDeck.cards=e.data.cards,this.dgService.profile.sm.values.activeDeck.dice=e.data.dice,t.next=9,this.dgService.profile.postDeck(this.dgService.httpMessenger,e.title,{card:e.data.cards,dice:e.data.dice},1);case 9:return this.activeItem={},this.dgService.showToast("Deck `"+e.title+"` activated"),t.next=13,d.k.sleep(500);case 13:return t.next=15,this.dgService.profile.getInventory();case 15:i.removeAttribute("disabled");case 16:case"end":return t.stop()}}),t,this)})))}},{key:"activateAvatar",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=document.querySelector("#activate-avatar"),t.t0=i.hasAttribute("disabled"),t.t0){t.next=13;break}return i.setAttribute("disabled","true"),t.next=6,this.dgService.profile.addAvatar(this.dgService.httpMessenger,e.data.url,e.data.title,1);case 6:return this.dgService.showToast("Avatar `"+e.title+"` activated"),this.activeItem={},t.next=10,d.k.sleep(500);case 10:return t.next=12,this.dgService.profile.getInventory();case 12:i.removeAttribute("disabled");case 13:case"end":return t.stop()}}),t,this)})))}},{key:"deleteDeck",value:function(e){return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(i=document.querySelector("#delete-deck")).hasAttribute("disabled")||(i.setAttribute("disabled","true"),this.dgService.showToast("Are you sure?","You are about to delete all decks named `"+e.title+"`. Do you want to proceed?",[{action:"No",color:"danger",fn:function(){i.removeAttribute("disabled"),n.dgService.toast.visible=!1}},{action:"Yes",color:"success",fn:function(){return Object(a.a)(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.dgService.toast.visible=!1,t.next=3,this.dgService.profile.deleteDeck(e.title,this.dgService.httpMessenger);case 3:return this.activeItem.active={},t.next=6,d.k.sleep(500);case 6:return t.next=8,this.dgService.profile.getInventory();case 8:i.removeAttribute("disabled");case 9:case"end":return t.stop()}}),t,this)})))}}]));case 2:case"end":return t.stop()}}),t,this)})))}}]),e}(),U.\u0275fac=function(e){return new(e||U)(s.Lb(l.a))},U.\u0275cmp=s.Fb({type:U,selectors:[["app-inventory"]],decls:18,vars:6,consts:[[1,"main"],[1,"panel"],[1,"panel-header"],[1,"item-filter"],[1,"new-deck-form"],[1,"text-container"],["id","new-deck-name","type","text","placeholder","Deck Name"],["color","primary",3,"click"],[1,"inventory-items","items"],["class","item",3,"ngClass","click",4,"ngFor","ngForOf"],["class","item-detail",4,"ngIf"],[1,"bottom-nav"],["activeTab","inventory",3,"profile"],["class","card-collection-modal",4,"ngIf"],["class","modal",4,"ngIf"],[1,"toaster"],[3,"dgService"],[1,"item",3,"ngClass","click"],[1,"item-title"],[1,"item-avatar"],[3,"src"],[1,"item-type"],[1,"item-detail"],["class","item",4,"ngIf"],["class","actions-avatar",4,"ngIf"],["class","actions-deck",4,"ngIf"],[1,"description"],["class","deck-detail",4,"ngIf"],[1,"item"],[1,"actions-avatar"],["id","activate-avatar","color","primary",3,"click",4,"ngIf"],["id","activate-avatar","color","primary",3,"click"],[1,"actions-deck"],["id","activate-deck","color","primary",3,"click",4,"ngIf"],["id","edit-deck","color","primary",3,"click"],["id","delete-deck","color","primary",3,"click"],["id","activate-deck","color","primary",3,"click"],[1,"deck-detail"],[1,"dice-deck"],[3,"dice",4,"ngFor","ngForOf"],[1,"card-deck"],[3,"card","board",4,"ngFor","ngForOf"],[3,"dice"],[3,"card","board"],[1,"card-collection-modal"],[3,"httpMessenger"],[1,"modal"]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"div",1),s.Ob(2,"div",2),s.Mb(3,"div",3),s.Ob(4,"div",4),s.Ob(5,"div",5),s.Mb(6,"ion-input",6),s.Nb(),s.Ob(7,"ion-button",7),s.Wb("click",(function(){return t.createDeck()})),s.pc(8,"+"),s.Nb(),s.Nb(),s.Nb(),s.Ob(9,"div",8),s.oc(10,Y,7,6,"div",9),s.Nb(),s.oc(11,E,7,5,"div",10),s.Nb(),s.Nb(),s.Ob(12,"div",11),s.Mb(13,"app-navigation",12),s.Nb(),s.oc(14,V,2,1,"div",13),s.oc(15,G,2,2,"div",14),s.Ob(16,"div",15),s.Mb(17,"app-toast",16),s.Nb()),2&e&&(s.zb(10),s.bc("ngForOf",t.dgService.profile.sm.values.inventory),s.zb(1),s.bc("ngIf",t.activeItem.active>=0),s.zb(2),s.bc("profile",t.dgService.profile),s.zb(1),s.bc("ngIf",t.dgService.profile.sm.values.showCardCollectionModal),s.zb(1),s.bc("ngIf",t.dgService.profile.sm.values.isLoggedIn&&t.dgService.board.sm.values.cardInDisplay),s.zb(2),s.bc("dgService",t.dgService))},directives:[r.f,r.p,r.b,n.i,n.j,g.a,m,n.h,r.e,k.a,C.a,j,z.a],styles:[".main[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;overflow:hidden;background-color:#070709;display:flex;justify-content:flex-start;align-items:center;flex-direction:column;padding-top:96px}.bottom-nav[_ngcontent-%COMP%]{width:80%;left:10%;height:128px;position:fixed;bottom:0}.panel[_ngcontent-%COMP%]{width:95%;max-width:100%;padding-top:25px;background-color:#12191f;border-bottom:4px solid #243338;border-top:8px solid #c4812a;justify-content:flex-start;height:calc(100vh - 256px);box-shadow:0 0 25px #000;border-radius:4px;position:relative}.panel[_ngcontent-%COMP%], .panel-header[_ngcontent-%COMP%]{display:flex;align-items:center}.panel-header[_ngcontent-%COMP%]{width:95vw;max-width:100vw;height:72px;top:-72px;position:absolute;z-index:2;justify-content:space-between}.item-filter[_ngcontent-%COMP%]{width:30%;height:100%;background-color:#12191f;border-right:4px solid #c4812a;border-bottom:4px solid #12191f;border-top:8px solid #c4812a}.item-filter[_ngcontent-%COMP%], .item-filter[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.item-filter[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:48px;height:48px;margin:0 20px;border:2px solid #243338;background-color:#091315;box-shadow:0 0 5px #000;transition:.3s}.item-filter[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:36px}.item-filter[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:hover{box-shadow:0 0 5px #fff}.item-filter[_ngcontent-%COMP%]   .icon.active[_ngcontent-%COMP%]{border:2px solid #c4812a}.new-deck-form[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;align-items:center;width:40%;height:100%;background-color:#12191f;border-left:4px solid #c4812a;border-bottom:4px solid #12191f;border-top:8px solid #c4812a}.new-deck-form[_ngcontent-%COMP%]   .text-container[_ngcontent-%COMP%]{width:70%}.new-deck-form[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{background-color:#29383f;border:2px solid #243338;margin:10px 0;text-align:center;color:#fff}.new-deck-form[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:48px}.inventory-items.items[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:flex-start;overflow-y:scroll;flex-wrap:wrap}.inventory-items.items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{width:256px;height:256px;margin:10px;border:2px solid #243338;border-radius:10px;display:flex;justify-content:space-between;align-items:center;flex-direction:column;padding-bottom:20px;background-color:#091315;transition:.3s}.inventory-items.items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{transition:.3s}.inventory-items.items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-avatar[_ngcontent-%COMP%]{width:128px;height:128px;border:2px solid #243338;border-radius:3px;overflow:hidden;background-color:#070709;padding:24px;display:flex;justify-content:center;align-items:center;transition:.3s}.inventory-items.items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-type[_ngcontent-%COMP%]{width:100%;text-align:center;color:#fff;font-size:1em;padding:5px 0}.inventory-items.items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:1.2em;padding:10px 0;color:#fff}.inventory-items.items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-deck-info[_ngcontent-%COMP%]{background-color:#000;border:1px solid #fff;color:#fff;border-radius:3px;display:flex;justify-content:space-evenly;align-items:center;flex-direction:column;width:128px;height:128px}.inventory-items.items[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]{border:2px solid #091315;background-color:#070709}.inventory-items.items[_ngcontent-%COMP%]   .item.active[_ngcontent-%COMP%]   .item-avatar[_ngcontent-%COMP%]{background-color:#243338}.inventory-items.items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover{text-shadow:0 0 5px #c4812a;border:2px solid #c4812a}.inventory-items.items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover   ion-img[_ngcontent-%COMP%]{filter:drop-shadow(0 0 5px #c4812a)}.inventory-items.items[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover   .item-avatar[_ngcontent-%COMP%]{border:2px solid #c4812a}.item-detail[_ngcontent-%COMP%]{width:700px;height:100%;border:2px solid #243338;background-color:#091315;justify-content:flex-start;margin:20px;overflow-y:scroll}.item-detail[_ngcontent-%COMP%], .item-detail[_ngcontent-%COMP%]   .dice-deck[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column}.item-detail[_ngcontent-%COMP%]   .dice-deck[_ngcontent-%COMP%]{justify-content:center}.item-detail[_ngcontent-%COMP%]   .card-deck[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.item-detail[_ngcontent-%COMP%]   .card-deck[_ngcontent-%COMP%]   app-card-mini[_ngcontent-%COMP%]{margin:20px}.item-detail[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{width:256px;height:256px;margin:10px;border:2px solid #243338;border-radius:10px;display:flex;justify-content:space-between;align-items:center;flex-direction:column;padding-bottom:20px;background-color:#091315;transition:.3s}.item-detail[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{transition:.3s}.item-detail[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-avatar[_ngcontent-%COMP%]{width:128px;height:128px;border:2px solid #243338;border-radius:3px;overflow:hidden;background-color:#070709;padding:24px;display:flex;justify-content:center;align-items:center;transition:.3s}.item-detail[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-type[_ngcontent-%COMP%]{width:100%;text-align:center;color:#fff;font-size:1em;padding:5px 0}.item-detail[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:1.2em;padding:10px 0;color:#fff}.item-detail[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-deck-info[_ngcontent-%COMP%]{background-color:#000;border:1px solid #fff;color:#fff;border-radius:3px;display:flex;justify-content:space-evenly;align-items:center;flex-direction:column;width:128px;height:128px}.modal[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center}.card-collection-modal[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]{position:fixed;left:0;top:0;width:100vw;height:100vh}.toaster[_ngcontent-%COMP%]{position:fixed;width:100%;top:0;left:0}"]}),U)}],Q=((K=function e(){_classCallCheck(this,e)}).\u0275mod=s.Jb({type:K}),K.\u0275inj=s.Ib({factory:function(e){return new(e||K)},imports:[[o.i.forChild(Z)],o.i]}),K),ee=i("j1ZV"),te=((X=function e(){_classCallCheck(this,e)}).\u0275mod=s.Jb({type:X}),X.\u0275inj=s.Ib({factory:function(e){return new(e||X)},imports:[[n.b,c.a,r.m,Q,ee.a]]}),X)}}]);