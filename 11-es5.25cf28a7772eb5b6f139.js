function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{XhEF:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="XhEF"},oLy0:function(e,t,n){parcelRequire=function(t,r,i,o){var a,c="function"==typeof parcelRequire&&parcelRequire;function s(e,i){if(!r[e]){if(!t[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!i&&o)return o(e,!0);if(c)return c(e,!0);if("string"==typeof e)return n("XhEF")(e);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}l.resolve=function(n){return t[e][1][n]||n},l.cache={};var d=r[e]=new s.Module(e);t[e][0].call(d.exports,l,d,d.exports,this)}return r[e].exports;function l(e){return s(l.resolve(e))}}s.isParcelRequire=!0,s.Module=function(e){this.id=e,this.bundle=s,this.exports={}},s.modules=t,s.cache=r,s.parent=c,s.register=function(e,n){t[e]=[function(e,t){t.exports=n},{}]};for(var d=0;d<i.length;d++)try{s(i[d])}catch(t){a||(a=t)}if(i.length){var l=s(i[i.length-1]);e.exports=l}if(parcelRequire=s,a)throw a;return s}({EgBh:[function(e,t,n){var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(r){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(r){return!0}}(),t.exports.binaryFeatures=r;var i=t.exports.BlobBuilder;function o(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(i=t.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),o.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},o.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);r.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},o.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var e=new i,t=0,n=this._parts.length;t<n;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},t.exports.BufferBuilder=o},{}],kdPp:[function(e,t,n){var r=e("./bufferbuilder").BufferBuilder,i=e("./bufferbuilder").binaryFeatures;function o(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function a(){this.bufferBuilder=new r}function c(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}t.exports={unpack:function(e){return new o(e).unpack()},pack:function(e){var t=new a;return t.pack(e),t.getBuffer()}},o.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},o.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},o.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},o.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},o.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},o.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},o.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},o.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},o.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},o.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},o.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),i=0,o="";i<e;)(t=r[i])<128?(o+=String.fromCharCode(t),i++):(192^t)<32?(n=(192^t)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=e,o},o.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},o.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},o.prototype.unpack_float=function(){var e=this.unpack_uint32();return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,(e>>23&255)-127-23)},o.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=(e>>20&2047)-1023;return(0==e>>31?1:-1)*((1048575&e|1048576)*Math.pow(2,n-20)+t*Math.pow(2,n-52))},o.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},a.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},a.prototype.pack=function(e){var t=typeof e;if("string"===t)this.pack_string(e);else if("number"===t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"===t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"===t)this.bufferBuilder.append(192);else{if("object"!==t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File||e instanceof Blob||e instanceof File)this.pack_bin(e);else if(n==ArrayBuffer)this.pack_bin(i.useArrayBufferView?new Uint8Array(e):e);else if("BYTES_PER_ELEMENT"in e)this.pack_bin(i.useArrayBufferView?new Uint8Array(e.buffer):e.buffer);else if(n==Object||n.toString().startsWith("class"))this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},a.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,c).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},a.prototype.pack_integer=function(e){if(e>=-32&&e<=127)this.bufferBuilder.append(255&e);else if(e>=0&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(e>=-0x8000000000000000&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(e>=0&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},a.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),a=t<<31|n+1023<<20|i/o&1048575,c=i%o;this.bufferBuilder.append(203),this.pack_int32(a),this.pack_int32(c)},a.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},a.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},a.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},a.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},a.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},a.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":"EgBh"}],iSxC:[function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.extractVersion=a,n.wrapPeerConnectionEvent=function(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var o=function(e){var t=n(e);t&&r(t)};return this._eventMap=this._eventMap||{},this._eventMap[r]=o,i.apply(this,[e,o])};var o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return o.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},n.disableLog=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(i=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},n.disableWarnings=function(e){return"boolean"!=typeof e?new Error("Argument type: "+r(e)+". Please use a boolean."):(o=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},n.log=function(){if("object"===("undefined"==typeof window?"undefined":r(window))){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function(e,t){o&&console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function(e){var t=e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n},n.compactObject=function e(t){return c(t)?Object.keys(t).reduce((function(n,r){var i=c(t[r]),o=i?e(t[r]):t[r],a=i&&!Object.keys(o).length;return void 0===o||a?n:Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,o))}),{}):t},n.walkStats=s,n.filterStats=function(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var o=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&s(e,n,i)}))})),i};var i=!0,o=!0;function a(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function c(e){return"[object Object]"===Object.prototype.toString.call(e)}function s(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?s(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){s(e,e.get(t),n)}))})))}},{}],s6SN:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var n=r.detectBrowser(e),a=function(e){if("object"!==i(e)||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",n)]=r.ideal,t.optional.push(a),(a={})[o("max",n)]=r.ideal,t.optional.push(a)):(a[o("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},c=function(e,r){if(n.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var c=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};c((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),c(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=a(e.audio)}if(e&&"object"===i(e.video)){var s=e.video.facingMode;s=s&&("object"===i(s)?s:{ideal:s});var d,l=n.version<66;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&(!t.mediaDevices.getSupportedConstraints||!t.mediaDevices.getSupportedConstraints().facingMode||l)&&(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?d=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(d=["front"]),d))return t.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return d.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&d.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=s.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=a(e.video),o("chrome: "+JSON.stringify(e)),r(e)}));e.video=a(e.video)}return o("chrome: "+JSON.stringify(e)),r(e)},s=function(e){return n.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=(function(e,n,r){c(e,(function(e){t.webkitGetUserMedia(e,n,(function(e){r&&r(s(e))}))}))}).bind(t),t.mediaDevices.getUserMedia){var d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return c(e,(function(e){return d(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(s(e))}))}))}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t="function"!=typeof WeakMap?null:new WeakMap;if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js"));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=r.log},{"../utils.js":"iSxC"}],VHa8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:n.video&&n.video.frameRate||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}},{}],uI5X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function(e){if("object"!==c(e)||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)r.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},n.shimGetSendersWithDtmf=function(e){if("object"===c(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===t.kind?e.createDTMFSender(t):null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===c(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}},n.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),r=n[0],i=n[1],o=n[2];if(arguments.length>0&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var a=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},c=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};return arguments.length>=2?t.apply(this,[function(e){i(c(a(e)))},r]):new Promise((function(n,r){t.apply(e,[function(e){n(c(a(e)))},r])})).then(i,o)}}},n.shimSenderReceiverGetStats=function(e){if("object"===c(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;i&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return r.filterStats(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,i=arguments[0];return this.getSenders().forEach((function(e){e.track===i&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===i&&(n?r=!0:n=e),e.track===i})),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}}},n.shimAddTrackRemoveTrackWithNative=s,n.shimAddTrackRemoveTrack=function(e){if(e.RTCPeerConnection){var t=r.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return s(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}i.apply(this,[t])};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var a=new e.MediaStream([t]);this._streams[n.id]=a,this._reverseStreams[a.id]=n,this.addStream(a)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=a({},t,(function(){var e=this,t=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[function(n){var r=l(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return l(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var c=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,n=(t=arguments[0]).sdp,Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})),c.apply(this,arguments)):c.apply(this,arguments);var e,t,n};var d=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=d.get.apply(this);return""===e.type?e:l(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function l(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t];n=n.replace(new RegExp(e._streams[r.id].id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=a({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?t.version<78&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},n.fixNegotiationNeeded=function(e){r.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t="function"!=typeof WeakMap?null:new WeakMap;if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils.js")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}}},{"../utils.js":"iSxC","./getusermedia":"s6SN","./getdisplaymedia":"VHa8"}],NZ1C:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=i?t[0]:t,!!t.length}}))};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t="function"!=typeof WeakMap?null:new WeakMap;if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils"))},{"../utils":"iSxC"}],YHvh:[function(e,t,n){"use strict";var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},r.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]},r.getMediaSections=function(e){var t=r.splitSections(e);return t.shift(),t},r.matchPrefix=function(e,t){return r.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},r.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){r.push(e.parameters[t]?t+"="+e.parameters[t]:t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},r.getIceParameters=function(e,t){var n=r.splitLines(e);return{usernameFragment:(n=n.concat(r.splitLines(t))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:n.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i],a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var c=r.parseRtpMap(a),s=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(c.parameters=s.length?r.parseFmtp(s[0]):{},c.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(c),c.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(c.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(r.parseExtmap(e))})),t},r.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)}));var i=0;return t.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=r.writeExtmap(e)})),n},r.parseRtpEncodingParameters=function(e){var t,n=[],i=r.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),a=-1!==i.fecMechanisms.indexOf("ULPFEC"),c=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),s=c.length>0&&c[0].ssrc,d=r.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));d.length>0&&d[0].length>1&&d[0][0]===s&&(t=d[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&t&&(r.rtx={ssrc:t}),n.push(r),o&&((r=JSON.parse(JSON.stringify(r))).fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(r))}})),0===n.length&&s&&n.push({ssrc:s});var l=r.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=l}))),n},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var i=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0,t.compound=0===i.length;var o=r.matchPrefix(e,"a=rtcp-mux");return t.mux=o.length>0,t},r.parseMsid=function(e){var t,n=r.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var i=r.matchPrefix(e,"a=ssrc:").map((function(e){return r.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(t=i[0].value.split(" "))[0],track:t[1]}:void 0},r.parseSctpDescription=function(e){var t,n=r.parseMLine(e),i=r.matchPrefix(e,"a=max-message-size:");i.length>0&&(t=parseInt(i[0].substr(19),10)),isNaN(t)&&(t=65536);var o=r.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(r.matchPrefix(e,"a=sctpmap:").length>0){var a=r.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:t}}},r.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){var i=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||r.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){var o=r.writeRtpDescription(e.kind,t);if(o+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",o+=e.direction?"a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var a="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),o},r.getDirection=function(e,t){for(var n=r.splitLines(e),i=0;i<n.length;i++)switch(n[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[i].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){var t=r.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=r.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}],NJ2u:[function(e,t,n){"use strict";var r=e("sdp");function i(e,t,n,i,o){var a=r.writeRtpDescription(e.kind,t);if(a+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":o||"active"),a+="a=mid:"+e.mid+"\r\n",a+=e.rtpSender&&e.rtpReceiver?"a=sendrecv\r\n":e.rtpSender?"a=sendonly\r\n":e.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",e.rtpSender){var c=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=c;var s="msid:"+(i?i.id:"-")+" "+c+"\r\n";a+="a="+s,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),a}function o(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),a=r(t.parameters.apt,i);return o&&a&&o.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&a.parameters.apt&&!i(r,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function a(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function c(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function s(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var l=function(n){var i=this,o=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){i[e]=o[e].bind(o)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw s("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var a=n.iceCandidatePoolSize;a>0;a--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=r.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(l.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(l.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),l.prototype.onicecandidate=null,l.prototype.onaddstream=null,l.prototype.ontrack=null,l.prototype.onremovestream=null,l.prototype.onsignalingstatechange=null,l.prototype.oniceconnectionstatechange=null,l.prototype.onconnectionstatechange=null,l.prototype.onicegatheringstatechange=null,l.prototype.onnegotiationneeded=null,l.prototype.ondatachannel=null,l.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},l.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},l.prototype.getConfiguration=function(){return this._config},l.prototype.getLocalStreams=function(){return this.localStreams},l.prototype.getRemoteStreams=function(){return this.remoteStreams},l.prototype._createTransceiver=function(e,t){var n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&this.transceivers.length>0)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var r=this._createIceAndDtlsTransports();n.iceTransport=r.iceTransport,n.dtlsTransport=r.dtlsTransport}return t||this.transceivers.push(n),n},l.prototype.addTrack=function(t,n){if(this._isClosed)throw s("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw s("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},l.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},l.prototype.removeTrack=function(t){if(this._isClosed)throw s("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw s("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},l.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},l.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},l.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},l.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},l.prototype._gather=function(t,n){var i=this,o=this.transceivers[n].iceGatherer;if(!o.onlocalcandidate){var a=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,o.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),o.onlocalcandidate=function(e){if(!(i.usingBundle&&n>0)){var a=new Event("icecandidate");a.candidate={sdpMid:t,sdpMLineIndex:n};var c=e.candidate,s=!c||0===Object.keys(c).length;if(s)"new"!==o.state&&"gathering"!==o.state||(o.state="completed");else{"new"===o.state&&(o.state="gathering"),c.component=1,c.ufrag=o.getLocalParameters().usernameFragment;var d=r.writeCandidate(c);a.candidate=Object.assign(a.candidate,r.parseCandidate(d)),a.candidate.candidate=d,a.candidate.toJSON=function(){return{candidate:a.candidate.candidate,sdpMid:a.candidate.sdpMid,sdpMLineIndex:a.candidate.sdpMLineIndex,usernameFragment:a.candidate.usernameFragment}}}var l=r.getMediaSections(i._localDescription.sdp);l[a.candidate.sdpMLineIndex]+=s?"a=end-of-candidates\r\n":"a="+a.candidate.candidate+"\r\n",i._localDescription.sdp=r.getDescription(i._localDescription.sdp)+l.join("");var p=i.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==i.iceGatheringState&&(i.iceGatheringState="gathering",i._emitGatheringStateChange()),s||i._dispatchEvent("icecandidate",a),p&&(i._dispatchEvent("icecandidate",new Event("icecandidate")),i.iceGatheringState="complete",i._emitGatheringStateChange())}},e.setTimeout((function(){a.forEach((function(e){o.onlocalcandidate(e)}))}),0)}},l.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},l.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},l.prototype._transceive=function(e,n,i){var a=o(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:r.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),i&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),a.encodings=e.recvEncodingParameters.length?e.recvEncodingParameters:[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},l.prototype.setLocalDescription=function(e){var t,n,i=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(s("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,i.signalingState)||i._isClosed)return Promise.reject(s("InvalidStateError","Can not set local "+e.type+" in state "+i.signalingState));if("offer"===e.type)t=r.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=r.parseRtpParameters(e);i.transceivers[t].localCapabilities=n})),i.transceivers.forEach((function(e,t){i._gather(e.mid,t)}));else if("answer"===e.type){t=r.splitSections(i._remoteDescription.sdp),n=t.shift();var c=r.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var a=i.transceivers[t],s=a.iceGatherer,d=a.iceTransport,l=a.dtlsTransport,p=a.localCapabilities,u=a.remoteCapabilities;if(!(r.isRejected(e)&&0===r.matchPrefix(e,"a=bundle-only").length||a.rejected)){var f=r.getIceParameters(e,n),b=r.getDtlsParameters(e,n);c&&(b.role="server"),i.usingBundle&&0!==t||(i._gather(a.mid,t),"new"===d.state&&d.start(s,f,c?"controlling":"controlled"),"new"===l.state&&l.start(b));var h=o(p,u);i._transceive(a,h.codecs.length>0,!1)}}))}return i._localDescription={type:e.type,sdp:e.sdp},i._updateSignalingState("offer"===e.type?"have-local-offer":"stable"),Promise.resolve()},l.prototype.setRemoteDescription=function(i){var l=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(s("TypeError",'Unsupported type "'+i.type+'"'));if(!a("setRemoteDescription",i.type,l.signalingState)||l._isClosed)return Promise.reject(s("InvalidStateError","Can not set remote "+i.type+" in state "+l.signalingState));var p={};l.remoteStreams.forEach((function(e){p[e.id]=e}));var u=[],f=r.splitSections(i.sdp),b=f.shift(),h=r.matchPrefix(b,"a=ice-lite").length>0,g=r.matchPrefix(b,"a=group:BUNDLE ").length>0;l.usingBundle=g;var m=r.matchPrefix(b,"a=ice-options:")[0];return l.canTrickleIceCandidates=!!m&&m.substr(14).split(" ").indexOf("trickle")>=0,f.forEach((function(a,s){var d=r.splitLines(a),f=r.getKind(a),m=r.isRejected(a)&&0===r.matchPrefix(a,"a=bundle-only").length,v=d[0].substr(2).split(" ")[2],y=r.getDirection(a,b),C=r.parseMsid(a),_=r.getMid(a)||r.generateIdentifier();if(m||"application"===f&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))l.transceivers[s]={mid:_,kind:f,protocol:v,rejected:!0};else{var O,P,k,w,x,M,S,T,R;!m&&l.transceivers[s]&&l.transceivers[s].rejected&&(l.transceivers[s]=l._createTransceiver(f,!0));var D,E,N=r.parseRtpParameters(a);m||(D=r.getIceParameters(a,b),(E=r.getDtlsParameters(a,b)).role="client"),S=r.parseRtpEncodingParameters(a);var I=r.parseRtcpParameters(a),j=r.matchPrefix(a,"a=end-of-candidates",b).length>0,z=r.matchPrefix(a,"a=candidate:").map((function(e){return r.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!m&&g&&s>0&&l.transceivers[s]&&(l._disposeIceAndDtlsTransports(s),l.transceivers[s].iceGatherer=l.transceivers[0].iceGatherer,l.transceivers[s].iceTransport=l.transceivers[0].iceTransport,l.transceivers[s].dtlsTransport=l.transceivers[0].dtlsTransport,l.transceivers[s].rtpSender&&l.transceivers[s].rtpSender.setTransport(l.transceivers[0].dtlsTransport),l.transceivers[s].rtpReceiver&&l.transceivers[s].rtpReceiver.setTransport(l.transceivers[0].dtlsTransport)),"offer"!==i.type||m)"answer"!==i.type||m||(P=(O=l.transceivers[s]).iceGatherer,k=O.iceTransport,w=O.dtlsTransport,x=O.rtpReceiver,M=O.sendEncodingParameters,T=O.localCapabilities,l.transceivers[s].recvEncodingParameters=S,l.transceivers[s].remoteCapabilities=N,l.transceivers[s].rtcpParameters=I,z.length&&"new"===k.state&&(!h&&!j||g&&0!==s?z.forEach((function(e){c(O.iceTransport,e)})):k.setRemoteCandidates(z)),g&&0!==s||("new"===k.state&&k.start(P,D,"controlling"),"new"===w.state&&w.start(E)),!o(O.localCapabilities,O.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&O.sendEncodingParameters[0].rtx&&delete O.sendEncodingParameters[0].rtx,l._transceive(O,"sendrecv"===y||"recvonly"===y,"sendrecv"===y||"sendonly"===y),!x||"sendrecv"!==y&&"sendonly"!==y?delete O.rtpReceiver:(R=x.track,C?(p[C.stream]||(p[C.stream]=new e.MediaStream),n(R,p[C.stream]),u.push([R,x,p[C.stream]])):(p.default||(p.default=new e.MediaStream),n(R,p.default),u.push([R,x,p.default]))));else{(O=l.transceivers[s]||l._createTransceiver(f)).mid=_,O.iceGatherer||(O.iceGatherer=l._createIceGatherer(s,g)),z.length&&"new"===O.iceTransport.state&&(!j||g&&0!==s?z.forEach((function(e){c(O.iceTransport,e)})):O.iceTransport.setRemoteCandidates(z)),T=e.RTCRtpReceiver.getCapabilities(f),t<15019&&(T.codecs=T.codecs.filter((function(e){return"rtx"!==e.name}))),M=O.sendEncodingParameters||[{ssrc:1001*(2*s+2)}];var F,A=!1;"sendrecv"===y||"sendonly"===y?(A=!O.rtpReceiver,x=O.rtpReceiver||new e.RTCRtpReceiver(O.dtlsTransport,f),A&&(R=x.track,C&&"-"===C.stream||(C?(p[C.stream]||(p[C.stream]=new e.MediaStream,Object.defineProperty(p[C.stream],"id",{get:function(){return C.stream}})),Object.defineProperty(R,"id",{get:function(){return C.track}}),F=p[C.stream]):(p.default||(p.default=new e.MediaStream),F=p.default)),F&&(n(R,F),O.associatedRemoteMediaStreams.push(F)),u.push([R,x,F]))):O.rtpReceiver&&O.rtpReceiver.track&&(O.associatedRemoteMediaStreams.forEach((function(t){var n,r,i=t.getTracks().find((function(e){return e.id===O.rtpReceiver.track.id}));i&&((r=t).removeTrack(n=i),r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:n})))})),O.associatedRemoteMediaStreams=[]),O.localCapabilities=T,O.remoteCapabilities=N,O.rtpReceiver=x,O.rtcpParameters=I,O.sendEncodingParameters=M,O.recvEncodingParameters=S,l._transceive(l.transceivers[s],!1,A)}}})),void 0===l._dtlsRole&&(l._dtlsRole="offer"===i.type?"active":"passive"),l._remoteDescription={type:i.type,sdp:i.sdp},l._updateSignalingState("offer"===i.type?"have-remote-offer":"stable"),Object.keys(p).forEach((function(t){var n=p[t];if(n.getTracks().length){if(-1===l.remoteStreams.indexOf(n)){l.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout((function(){l._dispatchEvent("addstream",r)}))}u.forEach((function(e){n.id===e[2].id&&d(l,e[0],e[1],[n])}))}})),u.forEach((function(e){e[2]||d(l,e[0],e[1],[])})),e.setTimeout((function(){l&&l.transceivers&&l.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},l.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},l.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},l.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},l.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},l.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},l.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(s("InvalidStateError","Can not call createOffer after close"));var o=n.transceivers.filter((function(e){return"audio"===e.kind})).length,a=n.transceivers.filter((function(e){return"video"===e.kind})).length,c=arguments[0];if(c){if(c.mandatory||c.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==c.offerToReceiveAudio&&(o=!0===c.offerToReceiveAudio?1:!1===c.offerToReceiveAudio?0:c.offerToReceiveAudio),void 0!==c.offerToReceiveVideo&&(a=!0===c.offerToReceiveVideo?1:!1===c.offerToReceiveVideo?0:c.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--o<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));o>0||a>0;)o>0&&(n._createTransceiver("audio"),o--),a>0&&(n._createTransceiver("video"),a--);var d=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(i,o){var a=i.track,c=i.kind,s=i.mid||r.generateIdentifier();i.mid=s,i.iceGatherer||(i.iceGatherer=n._createIceGatherer(o,n.usingBundle));var d=e.RTCRtpSender.getCapabilities(c);t<15019&&(d.codecs=d.codecs.filter((function(e){return"rtx"!==e.name}))),d.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),i.remoteCapabilities&&i.remoteCapabilities.codecs&&i.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),d.headerExtensions.forEach((function(e){(i.remoteCapabilities&&i.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var l=i.sendEncodingParameters||[{ssrc:1001*(2*o+1)}];a&&t>=15019&&"video"===c&&!l[0].rtx&&(l[0].rtx={ssrc:l[0].ssrc+1}),i.wantReceive&&(i.rtpReceiver=new e.RTCRtpReceiver(i.dtlsTransport,c)),i.localCapabilities=d,i.sendEncodingParameters=l})),"max-compat"!==n._config.bundlePolicy&&(d+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){d+=i(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+r.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(l)},l.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(s("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(s("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var a=r.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(a+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var c=r.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,r){if(!(r+1>c)){if(e.rejected)return"application"===e.kind?a+="DTLS/SCTP"===e.protocol?"m=application 0 DTLS/SCTP 5000\r\n":"m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var s;e.stream&&("audio"===e.kind?s=e.stream.getAudioTracks()[0]:"video"===e.kind&&(s=e.stream.getVideoTracks()[0]),s&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var d=o(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=i(e,d,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}}));var d=new e.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(d)},l.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(i,o){if(!n._remoteDescription)return o(s("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var a=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===e.sdpMid){a=d;break}var l=n.transceivers[a];if(!l)return o(s("OperationError","Can not add ICE candidate"));if(l.rejected)return i();var p=Object.keys(e.candidate).length>0?r.parseCandidate(e.candidate):{};if("tcp"===p.protocol&&(0===p.port||9===p.port))return i();if(p.component&&1!==p.component)return i();if((0===a||a>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!c(l.iceTransport,p))return o(s("OperationError","Can not add ICE candidate"));var u=e.candidate.trim();0===u.indexOf("a=")&&(u=u.substr(2)),(t=r.getMediaSections(n._remoteDescription.sdp))[a]+="a="+(p.type?u:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var f=0;f<n.transceivers.length&&(n.transceivers[f].rejected||(n.transceivers[f].iceTransport.addRemoteCandidate({}),(t=r.getMediaSections(n._remoteDescription.sdp))[f]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=r.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));f++);i()}))},l.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw s("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])})),t}))}}}));var p=["createOffer","createAnswer"];return p.forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(p=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=l.prototype[e];l.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),l}},{sdp:"YHvh"}],YdKx:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}},{}],P3bV:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}},{}],XRic:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var a=(0,o.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,i.filterIceServers)(e.iceServers,t.version),r.log("ICE servers after filtering:",e.iceServers)),new a(e)},e.RTCPeerConnection.prototype=a.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return a.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return c.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t="function"!=typeof WeakMap?null:new WeakMap;if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),i=e("./filtericeservers"),o=function(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim")),a=e("./getusermedia"),c=e("./getdisplaymedia")},{"../utils":"iSxC","./filtericeservers":"NZ1C","rtcpeerconnection-shim":"NJ2u","./getusermedia":"YdKx","./getdisplaymedia":"P3bV"}],GzSv:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,o=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},c=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===i(e)&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),a(e.audio,"autoGainControl","mozAutoGainControl"),a(e.audio,"noiseSuppression","mozNoiseSuppression")),c(e)},o&&o.prototype.getSettings){var s=o.prototype.getSettings;o.prototype.getSettings=function(){var e=s.apply(this,arguments);return a(e,"mozAutoGainControl","autoGainControl"),a(e,"mozNoiseSuppression","noiseSuppression"),e}}if(o&&o.prototype.applyConstraints){var d=o.prototype.applyConstraints;o.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===i(e)&&(e=JSON.parse(JSON.stringify(e)),a(e,"autoGainControl","mozAutoGainControl"),a(e,"noiseSuppression","mozNoiseSuppression")),d.apply(this,[e])}}}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t="function"!=typeof WeakMap?null:new WeakMap;if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC"}],UuGU:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}},{}],Fzdr:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimOnTrack=function(e){"object"===a(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimPeerConnection=function(e){var t=r.detectBrowser(e);if("object"===a(e)&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){if(!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]})),t.version<68){var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),n=e[0],r=e[1],a=e[2];return o.apply(this,[n||null]).then((function(e){if(t.version<53&&!r)try{e.forEach((function(e){e.type=i[e.type]||e.type}))}catch(a){if("TypeError"!==a.name)throw a;e.forEach((function(t,n){e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(r,a)}}},n.shimSenderGetStats=function(e){if("object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},n.shimReceiverGetStats=function(e){if("object"===a(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),r.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},n.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})},n.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var i=r.sender,o=i.getParameters();"encodings"in o||(o.encodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(o).catch((function(){}))))}return r})}},n.shimCreateOffer=function(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},n.shimCreateAnswer=function(e){if("object"===a(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}},Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return i.shimGetUserMedia}}),Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return o.shimGetDisplayMedia}});var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t="function"!=typeof WeakMap?null:new WeakMap;if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils")),i=e("./getusermedia"),o=e("./getdisplaymedia");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}},{"../utils":"iSxC","./getusermedia":"GzSv","./getdisplaymedia":"UuGU"}],t1lL:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimLocalStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}},n.shimRemoteStreamsAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function(e){if("object"===i(e)&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,o=t.setLocalDescription,a=t.setRemoteDescription,c=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,t.setRemoteDescription=s=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s=function(e,t,n){var r=c.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r}}},n.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(o(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=(function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}).bind(t))},n.shimConstraints=o,n.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var i=[],o=0;o<e.iceServers.length;o++){var a=e.iceServers[o];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(r.deprecated("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,i.push(a)):i.push(e.iceServers[o])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function(e){"object"===i(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return t.apply(this,arguments)}};var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t="function"!=typeof WeakMap?null:new WeakMap;if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("../utils"));function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return e&&void 0!==e.video?Object.assign({},e,{video:r.compactObject(e.video)}):e}},{"../utils":"iSxC"}],GOQK:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&(!e.RTCIceCandidate||!("foundation"in e.RTCIceCandidate.prototype))){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===function(e){return("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}(e)&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),i=r.default.parseCandidate(e.candidate),o=Object.assign(n,i);return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,i.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}},n.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=i.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),i=e.sdpSemantics;"plan-b"===i&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;var t=r.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=r.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))}(arguments[0])){var o,a=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n}(arguments[0]),c=(l=a,p=65536,"firefox"===t.browser&&(p=t.version<57?-1===l?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),p),s=function(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var o=r.default.matchPrefix(e.sdp,"a=max-message-size:");return o.length>0?i=parseInt(o[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],a);o=0===c&&0===s?Number.POSITIVE_INFINITY:0===c||0===s?Math.max(c,s):Math.min(c,s);var d={};Object.defineProperty(d,"maxMessageSize",{get:function(){return o}}),this._sctp=d}var l,p;return n.apply(this,arguments)}}},n.shimSendThrowTypeError=function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},i.wrapPeerConnectionEvent(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}},n.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}},n.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=i.detectBrowser(e);if(!("chrome"===t.browser&&t.version>=71)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n")),n.apply(this,arguments)}}}};var r=function(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t="function"!=typeof WeakMap?null:new WeakMap;if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}(e("./utils"))},{sdp:"YHvh","./utils":"iSxC"}],KtlG:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},d=r.log,l=r.detectBrowser(t),p={browserDetails:l,commonShim:s,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(l.browser){case"chrome":if(!i||!i.shimPeerConnection||!n.shimChrome)return d("Chrome shim is not included in this adapter release."),p;d("adapter.js shimming chrome."),p.browserShim=i,i.shimGetUserMedia(t),i.shimMediaStream(t),i.shimPeerConnection(t),i.shimOnTrack(t),i.shimAddTrackRemoveTrack(t),i.shimGetSendersWithDtmf(t),i.shimGetStats(t),i.shimSenderReceiverGetStats(t),i.fixNegotiationNeeded(t),s.shimRTCIceCandidate(t),s.shimConnectionState(t),s.shimMaxMessageSize(t),s.shimSendThrowTypeError(t),s.removeAllowExtmapMixed(t);break;case"firefox":if(!a||!a.shimPeerConnection||!n.shimFirefox)return d("Firefox shim is not included in this adapter release."),p;d("adapter.js shimming firefox."),p.browserShim=a,a.shimGetUserMedia(t),a.shimPeerConnection(t),a.shimOnTrack(t),a.shimRemoveStream(t),a.shimSenderGetStats(t),a.shimReceiverGetStats(t),a.shimRTCDataChannel(t),a.shimAddTransceiver(t),a.shimCreateOffer(t),a.shimCreateAnswer(t),s.shimRTCIceCandidate(t),s.shimConnectionState(t),s.shimMaxMessageSize(t),s.shimSendThrowTypeError(t);break;case"edge":if(!o||!o.shimPeerConnection||!n.shimEdge)return d("MS edge shim is not included in this adapter release."),p;d("adapter.js shimming edge."),p.browserShim=o,o.shimGetUserMedia(t),o.shimGetDisplayMedia(t),o.shimPeerConnection(t),o.shimReplaceTrack(t),s.shimMaxMessageSize(t),s.shimSendThrowTypeError(t);break;case"safari":if(!c||!n.shimSafari)return d("Safari shim is not included in this adapter release."),p;d("adapter.js shimming safari."),p.browserShim=c,c.shimRTCIceServerUrls(t),c.shimCreateOfferLegacy(t),c.shimCallbacksAPI(t),c.shimLocalStreamsAPI(t),c.shimRemoteStreamsAPI(t),c.shimTrackEventTransceiver(t),c.shimGetUserMedia(t),s.shimRTCIceCandidate(t),s.shimMaxMessageSize(t),s.shimSendThrowTypeError(t),s.removeAllowExtmapMixed(t);break;default:d("Unsupported browser!")}return p};var r=l(e("./utils")),i=l(e("./chrome/chrome_shim")),o=l(e("./edge/edge_shim")),a=l(e("./firefox/firefox_shim")),c=l(e("./safari/safari_shim")),s=l(e("./common_shim"));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=r?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}},{"./utils":"iSxC","./chrome/chrome_shim":"uI5X","./edge/edge_shim":"XRic","./firefox/firefox_shim":"Fzdr","./safari/safari_shim":"t1lL","./common_shim":"GOQK"}],tI1X:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=(0,e("./adapter_factory.js").adapterFactory)({window:window});n.default=r},{"./adapter_factory.js":"KtlG"}],sXtV:[function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("webrtc-adapter"));n.webRTCAdapter=i.default},{"webrtc-adapter":"tI1X"}],I31f:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./adapter");n.Supports=new(function(){function e(){this.isIOS=["iPad","iPhone","iPod"].includes(navigator.platform),this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}return e.prototype.isWebRTCSupported=function(){return"undefined"!=typeof RTCPeerConnection},e.prototype.isBrowserSupported=function(){var e=this.getBrowser(),t=this.getVersion();return!!this.supportedBrowsers.includes(e)&&("chrome"===e?t>=this.minChromeVersion:"firefox"===e?t>=this.minFirefoxVersion:"safari"===e&&!this.isIOS&&t>=this.minSafariVersion)},e.prototype.getBrowser=function(){return r.webRTCAdapter.browserDetails.browser},e.prototype.getVersion=function(){return r.webRTCAdapter.browserDetails.version||0},e.prototype.isUnifiedPlanSupported=function(){var e,t=this.getBrowser(),n=r.webRTCAdapter.browserDetails.version||0;if("chrome"===t&&n<72)return!1;if("firefox"===t&&n>=59)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var i=!1;try{(e=new RTCPeerConnection).addTransceiver("audio"),i=!0}catch(o){}finally{e&&e.close()}return i},e.prototype.toString=function(){return"Supports: \n    browser:"+this.getBrowser()+" \n    version:"+this.getVersion()+" \n    isIOS:"+this.isIOS+" \n    isWebRTCSupported:"+this.isWebRTCSupported()+" \n    isBrowserSupported:"+this.isBrowserSupported()+" \n    isUnifiedPlanSupported:"+this.isUnifiedPlanSupported()},e}())},{"./adapter":"sXtV"}],BHXf:[function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e("peerjs-js-binarypack")),o=e("./supports"),a={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:0.peerjs.com:3478",username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};n.util=new(function(){function e(){this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.chunkedMTU=16300,this.defaultConfig=a,this.browser=o.Supports.getBrowser(),this.browserVersion=o.Supports.getVersion(),this.supports=function(){var e,t={browser:o.Supports.isBrowserSupported(),webRTC:o.Supports.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;try{e=new RTCPeerConnection(a),t.audioVideo=!0;var n=void 0;try{n=e.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!n.ordered;try{n.binaryType="blob",t.binaryBlob=!o.Supports.isIOS}catch(r){}}catch(r){}finally{n&&n.close()}}catch(r){}finally{e&&e.close()}return t}(),this.pack=i.pack,this.unpack=i.unpack,this._dataCount=1}return e.prototype.noop=function(){},e.prototype.validateId=function(e){return!e||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(e)},e.prototype.chunk=function(e){for(var t=[],r=e.size,i=Math.ceil(r/n.util.chunkedMTU),o=0,a=0;a<r;){var c=Math.min(r,a+n.util.chunkedMTU),s=e.slice(a,c);t.push({__peerData:this._dataCount,n:o,data:s,total:i}),a=c,o++}return this._dataCount++,t},e.prototype.blobToArrayBuffer=function(e,t){var n=new FileReader;return n.onload=function(e){e.target&&t(e.target.result)},n.readAsArrayBuffer(e),n},e.prototype.binaryStringToArrayBuffer=function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=255&e.charCodeAt(n);return t.buffer},e.prototype.randomToken=function(){return Math.random().toString(36).substr(2)},e.prototype.isSecure=function(){return"https:"===location.protocol},e}())},{"peerjs-js-binarypack":"kdPp","./supports":"I31f"}],JJlS:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,i="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function c(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var c=new a(n,r||e,o),s=i?i+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],c]:e._events[s].push(c):(e._events[s]=c,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function d(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(i=!1)),d.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},d.prototype.listeners=function(e){var t=this._events[i?i+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,r=t.length,o=new Array(r);n<r;n++)o[n]=t[n].fn;return o},d.prototype.listenerCount=function(e){var t=this._events[i?i+e:e];return t?t.fn?1:t.length:0},d.prototype.emit=function(e,t,n,r,o,a){var c=i?i+e:e;if(!this._events[c])return!1;var s,d,l=this._events[c],p=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),p){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(d=1,s=new Array(p-1);d<p;d++)s[d-1]=arguments[d];l.fn.apply(l.context,s)}else{var u,f=l.length;for(d=0;d<f;d++)switch(l[d].once&&this.removeListener(e,l[d].fn,void 0,!0),p){case 1:l[d].fn.call(l[d].context);break;case 2:l[d].fn.call(l[d].context,t);break;case 3:l[d].fn.call(l[d].context,t,n);break;case 4:l[d].fn.call(l[d].context,t,n,r);break;default:if(!s)for(u=1,s=new Array(p-1);u<p;u++)s[u-1]=arguments[u];l[d].fn.apply(l[d].context,s)}}return!0},d.prototype.on=function(e,t,n){return c(this,e,t,n,!1)},d.prototype.once=function(e,t,n){return c(this,e,t,n,!0)},d.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||r&&!a.once||n&&a.context!==n||s(this,o);else{for(var c=0,d=[],l=a.length;c<l;c++)(a[c].fn!==t||r&&!a[c].once||n&&a[c].context!==n)&&d.push(a[c]);d.length?this._events[o]=1===d.length?d[0]:d:s(this,o)}return this},d.prototype.removeAllListeners=function(e){var t;return e?this._events[t=i?i+e:e]&&s(this,t):(this._events=new o,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prefixed=i,d.EventEmitter=d,void 0!==t&&(t.exports=d)},{}],WOs9:[function(e,t,n){"use strict";var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(c){i={error:c}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},i=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};Object.defineProperty(n,"__esModule",{value:!0});var o,a="PeerJS: ";!function(e){e[e.Disabled=0]="Disabled",e[e.Errors=1]="Errors",e[e.Warnings=2]="Warnings",e[e.All=3]="All"}(o=n.LogLevel||(n.LogLevel={}));var c=function(){function e(){this._logLevel=o.Disabled}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!0,configurable:!0}),e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.All&&this._print.apply(this,i([o.All],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Warnings&&this._print.apply(this,i([o.Warnings],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logLevel>=o.Errors&&this._print.apply(this,i([o.Errors],e))},e.prototype.setLogFunction=function(e){this._print=e},e.prototype._print=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=i([a],t);for(var c in r)r[c]instanceof Error&&(r[c]="("+r[c].name+") "+r[c].message);e>=o.All?console.log.apply(console,i(r)):e>=o.Warnings?console.warn.apply(console,i(["WARNING"],r)):e>=o.Errors&&console.error.apply(console,i(["ERROR"],r))},e}();n.default=new c},{}],ZRYf:[function(e,t,n){"use strict";var r;Object.defineProperty(n,"__esModule",{value:!0}),(r=n.ConnectionEventType||(n.ConnectionEventType={})).Open="open",r.Stream="stream",r.Data="data",r.Close="close",r.Error="error",r.IceStateChanged="iceStateChanged",function(e){e.Data="data",e.Media="media"}(n.ConnectionType||(n.ConnectionType={})),function(e){e.Open="open",e.Close="close",e.Connection="connection",e.Call="call",e.Disconnected="disconnected",e.Error="error"}(n.PeerEventType||(n.PeerEventType={})),function(e){e.BrowserIncompatible="browser-incompatible",e.Disconnected="disconnected",e.InvalidID="invalid-id",e.InvalidKey="invalid-key",e.Network="network",e.PeerUnavailable="peer-unavailable",e.SslUnavailable="ssl-unavailable",e.ServerError="server-error",e.SocketError="socket-error",e.SocketClosed="socket-closed",e.UnavailableID="unavailable-id",e.WebRTC="webrtc"}(n.PeerErrorType||(n.PeerErrorType={})),function(e){e.Binary="binary",e.BinaryUTF8="binary-utf8",e.JSON="json"}(n.SerializationType||(n.SerializationType={})),function(e){e.Message="message",e.Disconnected="disconnected",e.Error="error",e.Close="close"}(n.SocketEventType||(n.SocketEventType={})),function(e){e.Heartbeat="HEARTBEAT",e.Candidate="CANDIDATE",e.Offer="OFFER",e.Answer="ANSWER",e.Open="OPEN",e.Error="ERROR",e.IdTaken="ID-TAKEN",e.InvalidKey="INVALID-KEY",e.Leave="LEAVE",e.Expire="EXPIRE"}(n.ServerMessageType||(n.ServerMessageType={}))},{}],wJlv:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(p){i={error:p}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var d=e("eventemitter3"),l=s(e("./logger")),p=e("./enums"),u=function(e){function t(t,n,r,i,o,a){void 0===a&&(a=5e3);var c=e.call(this)||this;return c.pingInterval=a,c._disconnected=!0,c._messagesQueue=[],c._baseUrl=(t?"wss://":"ws://")+n+":"+r+i+"peerjs?key="+o,c}return i(t,e),t.prototype.start=function(e,t){var n=this;this._id=e,!this._socket&&this._disconnected&&(this._socket=new WebSocket(this._baseUrl+"&id="+e+"&token="+t),this._disconnected=!1,this._socket.onmessage=function(e){var t;try{t=JSON.parse(e.data),l.default.log("Server message received:",t)}catch(c){return void l.default.log("Invalid server message",e.data)}n.emit(p.SocketEventType.Message,t)},this._socket.onclose=function(e){n._disconnected||(l.default.log("Socket closed.",e),n._cleanup(),n._disconnected=!0,n.emit(p.SocketEventType.Disconnected))},this._socket.onopen=function(){n._disconnected||(n._sendQueuedMessages(),l.default.log("Socket open"),n._scheduleHeartbeat())})},t.prototype._scheduleHeartbeat=function(){var e=this;this._wsPingTimer=setTimeout((function(){e._sendHeartbeat()}),this.pingInterval)},t.prototype._sendHeartbeat=function(){if(this._wsOpen()){var e=JSON.stringify({type:p.ServerMessageType.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}else l.default.log("Cannot send heartbeat, because socket closed")},t.prototype._wsOpen=function(){return!!this._socket&&1===this._socket.readyState},t.prototype._sendQueuedMessages=function(){var e,t,n=a(this._messagesQueue);this._messagesQueue=[];try{for(var r=c(n),i=r.next();!i.done;i=r.next())this.send(i.value)}catch(u){e={error:u}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.send=function(e){if(!this._disconnected)if(this._id)if(e.type){if(this._wsOpen()){var t=JSON.stringify(e);this._socket.send(t)}}else this.emit(p.SocketEventType.Error,"Invalid message");else this._messagesQueue.push(e)},t.prototype.close=function(){this._disconnected||(this._cleanup(),this._disconnected=!0)},t.prototype._cleanup=function(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)},t}(d.EventEmitter);n.Socket=u},{eventemitter3:"JJlS","./logger":"WOs9","./enums":"ZRYf"}],HCdX:[function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(t){o(t)}}function c(e){try{s(r.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(c){o=[6,c],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("./util"),s=a(e("./logger")),d=e("./enums"),l=function(){function e(e){this.connection=e}return e.prototype.startConnection=function(e){var t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===d.ConnectionType.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){if(this.connection.type===d.ConnectionType.Data){var n=this.connection,r=t.createDataChannel(n.label,{ordered:!!e.reliable});n.initialize(r)}this._makeOffer()}else this.handleSDP("OFFER",e.sdp)},e.prototype._startPeerConnection=function(){s.default.log("Creating RTCPeerConnection.");var e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e},e.prototype._setupListeners=function(e){var t=this,n=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,o=this.connection.provider;s.default.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&e.candidate.candidate&&(s.default.log("Received ICE candidates for "+n+":",e.candidate),o.socket.send({type:d.ServerMessageType.Candidate,payload:{candidate:e.candidate,type:i,connectionId:r},dst:n}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"failed":s.default.log("iceConnectionState is failed, closing connections to "+n),t.connection.emit(d.ConnectionEventType.Error,new Error("Negotiation of connection to "+n+" failed.")),t.connection.close();break;case"closed":s.default.log("iceConnectionState is closed, closing connections to "+n),t.connection.emit(d.ConnectionEventType.Error,new Error("Connection to "+n+" closed.")),t.connection.close();break;case"disconnected":s.default.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=c.util.noop}t.connection.emit(d.ConnectionEventType.IceStateChanged,e.iceConnectionState)},s.default.log("Listening for data channel"),e.ondatachannel=function(e){s.default.log("Received data channel");var t=e.channel;o.getConnection(n,r).initialize(t)},s.default.log("Listening for remote stream"),e.ontrack=function(e){s.default.log("Received remote stream");var i=e.streams[0],a=o.getConnection(n,r);a.type===d.ConnectionType.Media&&t._addStreamToMediaConnection(i,a)}},e.prototype.cleanup=function(){s.default.log("Cleaning up PeerConnection to "+this.connection.peer);var e=this.connection.peerConnection;if(e){this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=function(){};var t=!1;if(this.connection.type===d.ConnectionType.Data){var n=this.connection.dataChannel;n&&(t=!!n.readyState&&"closed"!==n.readyState)}("closed"!==e.signalingState||t)&&e.close()}},e.prototype._makeOffer=function(){return i(this,void 0,Promise,(function(){var e,t,n,i,a,l,p;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createOffer(this.connection.options.constraints)];case 2:n=o.sent(),s.default.log("Created offer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),s.default.log("Set localDescription:",n,"for:"+this.connection.peer),i={sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata,browser:c.util.browser},this.connection.type===d.ConnectionType.Data&&(a=this.connection,i=r(r({},i),{label:a.label,reliable:a.reliable,serialization:a.serialization})),t.socket.send({type:d.ServerMessageType.Offer,payload:i,dst:this.connection.peer}),[3,6];case 5:return"OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"!=(l=o.sent())&&(t.emitError(d.PeerErrorType.WebRTC,l),s.default.log("Failed to setLocalDescription, ",l)),[3,6];case 6:return[3,8];case 7:return p=o.sent(),t.emitError(d.PeerErrorType.WebRTC,p),s.default.log("Failed to createOffer, ",p),[3,8];case 8:return[2]}}))}))},e.prototype._makeAnswer=function(){return i(this,void 0,Promise,(function(){var e,t,n,r,i;return o(this,(function(o){switch(o.label){case 0:e=this.connection.peerConnection,t=this.connection.provider,o.label=1;case 1:return o.trys.push([1,7,,8]),[4,e.createAnswer()];case 2:n=o.sent(),s.default.log("Created answer."),this.connection.options.sdpTransform&&"function"==typeof this.connection.options.sdpTransform&&(n.sdp=this.connection.options.sdpTransform(n.sdp)||n.sdp),o.label=3;case 3:return o.trys.push([3,5,,6]),[4,e.setLocalDescription(n)];case 4:return o.sent(),s.default.log("Set localDescription:",n,"for:"+this.connection.peer),t.socket.send({type:d.ServerMessageType.Answer,payload:{sdp:n,type:this.connection.type,connectionId:this.connection.connectionId,browser:c.util.browser},dst:this.connection.peer}),[3,6];case 5:return r=o.sent(),t.emitError(d.PeerErrorType.WebRTC,r),s.default.log("Failed to setLocalDescription, ",r),[3,6];case 6:return[3,8];case 7:return i=o.sent(),t.emitError(d.PeerErrorType.WebRTC,i),s.default.log("Failed to create answer, ",i),[3,8];case 8:return[2]}}))}))},e.prototype.handleSDP=function(e,t){return i(this,void 0,Promise,(function(){var n,r,i,a;return o(this,(function(o){switch(o.label){case 0:t=new RTCSessionDescription(t),n=this.connection.peerConnection,r=this.connection.provider,s.default.log("Setting remote description",t),i=this,o.label=1;case 1:return o.trys.push([1,5,,6]),[4,n.setRemoteDescription(t)];case 2:return o.sent(),s.default.log("Set remoteDescription:"+e+" for:"+this.connection.peer),"OFFER"!==e?[3,4]:[4,i._makeAnswer()];case 3:o.sent(),o.label=4;case 4:return[3,6];case 5:return a=o.sent(),r.emitError(d.PeerErrorType.WebRTC,a),s.default.log("Failed to setRemoteDescription, ",a),[3,6];case 6:return[2]}}))}))},e.prototype.handleCandidate=function(e){return i(this,void 0,Promise,(function(){var t,n,r,i,a,c;return o(this,(function(o){switch(o.label){case 0:s.default.log("handleCandidate:",e),t=e.candidate,n=e.sdpMLineIndex,r=e.sdpMid,i=this.connection.peerConnection,a=this.connection.provider,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.addIceCandidate(new RTCIceCandidate({sdpMid:r,sdpMLineIndex:n,candidate:t}))];case 2:return o.sent(),s.default.log("Added ICE candidate for:"+this.connection.peer),[3,4];case 3:return c=o.sent(),a.emitError(d.PeerErrorType.WebRTC,c),s.default.log("Failed to handleCandidate, ",c),[3,4];case 4:return[2]}}))}))},e.prototype._addTracksToConnection=function(e,t){if(s.default.log("add tracks from stream "+e.id+" to peer connection"),!t.addTrack)return s.default.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach((function(n){t.addTrack(n,e)}))},e.prototype._addStreamToMediaConnection=function(e,t){s.default.log("add stream "+e.id+" to media connection "+t.connectionId),t.addStream(e)},e}();n.Negotiator=l},{"./util":"BHXf","./logger":"WOs9","./enums":"ZRYf"}],tQFK:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){function t(t,n,r){var i=e.call(this)||this;return i.peer=t,i.provider=n,i.options=r,i._open=!1,i.metadata=r.metadata,i}return i(t,e),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),t}(e("eventemitter3").EventEmitter);n.BaseConnection=o},{eventemitter3:"JJlS"}],dbHP:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./util"),d=c(e("./logger")),l=e("./negotiator"),p=e("./enums"),u=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o._localStream=o.options._stream,o.connectionId=o.options.connectionId||t.ID_PREFIX+s.util.randomToken(),o._negotiator=new l.Negotiator(o),o._localStream&&o._negotiator.startConnection({_stream:o._localStream,originator:!0}),o}return i(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return p.ConnectionType.Media},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"localStream",{get:function(){return this._localStream},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"remoteStream",{get:function(){return this._remoteStream},enumerable:!0,configurable:!0}),t.prototype.addStream=function(t){d.default.log("Receiving stream",t),this._remoteStream=t,e.prototype.emit.call(this,p.ConnectionEventType.Stream,t)},t.prototype.handleMessage=function(e){var t=e.type,n=e.payload;switch(e.type){case p.ServerMessageType.Answer:this._negotiator.handleSDP(t,n.sdp),this._open=!0;break;case p.ServerMessageType.Candidate:this._negotiator.handleCandidate(n.candidate);break;default:d.default.warn("Unrecognized message type:"+t+" from peer:"+this.peer)}},t.prototype.answer=function(e,t){var n,r;if(void 0===t&&(t={}),this._localStream)d.default.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");else{this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection(o(o({},this.options._payload),{_stream:e}));var i=this.provider._getMessages(this.connectionId);try{for(var c=a(i),s=c.next();!s.done;s=c.next())this.handleMessage(s.value)}catch(l){n={error:l}}finally{try{s&&!s.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}this._open=!0}},t.prototype.close=function(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,e.prototype.emit.call(this,p.ConnectionEventType.Close))},t.ID_PREFIX="mc_",t}(e("./baseconnection").BaseConnection);n.MediaConnection=u},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK"}],GGp6:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("eventemitter3"),c=o(e("./logger")),s=function(e){function t(){var t=e.call(this)||this;return t.fileReader=new FileReader,t._queue=[],t._processing=!1,t.fileReader.onload=function(e){t._processing=!1,e.target&&t.emit("done",e.target.result),t.doNextTask()},t.fileReader.onerror=function(e){c.default.error("EncodingQueue error:",e),t._processing=!1,t.destroy(),t.emit("error",e)},t}return i(t,e),Object.defineProperty(t.prototype,"queue",{get:function(){return this._queue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.queue.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!0,configurable:!0}),t.prototype.enque=function(e){this.queue.push(e),this.processing||this.doNextTask()},t.prototype.destroy=function(){this.fileReader.abort(),this._queue=[]},t.prototype.doNextTask=function(){0!==this.size&&(this.processing||(this._processing=!0,this.fileReader.readAsArrayBuffer(this.queue.shift())))},t}(a.EventEmitter);n.EncodingQueue=s},{eventemitter3:"JJlS","./logger":"WOs9"}],GBTQ:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var c=e("./util"),s=a(e("./logger")),d=e("./negotiator"),l=e("./enums"),p=e("./baseconnection"),u=e("./encodingQueue"),f=function(e){function t(n,r,i){var o=e.call(this,n,r,i)||this;return o.stringify=JSON.stringify,o.parse=JSON.parse,o._buffer=[],o._bufferSize=0,o._buffering=!1,o._chunkedData={},o._encodingQueue=new u.EncodingQueue,o.connectionId=o.options.connectionId||t.ID_PREFIX+c.util.randomToken(),o.label=o.options.label||o.connectionId,o.serialization=o.options.serialization||l.SerializationType.Binary,o.reliable=!!o.options.reliable,o._encodingQueue.on("done",(function(e){o._bufferedSend(e)})),o._encodingQueue.on("error",(function(){s.default.error("DC#"+o.connectionId+": Error occured in encoding from blob to arraybuffer, close DC"),o.close()})),o._negotiator=new d.Negotiator(o),o._negotiator.startConnection(o.options._payload||{originator:!0}),o}return i(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return l.ConnectionType.Data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataChannel",{get:function(){return this._dc},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferSize",{get:function(){return this._bufferSize},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e){this._dc=e,this._configureDataChannel()},t.prototype._configureDataChannel=function(){var e=this;c.util.supports.binaryBlob&&!c.util.supports.reliable||(this.dataChannel.binaryType="arraybuffer"),this.dataChannel.onopen=function(){s.default.log("DC#"+e.connectionId+" dc connection success"),e._open=!0,e.emit(l.ConnectionEventType.Open)},this.dataChannel.onmessage=function(t){s.default.log("DC#"+e.connectionId+" dc onmessage:",t.data),e._handleDataMessage(t)},this.dataChannel.onclose=function(){s.default.log("DC#"+e.connectionId+" dc closed for:",e.peer),e.close()}},t.prototype._handleDataMessage=function(t){var n=this,r=t.data,i=r.constructor,o=r;if(this.serialization===l.SerializationType.Binary||this.serialization===l.SerializationType.BinaryUTF8){if(i===Blob)return void c.util.blobToArrayBuffer(r,(function(e){var t=c.util.unpack(e);n.emit(l.ConnectionEventType.Data,t)}));if(i===ArrayBuffer)o=c.util.unpack(r);else if(i===String){var a=c.util.binaryStringToArrayBuffer(r);o=c.util.unpack(a)}}else this.serialization===l.SerializationType.JSON&&(o=this.parse(r));o.__peerData?this._handleChunk(o):e.prototype.emit.call(this,l.ConnectionEventType.Data,o)},t.prototype._handleChunk=function(e){var t=e.__peerData,n=this._chunkedData[t]||{data:[],count:0,total:e.total};if(n.data[e.n]=e.data,n.count++,this._chunkedData[t]=n,n.total===n.count){delete this._chunkedData[t];var r=new Blob(n.data);this._handleDataMessage({data:r})}},t.prototype.close=function(){this._buffer=[],this._bufferSize=0,this._chunkedData={},this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this._dc=null),this._encodingQueue&&(this._encodingQueue.destroy(),this._encodingQueue.removeAllListeners(),this._encodingQueue=null),this.open&&(this._open=!1,e.prototype.emit.call(this,l.ConnectionEventType.Close))},t.prototype.send=function(t,n){if(this.open)if(this.serialization===l.SerializationType.JSON)this._bufferedSend(this.stringify(t));else if(this.serialization===l.SerializationType.Binary||this.serialization===l.SerializationType.BinaryUTF8){var r=c.util.pack(t);if(!n&&r.size>c.util.chunkedMTU)return void this._sendChunks(r);c.util.supports.binaryBlob?this._bufferedSend(r):this._encodingQueue.enque(r)}else this._bufferedSend(t);else e.prototype.emit.call(this,l.ConnectionEventType.Error,new Error("Connection is not open. You should listen for the `open` event before sending messages."))},t.prototype._bufferedSend=function(e){!this._buffering&&this._trySend(e)||(this._buffer.push(e),this._bufferSize=this._buffer.length)},t.prototype._trySend=function(n){var r=this;if(!this.open)return!1;if(this.dataChannel.bufferedAmount>t.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout((function(){r._buffering=!1,r._tryBuffer()}),50),!1;try{this.dataChannel.send(n)}catch(e){return s.default.error("DC#:"+this.connectionId+" Error when sending:",e),this._buffering=!0,this.close(),!1}return!0},t.prototype._tryBuffer=function(){this.open&&0!==this._buffer.length&&this._trySend(this._buffer[0])&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())},t.prototype._sendChunks=function(e){var t,n,r=c.util.chunk(e);s.default.log("DC#"+this.connectionId+" Try to send "+r.length+" chunks...");try{for(var i=o(r),a=i.next();!a.done;a=i.next())this.send(a.value,!0)}catch(d){t={error:d}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.handleMessage=function(e){var t=e.payload;switch(e.type){case l.ServerMessageType.Answer:this._negotiator.handleSDP(e.type,t.sdp);break;case l.ServerMessageType.Candidate:this._negotiator.handleCandidate(t.candidate);break;default:s.default.warn("Unrecognized message type:",e.type,"from peer:",this.peer)}},t.ID_PREFIX="dc_",t.MAX_BUFFERED_AMOUNT=8388608,t}(p.BaseConnection);n.DataConnection=f},{"./util":"BHXf","./logger":"WOs9","./negotiator":"HCdX","./enums":"ZRYf","./baseconnection":"tQFK","./encodingQueue":"GGp6"}],in7L:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(t){o(t)}}function c(e){try{s(r.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(c){o=[6,c],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var a=e("./util"),c=o(e("./logger")),s=function(){function e(e){this._options=e}return e.prototype._buildUrl=function(e){return(this._options.secure?"https://":"http://")+this._options.host+":"+this._options.port+this._options.path+this._options.key+"/"+e+"?ts="+(new Date).getTime()+Math.random()},e.prototype.retrieveId=function(){return r(this,void 0,Promise,(function(){var e,t,n,r;return i(this,(function(i){switch(i.label){case 0:e=this._buildUrl("id"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=i.sent()).status)throw new Error("Error. Status:"+t.status);return[2,t.text()];case 3:throw n=i.sent(),c.default.error("Error retrieving ID",n),r="","/"===this._options.path&&this._options.host!==a.util.CLOUD_HOST&&(r=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+r);case 4:return[2]}}))}))},e.prototype.listAllPeers=function(){return r(this,void 0,Promise,(function(){var e,t,n;return i(this,(function(r){switch(r.label){case 0:e=this._buildUrl("peers"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,fetch(e)];case 2:if(200!==(t=r.sent()).status){if(401===t.status)throw new Error("It doesn't look like you have permission to list peers IDs. "+(this._options.host===a.util.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature."));throw new Error("Error. Status:"+t.status)}return[2,t.json()];case 3:throw n=r.sent(),c.default.error("Error retrieving list peers",n),new Error("Could not get list peers from the server."+n);case 4:return[2]}}))}))},e}();n.API=s},{"./util":"BHXf","./logger":"WOs9"}],Hxpd:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(p){i={error:p}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});var d=e("eventemitter3"),l=e("./util"),p=s(e("./logger")),u=e("./socket"),f=e("./mediaconnection"),b=e("./dataconnection"),h=e("./enums"),g=e("./api"),m=function(e){function t(n,r){var i,a=e.call(this)||this;return a._id=null,a._lastServerId=null,a._destroyed=!1,a._disconnected=!1,a._open=!1,a._connections=new Map,a._lostMessages=new Map,n&&n.constructor==Object?r=n:n&&(i=n.toString()),r=o({debug:0,host:l.util.CLOUD_HOST,port:l.util.CLOUD_PORT,path:"/",key:t.DEFAULT_KEY,token:l.util.randomToken(),config:l.util.defaultConfig},r),a._options=r,"/"===a._options.host&&(a._options.host=window.location.hostname),a._options.path&&("/"!==a._options.path[0]&&(a._options.path="/"+a._options.path),"/"!==a._options.path[a._options.path.length-1]&&(a._options.path+="/")),void 0===a._options.secure&&a._options.host!==l.util.CLOUD_HOST?a._options.secure=l.util.isSecure():a._options.host==l.util.CLOUD_HOST&&(a._options.secure=!0),a._options.logFunction&&p.default.setLogFunction(a._options.logFunction),p.default.logLevel=a._options.debug||0,a._api=new g.API(r),a._socket=a._createServerConnection(),l.util.supports.audioVideo||l.util.supports.data?i&&!l.util.validateId(i)?(a._delayedAbort(h.PeerErrorType.InvalidID,'ID "'+i+'" is invalid'),a):(i?a._initialize(i):a._api.retrieveId().then((function(e){return a._initialize(e)})).catch((function(e){return a._abort(h.PeerErrorType.ServerError,e)})),a):(a._delayedAbort(h.PeerErrorType.BrowserIncompatible,"The current browser does not support WebRTC"),a)}return i(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"open",{get:function(){return this._open},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"socket",{get:function(){return this._socket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){var e,t,n=Object.create(null);try{for(var r=a(this._connections),i=r.next();!i.done;i=r.next()){var o=c(i.value,2);n[o[0]]=o[1]}}catch(b){e={error:b}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disconnected",{get:function(){return this._disconnected},enumerable:!0,configurable:!0}),t.prototype._createServerConnection=function(){var e=this,t=new u.Socket(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return t.on(h.SocketEventType.Message,(function(t){e._handleMessage(t)})),t.on(h.SocketEventType.Error,(function(t){e._abort(h.PeerErrorType.SocketError,t)})),t.on(h.SocketEventType.Disconnected,(function(){e.disconnected||(e.emitError(h.PeerErrorType.Network,"Lost connection to server."),e.disconnect())})),t.on(h.SocketEventType.Close,(function(){e.disconnected||e._abort(h.PeerErrorType.SocketClosed,"Underlying socket is already closed.")})),t},t.prototype._initialize=function(e){this._id=e,this.socket.start(e,this._options.token)},t.prototype._handleMessage=function(e){var t,n,r=e.type,i=e.payload,o=e.src;switch(r){case h.ServerMessageType.Open:this._lastServerId=this.id,this._open=!0,this.emit(h.PeerEventType.Open,this.id);break;case h.ServerMessageType.Error:this._abort(h.PeerErrorType.ServerError,i.msg);break;case h.ServerMessageType.IdTaken:this._abort(h.PeerErrorType.UnavailableID,'ID "'+this.id+'" is taken');break;case h.ServerMessageType.InvalidKey:this._abort(h.PeerErrorType.InvalidKey,'API KEY "'+this._options.key+'" is invalid');break;case h.ServerMessageType.Leave:p.default.log("Received leave message from "+o),this._cleanupPeer(o),this._connections.delete(o);break;case h.ServerMessageType.Expire:this.emitError(h.PeerErrorType.PeerUnavailable,"Could not connect to peer "+o);break;case h.ServerMessageType.Offer:var c=i.connectionId;if((u=this.getConnection(o,c))&&(u.close(),p.default.warn("Offer received for existing Connection ID:"+c)),i.type===h.ConnectionType.Media)u=new f.MediaConnection(o,this,{connectionId:c,_payload:i,metadata:i.metadata}),this._addConnection(o,u),this.emit(h.PeerEventType.Call,u);else{if(i.type!==h.ConnectionType.Data)return void p.default.warn("Received malformed connection type:"+i.type);u=new b.DataConnection(o,this,{connectionId:c,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(o,u),this.emit(h.PeerEventType.Connection,u)}var s=this._getMessages(c);try{for(var d=a(s),l=d.next();!l.done;l=d.next())u.handleMessage(l.value)}catch(g){t={error:g}}finally{try{l&&!l.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}break;default:if(!i)return void p.default.warn("You received a malformed message from "+o+" of type "+r);var u;(u=this.getConnection(o,c=i.connectionId))&&u.peerConnection?u.handleMessage(e):c?this._storeMessage(c,e):p.default.warn("You received an unrecognized message:",e)}},t.prototype._storeMessage=function(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)},t.prototype._getMessages=function(e){var t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]},t.prototype.connect=function(e,t){if(void 0===t&&(t={}),this.disconnected)return p.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");var n=new b.DataConnection(e,this,t);return this._addConnection(e,n),n},t.prototype.call=function(e,t,n){if(void 0===n&&(n={}),this.disconnected)return p.default.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError(h.PeerErrorType.Disconnected,"Cannot connect to new Peer after disconnecting from server.");if(t){n._stream=t;var r=new f.MediaConnection(e,this,n);return this._addConnection(e,r),r}p.default.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.")},t.prototype._addConnection=function(e,t){p.default.log("add connection "+t.type+":"+t.connectionId+" to peerId:"+e),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)},t.prototype._removeConnection=function(e){var t=this._connections.get(e.peer);if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}this._lostMessages.delete(e.connectionId)},t.prototype.getConnection=function(e,t){var n,r,i=this._connections.get(e);if(!i)return null;try{for(var o=a(i),c=o.next();!c.done;c=o.next()){var s=c.value;if(s.connectionId===t)return s}}catch(f){n={error:f}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return null},t.prototype._delayedAbort=function(e,t){var n=this;setTimeout((function(){n._abort(e,t)}),0)},t.prototype._abort=function(e,t){p.default.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()},t.prototype.emitError=function(e,t){var n;p.default.error("Error:",t),(n="string"==typeof t?new Error(t):t).type=e,this.emit(h.PeerEventType.Error,n)},t.prototype.destroy=function(){this.destroyed||(p.default.log("Destroy peer with ID:"+this.id),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit(h.PeerEventType.Close))},t.prototype._cleanup=function(){var e,t;try{for(var n=a(this._connections.keys()),r=n.next();!r.done;r=n.next()){var i=r.value;this._cleanupPeer(i),this._connections.delete(i)}}catch(l){e={error:l}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.socket.removeAllListeners()},t.prototype._cleanupPeer=function(e){var t,n,r=this._connections.get(e);if(r)try{for(var i=a(r),o=i.next();!o.done;o=i.next())o.value.close()}catch(p){t={error:p}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},t.prototype.disconnect=function(){if(!this.disconnected){var e=this.id;p.default.log("Disconnect peer with ID:"+e),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit(h.PeerEventType.Disconnected,e)}},t.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)p.default.log("Attempting reconnection to server with ID "+this._lastServerId),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");p.default.error("In a hurry? We're still trying to make the initial connection!")}},t.prototype.listAllPeers=function(e){var t=this;void 0===e&&(e=function(e){}),this._api.listAllPeers().then((function(t){return e(t)})).catch((function(e){return t._abort(h.PeerErrorType.ServerError,e)}))},t.DEFAULT_KEY="peerjs",t}(d.EventEmitter);n.Peer=m},{eventemitter3:"JJlS","./util":"BHXf","./logger":"WOs9","./socket":"wJlv","./mediaconnection":"dbHP","./dataconnection":"GBTQ","./enums":"ZRYf","./api":"in7L"}],iTK6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),i=e("./peer");n.peerjs={Peer:i.Peer,util:r.util},n.default=i.Peer,window.peerjs=n.peerjs,window.Peer=i.Peer},{"./util":"BHXf","./peer":"Hxpd"}]},{},["iTK6"])},tk71:function(e,t,n){"use strict";n.r(t),n.d(t,"ArenaPageModule",(function(){return bn}));var r=n("ofXK"),i=n("3Pt+"),o=n("TEn/"),a=n("tyNb"),c=n("mrSG"),s=n("dfJG"),d=n("DffN"),l=function(){function e(t,n,r){_classCallCheck(this,e),this.title=t,this.quests=n,this.visitedQuests=[],this.rewards=r}return _createClass(e,[{key:"getActiveQuests",value:function(){return this.quests.filter((function(e){return e.isActive&&!e.isFinished}))}}]),e}(),p=n("fXoL"),u=n("tk/3");function f(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",4),p.Wb("dblclick",(function(){p.ic(n);var e=p.Yb().$implicit;return p.Yb().recycle(e)})),p.Ob(1,"div",5),p.Mb(2,"ion-img",6),p.Nb(),p.Ob(3,"div",7),p.oc(4),p.Nb(),p.Ob(5,"div",8),p.oc(6),p.Nb(),p.Nb()}if(2&e){var r=p.Yb().$implicit,i=p.Yb();p.zb(2),p.cc("src",i.util.getDiceFace(r)),p.zb(2),p.qc(" ",i.profile.energyPool.sm.values[r]," "),p.zb(2),p.qc(" ",r," ")}}function b(e,t){if(1&e&&(p.Ob(0,"div",2),p.nc(1,f,7,3,"div",3),p.Nb()),2&e){var n=t.$implicit,r=p.Yb();p.zb(1),p.bc("ngIf",r.profile.energyPool.sm.values[n]>0)}}var h,g=((h=function(){function e(){_classCallCheck(this,e),this.util=s.j}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"recycle",value:function(e){if(this.board.sm.values.isPlayerTurn&&this.profile.alias===this.board.players.red.alias){var t=this.profile.energyPool.sm.values[e];this.profile.energyPool.sm.setValue(e,0),this.profile.energyPool.events.emit("mintBg",{attribute:"neutral",value:t})}}}]),e}()).\u0275fac=function(e){return new(e||h)},h.\u0275cmp=p.Fb({type:h,selectors:[["app-energy-pool"]],inputs:{profile:"profile",board:"board"},decls:2,vars:1,consts:[[1,"container"],["class","attribute-outer",4,"ngFor","ngForOf"],[1,"attribute-outer"],["class","energy-item",3,"dblclick",4,"ngIf"],[1,"energy-item",3,"dblclick"],[1,"energy-icon"],[3,"src"],[1,"energy-value"],[1,"energy-name"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.nc(1,b,2,1,"div",1),p.Nb()),2&e&&(p.zb(1),p.bc("ngForOf",t.profile.energyPool.sm.values.attributes))},directives:[r.i,r.j],styles:[".energy-pool[_ngcontent-%COMP%]{flex-wrap:wrap;position:relative;margin:5px 0}.container[_ngcontent-%COMP%], .energy-pool[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]{height:100%;flex-direction:column}.energy-icon[_ngcontent-%COMP%]{width:64px}.energy-item[_ngcontent-%COMP%]{background-color:#000;display:flex;justify-content:center;align-items:center;position:relative;margin:15px 0;border-radius:5px 5px 0 0}.energy-value[_ngcontent-%COMP%]{font-size:32px}.energy-name[_ngcontent-%COMP%]{position:absolute;height:25px;bottom:-25px;font-size:.8em;background-color:#000;text-align:center;width:100%;padding:3px 0;border-radius:0 0 5px 5px}"]}),h),m=n("g9x5");function v(e,t){if(1&e&&(p.Ob(0,"div",5),p.Ob(1,"div",6),p.Mb(2,"ion-img",7),p.Nb(),p.Ob(3,"div",8),p.Mb(4,"ion-img",7),p.Nb(),p.Ob(5,"div",9),p.Mb(6,"ion-img",7),p.Nb(),p.Ob(7,"div",10),p.Mb(8,"ion-img",7),p.Nb(),p.Ob(9,"div",11),p.Mb(10,"ion-img",7),p.Nb(),p.Ob(11,"div",12),p.Mb(12,"ion-img",7),p.Nb(),p.Nb()),2&e){var n=p.Yb();p.Bb("dice dice-",n.dice.sm.values.activeFace,""),p.dc("id","dice-",n.dice.sm.values.hash,""),p.zb(1),p.lc("background-color:",n.util.getAttributeColor(n.dice.faces[0]),""),p.zb(1),p.cc("src",n.util.getDiceFace(n.dice.faces[0])),p.zb(1),p.lc("background-color:",n.util.getAttributeColor(n.dice.faces[1]),""),p.zb(1),p.cc("src",n.util.getDiceFace(n.dice.faces[1])),p.zb(1),p.lc("background-color:",n.util.getAttributeColor(n.dice.faces[2]),""),p.zb(1),p.cc("src",n.util.getDiceFace(n.dice.faces[2])),p.zb(1),p.lc("background-color:",n.util.getAttributeColor(n.dice.faces[3]),""),p.zb(1),p.cc("src",n.util.getDiceFace(n.dice.faces[3])),p.zb(1),p.lc("background-color:",n.util.getAttributeColor(n.dice.faces[4]),""),p.zb(1),p.cc("src",n.util.getDiceFace(n.dice.faces[4])),p.zb(1),p.lc("background-color:",n.util.getAttributeColor(n.dice.faces[5]),""),p.zb(1),p.cc("src",n.util.getDiceFace(n.dice.faces[5]))}}function y(e,t){if(1&e&&(p.Ob(0,"div",13),p.oc(1),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.qc(" x",n.dice.sm.values.copiesNumber," ")}}var C,_=((C=function(){function e(){_classCallCheck(this,e),this.collectionCounterVisible=!1,this.util=m.a,this.dom=!1}return _createClass(e,[{key:"assignDom",value:function(){this.dom||(this.dom=document.querySelector("#dice-info-"+this.dice.hash))}},{key:"ngOnInit",value:function(){this.assignDom()}},{key:"mouseOverToggle",value:function(){this.assignDom(),this.dom.classList.toggle("visible")}}]),e}()).\u0275fac=function(e){return new(e||C)},C.\u0275cmp=p.Fb({type:C,selectors:[["app-dice"]],inputs:{dice:"dice",collectionCounterVisible:"collectionCounterVisible"},decls:10,vars:27,consts:[[1,"view",3,"mouseover","mouseout"],[3,"class","id",4,"ngIf"],["class","copies-number",4,"ngIf"],[1,"dice-info",3,"id"],[3,"src"],[3,"id"],[1,"diceFace","front"],[1,"dice-face-icon",3,"src"],[1,"diceFace","right"],[1,"diceFace","back"],[1,"diceFace","left"],[1,"diceFace","top"],[1,"diceFace","bottom"],[1,"copies-number"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.Wb("mouseover",(function(){return t.mouseOverToggle()}))("mouseout",(function(){return t.mouseOverToggle()})),p.nc(1,v,13,28,"div",1),p.nc(2,y,2,1,"div",2),p.Nb(),p.Ob(3,"div",3),p.Mb(4,"ion-img",4),p.Mb(5,"ion-img",4),p.Mb(6,"ion-img",4),p.Mb(7,"ion-img",4),p.Mb(8,"ion-img",4),p.Mb(9,"ion-img",4),p.Nb()),2&e&&(p.zb(1),p.bc("ngIf",t.dice),p.zb(1),p.bc("ngIf",t.collectionCounterVisible),p.zb(1),p.dc("id","dice-info-",t.dice.hash,""),p.zb(1),p.lc("background-color:",t.dice.color,""),p.cc("src",t.util.getDiceFace(t.dice.faces[0])),p.zb(1),p.lc("background-color:",t.dice.color,""),p.cc("src",t.util.getDiceFace(t.dice.faces[1])),p.zb(1),p.lc("background-color:",t.dice.color,""),p.cc("src",t.util.getDiceFace(t.dice.faces[2])),p.zb(1),p.lc("background-color:",t.dice.color,""),p.cc("src",t.util.getDiceFace(t.dice.faces[3])),p.zb(1),p.lc("background-color:",t.dice.color,""),p.cc("src",t.util.getDiceFace(t.dice.faces[4])),p.zb(1),p.lc("background-color:",t.dice.color,""),p.cc("src",t.util.getDiceFace(t.dice.faces[5])))},directives:[r.j],styles:[".view[_ngcontent-%COMP%]{margin:0;perspective:150px}.dice[_ngcontent-%COMP%], .view[_ngcontent-%COMP%]{width:50px;height:50px}.dice[_ngcontent-%COMP%]{position:relative;transform-style:preserve-3d;transition:transform .5s}@-webkit-keyframes infiniteRoll{to{transform:rotateY(1turn) rotateX(-1turn)}}@keyframes infiniteRoll{to{transform:rotateY(1turn) rotateX(-1turn)}}.dice-rolling[_ngcontent-%COMP%]{-webkit-animation:infiniteRoll .7s linear infinite;animation:infiniteRoll .7s linear infinite}.dice-rolling-slow[_ngcontent-%COMP%]{-webkit-animation:infiniteRoll 1.5s linear infinite;animation:infiniteRoll 1.5s linear infinite}.dice-front[_ngcontent-%COMP%]{transform:rotateY(1turn)!important}.dice-right[_ngcontent-%COMP%]{transform:rotateY(-90deg)!important}.dice-back[_ngcontent-%COMP%]{transform:rotateY(180deg)!important}.dice-left[_ngcontent-%COMP%]{transform:rotateY(90deg)!important}.dice-top[_ngcontent-%COMP%]{transform:rotateX(-90deg)!important}.dice-bottom[_ngcontent-%COMP%]{transform:rotateX(90deg)!important}.btnFront[_ngcontent-%COMP%]:checked ~ .view[_ngcontent-%COMP%] > .dice[_ngcontent-%COMP%]{transform:rotateY(1turn)!important}.btnRight[_ngcontent-%COMP%]:checked ~ .view[_ngcontent-%COMP%] > .dice[_ngcontent-%COMP%]{transform:rotateY(-90deg)!important}.btnBack[_ngcontent-%COMP%]:checked ~ .view[_ngcontent-%COMP%] > .dice[_ngcontent-%COMP%]{transform:rotateY(180deg)!important}.btnLeft[_ngcontent-%COMP%]:checked ~ .view[_ngcontent-%COMP%] > .dice[_ngcontent-%COMP%]{transform:rotateY(90deg)!important}.btnTop[_ngcontent-%COMP%]:checked ~ .view[_ngcontent-%COMP%] > .dice[_ngcontent-%COMP%]{transform:rotateX(-90deg)!important}.btnBottom[_ngcontent-%COMP%]:checked ~ .view[_ngcontent-%COMP%] > .dice[_ngcontent-%COMP%]{transform:rotateX(90deg)!important}.diceFace[_ngcontent-%COMP%]{position:absolute;width:50px;height:50px;overflow:hidden;text-align:center;line-height:50px;font-size:1.2em;border:2px solid #fff;background-size:cover}.front[_ngcontent-%COMP%]{background-color:rgba(255,0,0,.6);transform:rotateY(0deg) translateZ(25px)}.right[_ngcontent-%COMP%]{background-color:rgba(0,255,0,.6);transform:rotateY(90deg) translateZ(25px)}.back[_ngcontent-%COMP%]{background-color:rgba(255,255,0,.6);transform:rotateY(180deg) translateZ(25px)}.left[_ngcontent-%COMP%]{background-color:rgba(255,0,255,.6);transform:rotateY(-90deg) translateZ(25px)}.top[_ngcontent-%COMP%]{background-color:rgba(0,255,255,.6);transform:rotateX(90deg) translateZ(25px)}.bottom[_ngcontent-%COMP%]{transform:rotateX(-90deg) translateZ(25px)}span[_ngcontent-%COMP%]{display:inline-block;padding:4px 10px;margin:3px;background-color:#0aa;border:2px inset #dd0}.test[_ngcontent-%COMP%]:checked + .test2[_ngcontent-%COMP%]{display:block;width:80px;background-color:#0aa}input[type=radio][_ngcontent-%COMP%]{transform:scale(2);margin:10px;color:red}.copies-number[_ngcontent-%COMP%]{position:absolute;top:0;left:0;display:flex;width:100%;height:100%;color:#fff;font-size:2em;background-color:rgba(0,0,0,.3);text-shadow:0 0 3px #000}.copies-number[_ngcontent-%COMP%], .dice-info[_ngcontent-%COMP%]{justify-content:center;align-items:center}.dice-info[_ngcontent-%COMP%]{position:fixed;bottom:10px;left:calc(50% - 150px);width:300px;height:200px;display:flex;flex-wrap:wrap;background-color:#000;border-radius:5px;border:1px solid #343434;z-index:9.999999999999998e+37;display:none}.dice-info[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:64px;height:64px;border:1px solid #fff;margin:10px}.dice-info.visible[_ngcontent-%COMP%]{display:flex}"]}),C);function O(e,t){if(1&e&&(p.Ob(0,"div",13),p.Mb(1,"ion-img",14),p.Ob(2,"div",3),p.oc(3),p.Nb(),p.Nb()),2&e){var n=p.Yb();p.zb(3),p.pc(n.card.sm.values.vit)}}function P(e,t){if(1&e&&(p.Ob(0,"div",15),p.Mb(1,"ion-img",16),p.Ob(2,"div",3),p.oc(3),p.Nb(),p.Nb()),2&e){var n=p.Yb();p.zb(3),p.pc(n.card.sm.values.mov)}}function k(e,t){if(1&e&&(p.Ob(0,"div",17),p.Mb(1,"ion-img",18),p.Ob(2,"div",3),p.oc(3),p.Nb(),p.Nb()),2&e){var n=p.Yb();p.zb(3),p.pc(n.card.sm.values.btl)}}function w(e,t){if(1&e&&(p.Ob(0,"div",19),p.oc(1),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.pc(n.numberCopies)}}function x(e,t){if(1&e&&(p.Ob(0,"div"),p.Ob(1,"span"),p.oc(2,"Clans: "),p.Nb(),p.oc(3),p.Nb()),2&e){var n=p.Yb(2);p.zb(3),p.pc(n.card.clans.join(", "))}}function M(e,t){if(1&e&&(p.Ob(0,"div"),p.Ob(1,"span"),p.oc(2,"Abilities: "),p.Nb(),p.oc(3),p.Nb()),2&e){var n=p.Yb(2);p.zb(3),p.pc(n.card.abilities.join(", "))}}function S(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",20),p.Wb("click",(function(){return p.ic(n),p.Yb().clickAction()})),p.Ob(1,"div",21),p.Ob(2,"div",22),p.Ob(3,"div"),p.Ob(4,"span"),p.oc(5,"Name: "),p.Nb(),p.oc(6),p.Nb(),p.nc(7,x,4,1,"div",23),p.Ob(8,"div"),p.Ob(9,"span"),p.oc(10,"Attribute: "),p.Nb(),p.oc(11),p.Ob(12,"div",24),p.Mb(13,"ion-img",5),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Ob(14,"div",25),p.Mb(15,"ion-img",26),p.Nb(),p.nc(16,M,4,1,"div",23),p.Ob(17,"div",21),p.Ob(18,"div",27),p.Ob(19,"div"),p.Ob(20,"span"),p.oc(21,"BTL: "),p.Nb(),p.oc(22),p.Nb(),p.Ob(23,"div"),p.Ob(24,"span"),p.oc(25,"RNG: "),p.Nb(),p.oc(26),p.Nb(),p.Nb(),p.Ob(27,"div",27),p.Ob(28,"div"),p.Ob(29,"span"),p.oc(30,"Cost: "),p.Nb(),p.oc(31),p.Nb(),p.Ob(32,"div"),p.Ob(33,"span"),p.oc(34,"Cooldown: "),p.Nb(),p.oc(35),p.Nb(),p.Nb(),p.Ob(36,"div",27),p.Ob(37,"div"),p.Ob(38,"span"),p.oc(39,"MOV: "),p.Nb(),p.oc(40),p.Nb(),p.Ob(41,"div"),p.Ob(42,"span"),p.oc(43,"VIT: "),p.Nb(),p.oc(44),p.Nb(),p.Nb(),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.dc("id","card-info-",r.card.hash,""),p.zb(6),p.pc(r.card.title),p.zb(1),p.bc("ngIf",r.card.clans.length>0),p.zb(4),p.qc(" ",r.card.attribute," "),p.zb(2),p.cc("src",r.util.getDiceFace(r.card.attribute)),p.zb(1),p.lc("background-image:url(",r.card.backgroundUrl,")"),p.zb(1),p.cc("src",r.card.battlerUrl),p.zb(1),p.bc("ngIf",r.card.abilities.length>0),p.zb(6),p.pc(r.card.btl),p.zb(4),p.pc(r.card.rng),p.zb(5),p.pc(r.card.cost),p.zb(4),p.pc(r.card.cooldown),p.zb(5),p.pc(r.card.mov),p.zb(4),p.pc(r.card.vit)}}var T,R=((T=function(){function e(){_classCallCheck(this,e),this.numberCopies=0,this.util=s.j,this.dom=!1,this.hideTooltip=!1}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"assignDom",value:function(){this.dom||(this.dom=document.querySelector("#card-info-"+this.card.hash))}},{key:"clickAction",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.board.sm.values.cardInDisplay=this.card;case 1:case"end":return e.stop()}}),e,this)})))}}]),e}()).\u0275fac=function(e){return new(e||T)},T.\u0275cmp=p.Fb({type:T,selectors:[["app-card-mini"]],inputs:{card:"card",numberCopies:"numberCopies",board:"board",hideTooltip:"hideTooltip"},decls:16,vars:11,consts:[[1,"container"],[1,"stat","cost","icon-bg"],["src","/assets/card-resources/sun.png"],[1,"stat-value"],[1,"stat","attribute"],[3,"src"],["class","stat vit icon-bg",4,"ngIf"],[1,"illustration",3,"src"],["class","stat mov icon-bg",4,"ngIf"],[1,"stat","view",3,"click"],["class","stat btl icon-bg",4,"ngIf"],["class","counter-overlay",4,"ngIf"],["class","card-info",3,"id","click",4,"ngIf"],[1,"stat","vit","icon-bg"],["src","/assets/card-resources/heart.png"],[1,"stat","mov","icon-bg"],["src","/assets/card-resources/boot.png"],[1,"stat","btl","icon-bg"],["src","/assets/card-resources/fist.png"],[1,"counter-overlay"],[1,"card-info",3,"id","click"],[1,"info-stats"],[1,"info-stat-col","full"],[4,"ngIf"],[1,"attribute-icon"],[1,"info-image"],[1,"info-illustration",3,"src"],[1,"info-stat-col"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.Ob(1,"div",1),p.Mb(2,"ion-img",2),p.Ob(3,"div",3),p.oc(4),p.Nb(),p.Nb(),p.Ob(5,"div",4),p.Mb(6,"ion-img",5),p.Nb(),p.nc(7,O,4,1,"div",6),p.Mb(8,"ion-img",7),p.nc(9,P,4,1,"div",8),p.Ob(10,"div",9),p.Wb("click",(function(){return t.clickAction()})),p.Ob(11,"div",3),p.oc(12,"+"),p.Nb(),p.Nb(),p.nc(13,k,4,1,"div",10),p.nc(14,w,2,1,"div",11),p.Nb(),p.nc(15,S,45,16,"div",12)),2&e&&(p.lc("background-image:url(",t.card.backgroundUrl,");"),p.zb(4),p.pc(t.card.sm.values.cost),p.zb(2),p.cc("src",t.util.getDiceFace(t.card.attribute)),p.zb(1),p.bc("ngIf",!t.card.sm.values.clans.includes("Hex")&&!t.card.sm.values.clans.includes("Illusion")),p.zb(1),p.cc("src",t.card.battlerUrl),p.zb(1),p.bc("ngIf",!t.card.sm.values.clans.includes("Hex")&&!t.card.sm.values.clans.includes("Illusion")),p.zb(4),p.bc("ngIf",!t.card.sm.values.clans.includes("Hex")&&!t.card.sm.values.clans.includes("Illusion")),p.zb(1),p.bc("ngIf",t.numberCopies>0),p.zb(1),p.bc("ngIf",!t.hideTooltip))},directives:[r.j],styles:[".container[_ngcontent-%COMP%]{width:128px;height:128px;border:3px solid #dedede;margin:20px;position:relative;display:flex;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]   ion-img.illustration[_ngcontent-%COMP%]{width:70%;filter:drop-shadow(0 0 4px #dedede)}.container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{background-color:#232323;color:#fff;border:1px solid #fff;margin:5px;padding:5px}.container[_ngcontent-%COMP%]   .num[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.5);width:100%;height:100%;border-radius:100%;display:flex;justify-content:center;text-shadow:0 0 3px #000}.card-info[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .num[_ngcontent-%COMP%]{color:#dedede;align-items:center}.card-info[_ngcontent-%COMP%]{position:fixed;top:calc(50vh - 300px);left:calc(50vw - 200px);width:400px;height:600px;display:flex;background-color:rgba(0,0,0,.9);border-radius:5px;border:1px solid #343434;z-index:999999999999999;justify-content:space-evenly;flex-direction:column;display:none}.card-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:900}.card-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:center;align-content:center}.card-info[_ngcontent-%COMP%]   .info-illustration[_ngcontent-%COMP%]{width:256px;filter:drop-shadow(0 0 5px #dedede)}.card-info[_ngcontent-%COMP%]   .attribute-icon[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:100%;border:1px solid #dedede;position:relative;top:-5px;left:10px;overflow:hidden}.card-info.visible[_ngcontent-%COMP%]{display:flex}.actions[_ngcontent-%COMP%]{width:100%;height:100%;top:0;left:-100%;justify-content:flex-start;align-items:flex-end;flex-direction:column;background-color:transparent;border:1px solid #fff;padding:10px}.actions[_ngcontent-%COMP%], .counter-overlay[_ngcontent-%COMP%]{position:absolute;display:flex}.counter-overlay[_ngcontent-%COMP%]{width:50%;height:50%;border-radius:100%;background-color:hsla(0,0%,100%,.3);color:#000;font-size:2em;justify-content:center;align-items:center}.mousover-overlay[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;top:0;left:0}.info-stats[_ngcontent-%COMP%]{width:100%;justify-content:space-between}.info-stat-col[_ngcontent-%COMP%], .info-stats[_ngcontent-%COMP%]{display:flex;align-items:center}.info-stat-col[_ngcontent-%COMP%]{width:30%;justify-content:center;flex-direction:column}.info-stat-col[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{text-align:center}.info-stat-col.full[_ngcontent-%COMP%]{width:100%}.info-stat-col.full[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:5px 0}.info-image[_ngcontent-%COMP%]{border-radius:5px;border:1px solid #fff}.stat[_ngcontent-%COMP%]{color:#000;background:none;border:none;position:absolute;width:48px;height:48px;border-radius:100%;background-size:cover;background-position:50%;font-size:1.2em}.stat[_ngcontent-%COMP%], .stat[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.stat[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{z-index:1;width:100%;height:100%;font-size:1.3em}.cost[_ngcontent-%COMP%]{top:-16px;left:-16px}.mov[_ngcontent-%COMP%]{left:-16px}.btl[_ngcontent-%COMP%], .mov[_ngcontent-%COMP%]{bottom:-16px}.btl[_ngcontent-%COMP%]{right:-16px}.view[_ngcontent-%COMP%]{bottom:-16px;left:calc(50% - 16px);background-color:#fff;border-radius:100%;width:32px;height:32px;border:1px solid #000}.attribute[_ngcontent-%COMP%]{width:52px;height:52px;top:-24px;left:calc(50% - 26px);background-color:#000;border-radius:100%;border:1px solid #fff;overflow:hidden}.attribute[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:100%}.vit[_ngcontent-%COMP%]{top:-16px;right:-16px}.vit[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{position:relative;top:-3px}.icon-bg[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;filter:drop-shadow(0 0 3px black)}.stat.status[_ngcontent-%COMP%]{right:-16px;top:50%;background-color:purple}"]}),T);function D(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",30),p.Wb("click",(function(){p.ic(n);var e=t.$implicit,r=p.Yb(3);return e.sm.setState("clicked",{board:r.board,profile:r.board.players.red})})),p.Mb(1,"div",31),p.Mb(2,"div",32),p.Nb()}if(2&e){var r=t.$implicit;p.Cb("cell ",r.sm.values.classes.join(" ")," cell-x-",r.sm.values.x,"-y-",r.sm.values.y,"")}}var E=function(e){return[e]};function N(e,t){if(1&e&&(p.Ob(0,"div",28),p.nc(1,D,3,5,"div",29),p.Nb()),2&e){var n=t.index,r=p.Yb().index,i=p.Yb();p.Bb("y-",n,""),p.zb(1),p.bc("ngForOf",p.fc(4,E,i.board.getCell(r,n)))}}var I=function(){return[]};function j(e,t){if(1&e&&(p.Ob(0,"div",26),p.nc(1,N,2,6,"div",27),p.Nb()),2&e){var n=t.index,r=p.Yb();p.Bb("x-",n,""),p.zb(1),p.bc("ngForOf",p.ec(4,I).constructor(r.board.height))}}function z(e,t){1&e&&p.Mb(0,"div",33)}function F(e,t){1&e&&p.Mb(0,"div",34)}function A(e,t){1&e&&p.Mb(0,"div",34)}function B(e,t){1&e&&p.Mb(0,"div",33)}function L(e,t){if(1&e){var n=p.Pb();p.Ob(0,"app-dice",35),p.Wb("click",(function(){p.ic(n);var e=t.$implicit;return p.Yb().selectDice(e)})),p.Nb()}2&e&&p.bc("dice",t.$implicit)}function Y(e,t){if(1&e){var n=p.Pb();p.Ob(0,"app-dice",36),p.Wb("click",(function(){p.ic(n);var e=t.$implicit;return p.Yb().unselectDice(e)})),p.Nb()}2&e&&p.bc("dice",t.$implicit)}function U(e,t){1&e&&p.Mb(0,"app-dice",37),2&e&&p.bc("dice",t.$implicit)}function W(e,t){1&e&&p.Mb(0,"app-dice",38),2&e&&p.bc("dice",t.$implicit)}function G(e,t){if(1&e&&p.Mb(0,"app-card-mini",42),2&e){var n=t.$implicit,r=p.Yb(2);p.bc("board",r.board)("card",n)}}function V(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",39),p.nc(1,G,1,2,"app-card-mini",40),p.Ob(2,"ion-img",41),p.Wb("click",(function(){return p.ic(n),p.Yb().closeCardView()})),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.zb(1),p.bc("ngForOf",r.board.players.red.cardsCaboodle.getFiltered("isInDeck",!0))}}function H(e,t){if(1&e&&(p.Ob(0,"div"),p.Mb(1,"ion-img",52),p.Nb()),2&e){var n=p.Yb(2);p.zb(1),p.cc("src",n.board.players.red.sm.values.avatar)}}function q(e,t){1&e&&(p.Ob(0,"div",53),p.oc(1," \ud83d\udfe2 "),p.Nb())}function $(e,t){1&e&&(p.Ob(0,"div",54),p.oc(1," \u26aa "),p.Nb())}function K(e,t){if(1&e&&(p.Ob(0,"div",46),p.Mb(1,"ion-img",56),p.oc(2),p.Nb()),2&e){var n=p.Yb().$implicit,r=p.Yb(2);p.zb(1),p.cc("src",r.util.getDiceFace(n)),p.zb(1),p.qc(" ",r.game.figures.red.castsByAttribute[n]," ")}}function J(e,t){if(1&e&&(p.Ob(0,"div"),p.nc(1,K,3,2,"div",55),p.Nb()),2&e){var n=t.$implicit,r=p.Yb(2);p.zb(1),p.bc("ngIf",r.game.figures.red.castsByAttribute[n]>0)}}function X(e,t){if(1&e&&(p.Ob(0,"div",46),p.Mb(1,"ion-img",56),p.oc(2),p.Nb()),2&e){var n=p.Yb().$implicit,r=p.Yb(2);p.zb(1),p.cc("src",r.util.getDiceFace(n)),p.zb(1),p.qc(" ",r.game.figures.red.minted[n]," ")}}function Q(e,t){if(1&e&&(p.Ob(0,"div"),p.nc(1,X,3,2,"div",55),p.Nb()),2&e){var n=t.$implicit,r=p.Yb(2);p.zb(1),p.bc("ngIf",r.game.figures.red.minted[n]>0)}}function Z(e,t){if(1&e&&(p.Ob(0,"div",46),p.Mb(1,"ion-img",56),p.oc(2),p.Nb()),2&e){var n=p.Yb().$implicit,r=p.Yb(2);p.zb(1),p.cc("src",r.util.getDiceFace(n)),p.zb(1),p.qc(" ",r.game.figures.red.burnt[n]," ")}}function ee(e,t){if(1&e&&(p.Ob(0,"div"),p.nc(1,Z,3,2,"div",55),p.Nb()),2&e){var n=t.$implicit,r=p.Yb(2);p.zb(1),p.bc("ngIf",r.game.figures.red.burnt[n]>0)}}function te(e,t){if(1&e&&(p.Ob(0,"div"),p.Mb(1,"ion-img",52),p.Nb()),2&e){var n=p.Yb(2);p.zb(1),p.cc("src",n.board.players.blue.sm.values.avatar||n.board.players.blue.avatar)}}function ne(e,t){1&e&&(p.Ob(0,"div",53),p.oc(1," \ud83d\udfe2 "),p.Nb())}function re(e,t){1&e&&(p.Ob(0,"div",54),p.oc(1," \u26aa "),p.Nb())}function ie(e,t){if(1&e&&(p.Ob(0,"div",46),p.Mb(1,"ion-img",56),p.oc(2),p.Nb()),2&e){var n=p.Yb().$implicit,r=p.Yb(2);p.zb(1),p.cc("src",r.util.getDiceFace(n)),p.zb(1),p.qc(" ",r.game.figures.blue.castsByAttribute[n]," ")}}function oe(e,t){if(1&e&&(p.Ob(0,"div"),p.nc(1,ie,3,2,"div",55),p.Nb()),2&e){var n=t.$implicit,r=p.Yb(2);p.zb(1),p.bc("ngIf",r.game.figures.blue.castsByAttribute[n]>0)}}function ae(e,t){if(1&e&&(p.Ob(0,"div",46),p.Mb(1,"ion-img",56),p.oc(2),p.Nb()),2&e){var n=p.Yb().$implicit,r=p.Yb(2);p.zb(1),p.cc("src",r.util.getDiceFace(n)),p.zb(1),p.qc(" ",r.game.figures.blue.minted[n]," ")}}function ce(e,t){if(1&e&&(p.Ob(0,"div"),p.nc(1,ae,3,2,"div",55),p.Nb()),2&e){var n=t.$implicit,r=p.Yb(2);p.zb(1),p.bc("ngIf",r.game.figures.blue.minted[n]>0)}}function se(e,t){if(1&e&&(p.Ob(0,"div",46),p.Mb(1,"ion-img",56),p.oc(2),p.Nb()),2&e){var n=p.Yb().$implicit,r=p.Yb(2);p.zb(1),p.cc("src",r.util.getDiceFace(n)),p.zb(1),p.qc(" ",r.game.figures.blue.burnt[n]," ")}}function de(e,t){if(1&e&&(p.Ob(0,"div"),p.nc(1,se,3,2,"div",55),p.Nb()),2&e){var n=t.$implicit,r=p.Yb(2);p.zb(1),p.bc("ngIf",r.game.figures.blue.burnt[n]>0)}}function le(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",43),p.Ob(1,"div",44),p.nc(2,H,2,1,"div",45),p.Ob(3,"div"),p.oc(4),p.Nb(),p.Ob(5,"div",46),p.nc(6,q,2,0,"div",47),p.nc(7,$,2,0,"div",48),p.Nb(),p.Ob(8,"div",46),p.oc(9),p.Nb(),p.Ob(10,"div",49),p.oc(11,"Casts by attribute"),p.Nb(),p.Ob(12,"div",46),p.nc(13,J,2,1,"div",50),p.Nb(),p.Ob(14,"div",49),p.oc(15,"Minted"),p.Nb(),p.Ob(16,"div",46),p.nc(17,Q,2,1,"div",50),p.Nb(),p.Ob(18,"div",49),p.oc(19,"Burnt"),p.Nb(),p.Ob(20,"div",46),p.nc(21,ee,2,1,"div",50),p.Nb(),p.Nb(),p.Ob(22,"div",51),p.nc(23,te,2,1,"div",45),p.Ob(24,"div"),p.oc(25),p.Nb(),p.Ob(26,"div",46),p.nc(27,ne,2,0,"div",47),p.nc(28,re,2,0,"div",48),p.Nb(),p.Ob(29,"div",46),p.oc(30),p.Nb(),p.Ob(31,"div",49),p.oc(32,"Casts by attribute"),p.Nb(),p.Ob(33,"div",46),p.nc(34,oe,2,1,"div",50),p.Nb(),p.Ob(35,"div",49),p.oc(36,"Minted"),p.Nb(),p.Ob(37,"div",46),p.nc(38,ce,2,1,"div",50),p.Nb(),p.Ob(39,"div",49),p.oc(40,"Burnt"),p.Nb(),p.Ob(41,"div",46),p.nc(42,de,2,1,"div",50),p.Nb(),p.Nb(),p.Ob(43,"ion-img",41),p.Wb("click",(function(){return p.ic(n),p.Yb().toggleFigures()})),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.zb(2),p.bc("ngIf",r.board.players.red.sm.values.avatar),p.zb(2),p.pc(r.board.players.red.alias),p.zb(2),p.bc("ngForOf",p.ec(16,I).constructor(r.board.players.red.sm.values.winStrikes)),p.zb(1),p.bc("ngForOf",p.ec(17,I).constructor(5-r.board.players.red.sm.values.winStrikes)),p.zb(2),p.qc("Number Of Casts: ",r.game.figures.red.numberOfCasts,""),p.zb(4),p.bc("ngForOf",r.objectKeys(r.game.figures.red.castsByAttribute)),p.zb(4),p.bc("ngForOf",r.objectKeys(r.game.figures.red.minted)),p.zb(4),p.bc("ngForOf",r.objectKeys(r.game.figures.red.burnt)),p.zb(2),p.bc("ngIf",r.board.players.blue.sm.values.avatar||""!==r.board.players.blue.avatar),p.zb(2),p.pc(r.board.players.blue.alias),p.zb(2),p.bc("ngForOf",p.ec(18,I).constructor(r.board.players.blue.sm.values.winStrikes)),p.zb(1),p.bc("ngForOf",p.ec(19,I).constructor(5-r.board.players.blue.sm.values.winStrikes)),p.zb(2),p.qc("Number Of Casts: ",r.game.figures.blue.numberOfCasts,""),p.zb(4),p.bc("ngForOf",r.objectKeys(r.game.figures.blue.castsByAttribute)),p.zb(4),p.bc("ngForOf",r.objectKeys(r.game.figures.blue.minted)),p.zb(4),p.bc("ngForOf",r.objectKeys(r.game.figures.blue.burnt))}}var pe,ue=((pe=function(){function e(){_classCallCheck(this,e),this.util=s.j}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"toggleDrawerMenu",value:function(){this.board.events.emit("isDrawerVisible",{})}},{key:"toggleDeckModal",value:function(){this.board.players.red.sm.enable("isModalVisible"),this.board.players.red.sm.enable("showBoardDeck")}},{key:"toggleDiceModal",value:function(){this.board.players.red.sm.enable("isModalVisible"),this.board.players.red.sm.enable("showDicePool")}},{key:"selectDice",value:function(e){this.board.players.red.dice.getDeckSelected().length<3&&e.sm.setState("selectFn-"+e.hash,{}),this.board.players.red.sm.disable("isActionActive"),this.board.players.blue.sm.disable("isActionActive")}},{key:"unselectDice",value:function(e){e.sm.setState("unselectFn-"+e.hash,{}),this.board.players.red.sm.disable("isActionActive"),this.board.players.blue.sm.disable("isActionActive")}},{key:"closeCardView",value:function(){this.board.sm.disable("viewDeck")}},{key:"getHelp",value:function(){this.board.sm.enable("showHelp")}},{key:"exit",value:function(){window.location.reload()}},{key:"toggleFigures",value:function(){this.board.sm.toggle("displayFiguresModal")}},{key:"objectValues",value:function(e){return Object.values(e)}},{key:"objectKeys",value:function(e){return Object.keys(e)}}]),e}()).\u0275fac=function(e){return new(e||pe)},pe.\u0275cmp=p.Fb({type:pe,selectors:[["app-board"]],inputs:{board:"board",game:"game"},decls:37,vars:20,consts:[[1,"perspective-twister"],[1,"play-area"],[1,"table-border"],[1,"table-top"],["class","play-row",3,"class",4,"ngFor","ngForOf"],[1,"player-menu","blue-player-menu"],[1,"menu-item"],[1,"strike-counter"],["class","strike strike-empty",4,"ngFor","ngForOf"],["class","strike strike-full",4,"ngFor","ngForOf"],[1,"player-menu","red-player-menu"],[1,"dice-pool"],["class","dice-deck",3,"dice","click",4,"ngFor","ngForOf"],[1,"selected-dice"],["class","dice-selected",3,"dice","click",4,"ngFor","ngForOf"],[1,"dice-pool","rival-dice-pool"],["class","dice-selected",3,"dice",4,"ngFor","ngForOf"],["class","dice-deck",3,"dice",4,"ngFor","ngForOf"],[1,"energy-pool"],[3,"profile","board"],[1,"energy-pool","rival-energy-pool"],[1,"floating-left-menu"],[1,"btn",3,"click"],["class","full-board-deck",4,"ngIf"],["class","figures-modal",4,"ngIf"],["id","lazyRefresh"],[1,"play-row"],["class","play-col",3,"class",4,"ngFor","ngForOf"],[1,"play-col"],["class","play-cell",3,"class","click",4,"ngFor","ngForOf"],[1,"play-cell",3,"click"],[1,"cell-borders"],[1,"positioner"],[1,"strike","strike-empty"],[1,"strike","strike-full"],[1,"dice-deck",3,"dice","click"],[1,"dice-selected",3,"dice","click"],[1,"dice-selected",3,"dice"],[1,"dice-deck",3,"dice"],[1,"full-board-deck"],[3,"board","card",4,"ngFor","ngForOf"],["src","assets/icons/cancel.png",1,"close-modal",3,"click"],[3,"board","card"],[1,"figures-modal"],[1,"player","red"],[4,"ngIf"],[1,"item"],["class","full",4,"ngFor","ngForOf"],["class","empty",4,"ngFor","ngForOf"],[1,"attribute-casts"],[4,"ngFor","ngForOf"],[1,"player","blue"],[1,"avatar",3,"src"],[1,"full"],[1,"empty"],["class","item",4,"ngIf"],[1,"icon",3,"src"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.Ob(1,"div",1),p.Mb(2,"div",2),p.Mb(3,"div",3),p.nc(4,j,2,5,"div",4),p.Ob(5,"div",5),p.Ob(6,"div",6),p.Ob(7,"div",7),p.nc(8,z,1,0,"div",8),p.nc(9,F,1,0,"div",9),p.Nb(),p.Nb(),p.Nb(),p.Ob(10,"div",10),p.Ob(11,"div",6),p.Ob(12,"div",7),p.nc(13,A,1,0,"div",9),p.nc(14,B,1,0,"div",8),p.Nb(),p.Nb(),p.Nb(),p.Ob(15,"div",11),p.nc(16,L,1,1,"app-dice",12),p.Ob(17,"div",13),p.nc(18,Y,1,1,"app-dice",14),p.Nb(),p.Nb(),p.Ob(19,"div",15),p.Ob(20,"div",13),p.nc(21,U,1,1,"app-dice",16),p.Nb(),p.nc(22,W,1,1,"app-dice",17),p.Nb(),p.Nb(),p.Ob(23,"div",18),p.Mb(24,"app-energy-pool",19),p.Nb(),p.Ob(25,"div",20),p.Mb(26,"app-energy-pool",19),p.Nb(),p.Nb(),p.Ob(27,"div",21),p.Ob(28,"div",22),p.Wb("click",(function(){return t.toggleFigures()})),p.oc(29,"Figures"),p.Nb(),p.Ob(30,"div",22),p.Wb("click",(function(){return t.getHelp()})),p.oc(31,"Help"),p.Nb(),p.Ob(32,"div",22),p.Wb("click",(function(){return t.exit()})),p.oc(33,"Exit"),p.Nb(),p.Nb(),p.nc(34,V,3,1,"div",23),p.nc(35,le,44,20,"div",24),p.Mb(36,"div",25)),2&e&&(p.zb(4),p.bc("ngForOf",p.ec(15,I).constructor(t.board.width)),p.zb(4),p.bc("ngForOf",p.ec(16,I).constructor(5-t.board.players.blue.sm.values.winStrikes)),p.zb(1),p.bc("ngForOf",p.ec(17,I).constructor(t.board.players.blue.sm.values.winStrikes)),p.zb(4),p.bc("ngForOf",p.ec(18,I).constructor(t.board.players.red.sm.values.winStrikes)),p.zb(1),p.bc("ngForOf",p.ec(19,I).constructor(5-t.board.players.red.sm.values.winStrikes)),p.zb(2),p.bc("ngForOf",t.board.players.red.diceCaboodle.getInDeckUnselected()),p.zb(2),p.bc("ngForOf",t.board.players.red.diceCaboodle.getFiltered("isSelected",!0)),p.zb(3),p.bc("ngForOf",t.board.players.blue.diceCaboodle.getFiltered("isSelected",!0)),p.zb(1),p.bc("ngForOf",t.board.players.blue.diceCaboodle.getInDeckUnselected()),p.zb(2),p.bc("profile",t.board.players.red)("board",t.board),p.zb(2),p.bc("profile",t.board.players.blue)("board",t.board),p.zb(8),p.bc("ngIf",t.board.sm.values.viewDeck),p.zb(1),p.bc("ngIf",t.board.sm.values.displayFiguresModal))},directives:[r.i,g,r.j,_,R],styles:[".perspective-twister[_ngcontent-%COMP%]{perspective:1000px}.perspective-twister[_ngcontent-%COMP%], .play-area[_ngcontent-%COMP%]{width:-webkit-min-content;width:-moz-min-content;width:min-content}.play-area[_ngcontent-%COMP%]{position:relative;transform-origin:center;transform:rotateX(15deg)}@media only screen and (max-width:1550px){.play-area[_ngcontent-%COMP%]{transform:rotate(0deg)}.floating-left-menu[_ngcontent-%COMP%]{display:none}}.play-row[_ngcontent-%COMP%]{width:100%}.play-cell[_ngcontent-%COMP%], .play-row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.play-cell[_ngcontent-%COMP%]{font-size:1.5em;font-weight:700;width:64px;height:64px;color:#fff;position:relative}.positioner[_ngcontent-%COMP%]{width:0;height:0;position:absolute;top:50%;left:50%}.cell-borders[_ngcontent-%COMP%]{border:1px solid hsla(0,0%,100%,.4);position:absolute;top:0;left:0;width:80%;height:80%;margin:10%;border-radius:10px}.play-cell[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:150%;height:150%;position:absolute;top:-3px;left:-19px}.board-battlers-container[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;top:0;left:0}app-board-battler[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transition:.3s}.cell[_ngcontent-%COMP%]{font-size:.8em}.sprite[_ngcontent-%COMP%]{width:100%;height:100%}.board-background[_ngcontent-%COMP%]{position:absolute;width:1080px;height:1080px;left:-253px;top:-253px}.wall[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{border:none;background-color:transparent}.floor[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{border:1px solid #000}.red-player-tile[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{background-color:rgba(235,68,90,.4)}.blue-player-tile[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{background-color:rgba(56,128,255,.7)}.player-tile-locked[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{background-color:rgba(235,68,90,.3)}.victory-tile[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{background-color:rgba(106,27,154,.7)}.neutral-ground[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.2)}.vit-restore[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{background-color:rgba(45,211,111,.7)}.possible-hex-target[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{border:3px solid purple;background-color:rgba(138,43,226,.3)}.possible-cast-tile[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%], .possible-unfold-tile[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{border:3px solid #dedede;background-color:hsla(0,0%,100%,.3)}.possible-move-tile[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{border:3px solid #01579b;background-color:rgba(1,87,155,.3)}.possible-battle-tile[_ngcontent-%COMP%]   .cell-borders[_ngcontent-%COMP%]{border:3px solid #b71c1c;background-color:rgba(183,28,28,.3)}.table-top[_ngcontent-%COMP%]{background-image:url(/assets/backgrounds/tabletop.jpg);height:calc(100% + 10px);width:calc(100% + 10px);border:5px solid #000;top:-5px;left:-5px;border-radius:10px}.table-border[_ngcontent-%COMP%], .table-top[_ngcontent-%COMP%]{background-repeat:repeat;position:absolute}.table-border[_ngcontent-%COMP%]{width:140%;height:120%;background-image:url(/assets/backgrounds/wood-table.jpg);border-radius:10px;top:-10%;left:-20%;box-shadow:0 0 25px #000}.menu-item[_ngcontent-%COMP%]{padding:10px;background-color:#000;transition:.3s;position:relative;border-radius:5px;border:1px solid #000;height:-webkit-min-content;height:-moz-min-content;height:min-content}.menu-item[_ngcontent-%COMP%]:hover{text-shadow:0 0 3px #fff;border:1px solid #fff}.player-menu[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;position:absolute}.blue-player-menu[_ngcontent-%COMP%]{top:-57px;right:-214px}.blue-player-menu[_ngcontent-%COMP%], .red-player-menu[_ngcontent-%COMP%]{width:-webkit-min-content;width:-moz-min-content;width:min-content}.red-player-menu[_ngcontent-%COMP%]{bottom:-57px;left:-214px}.strike-counter[_ngcontent-%COMP%]{min-width:75px;max-width:200px;display:flex;justify-content:space-evenly;align-items:center}.strike[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:100%;border:1px solid #fff;margin:0 10px}.strike-empty[_ngcontent-%COMP%]{background-color:#454545}.strike-full[_ngcontent-%COMP%]{background-color:#64dd17;box-shadow:0 0 5px #fff}.board-bottom-appendix[_ngcontent-%COMP%]{top:64px;width:120%;background-image:url(/assets/backgrounds/wood-table.jpg);background-repeat:repeat;border-radius:5px;justify-content:space-evenly}.board-bottom-appendix[_ngcontent-%COMP%], .dice-pool[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center}.dice-pool[_ngcontent-%COMP%]{left:-15%;height:50%;width:10%;flex-direction:column;top:50%;justify-content:flex-end}.selected-dice[_ngcontent-%COMP%]{width:150%;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column;border:1px solid #fff;background-color:#000}.dice-pool.rival-dice-pool[_ngcontent-%COMP%]{left:105%;top:0}.dice-pool[_ngcontent-%COMP%]   app-dice[_ngcontent-%COMP%]{margin:10px}.energy-pool[_ngcontent-%COMP%]{position:absolute;top:0;height:50%;width:200px;left:-210px}.energy-pool.rival-energy-pool[_ngcontent-%COMP%]{top:unset;bottom:0;right:-210px;left:unset}.hidden[_ngcontent-%COMP%]{display:none}.selected[_ngcontent-%COMP%]{border:5px solid purple}.dice-selected[_ngcontent-%COMP%]{background-color:hsla(0,0%,100%,.5);box-shadow:0 0 20px #fff}.full-board-deck[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.9);width:100vw;height:100vh;position:fixed;top:0;left:0;display:flex;justify-content:center;align-items:center;flex-wrap:wrap;overflow-y:scroll}.full-board-deck[_ngcontent-%COMP%]   app-card-mini[_ngcontent-%COMP%]{margin:30px}.close-modal[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;transition:.3s}.close-modal[_ngcontent-%COMP%]:hover{filter:drop-shadow(0 0 3px white)}.floating-left-menu[_ngcontent-%COMP%]{position:fixed;top:20px;left:20px;width:100px}.floating-left-menu[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%;background-color:#000;color:#fff;border:1px solid #fff;margin:5px 0;text-align:center;padding:5px 0}.figures-modal[_ngcontent-%COMP%]{z-index:2;position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0,0,0,.9)}.figures-modal[_ngcontent-%COMP%], .figures-modal[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.figures-modal[_ngcontent-%COMP%]   .player[_ngcontent-%COMP%]{width:40%;height:80%;background-color:#000;border:1px solid #343434;flex-direction:column}.figures-modal[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:32px;border-radius:100%;border:1px solid #fff;overflow:hidden}.figures-modal[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.figures-modal[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:128px}"]}),pe);function fe(e,t){if(1&e&&p.Mb(0,"div",10),2&e){var n=p.Yb(2);p.mc("left:",-1*n.card.offset.x,"px;bottom: ",-1*n.card.offset.y,"px;")}}function be(e,t){if(1&e&&p.Mb(0,"ion-img",11),2&e){var n=p.Yb(2);p.cc("src",n.card.sm.values.equipedCard.battlerUrl)}}var he=function(e){return{animated:e}};function ge(e,t){if(1&e&&p.Mb(0,"ion-img",14),2&e){var n=p.Yb(3);p.bc("ngClass",p.fc(1,he,n.card.sm.values.showPoisonAnimation))}}function me(e,t){if(1&e&&(p.Ob(0,"div",12),p.nc(1,ge,1,3,"ion-img",13),p.Nb()),2&e){var n=p.Yb(2);p.zb(1),p.bc("ngIf","Poison"===n.card.sm.values.status.name)}}function ve(e,t){1&e&&(p.Ob(0,"div",15),p.Mb(1,"ion-img",16),p.Nb())}var ye=function(e){return{"rival-battler":e}},Ce=function(e,t,n){return{"rival-illustration":e,"click-events-disable":t,"click-events-enable":n}};function _e(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",1),p.nc(1,fe,1,4,"div",2),p.Ob(2,"div",3),p.Ob(3,"div",4),p.oc(4),p.Nb(),p.Mb(5,"ion-progress-bar",5),p.Nb(),p.Ob(6,"ion-img",6),p.Wb("dblclick",(function(){return p.ic(n),p.Yb().showCard()})),p.Nb(),p.nc(7,be,1,1,"ion-img",7),p.nc(8,me,2,1,"div",8),p.nc(9,ve,2,0,"div",9),p.Nb()}if(2&e){var r=p.Yb();p.bc("ngClass",p.fc(10,ye,!r.profile.sm.values.isPlayer)),p.zb(1),p.bc("ngIf",!r.profile.sm.values.isBattlePending&&!r.profile.sm.values.isMovePending),p.zb(3),p.rc(" ",r.card.sm.values.vit,"/",r.card.vit," "),p.zb(1),p.cc("value",r.card.sm.values.vit/r.card.vit),p.zb(1),p.cc("src",r.card.battlerUrl),p.bc("ngClass",p.gc(12,Ce,!r.profile.sm.values.isPlayer,r.board.players.red.sm.values.isActionActive,!r.board.players.red.sm.values.isActionActive)),p.zb(1),p.bc("ngIf",r.card.sm.values.equipedCard),p.zb(1),p.bc("ngIf",r.card.sm.values.status.active),p.zb(1),p.bc("ngIf",r.card.sm.values.showDamageAnimation)}}var Oe,Pe=((Oe=function(){function e(){_classCallCheck(this,e),this.util=s.j}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"toggleTooltip",value:function(){this.card.sm.values.canBeClicked&&(this.card.sm.values.isBoardMenuVisible=!this.card.sm.values.isBoardMenuVisible)}},{key:"vitPercent",value:function(){return Math.floor(100*this.card.sm.values.vit/this.card.vit)}},{key:"moveBg",value:function(){this.board.sm.setState("moveBg",{card:this.card})}},{key:"showCard",value:function(){this.board.sm.setValue("cardInDisplay",this.card)}}]),e}()).\u0275fac=function(e){return new(e||Oe)},Oe.\u0275cmp=p.Fb({type:Oe,selectors:[["app-board-battler"]],inputs:{board:"board",profile:"profile",card:"card"},decls:1,vars:1,consts:[["class","board-battler",3,"ngClass",4,"ngIf"],[1,"board-battler",3,"ngClass"],["class","creature-shadow",3,"style",4,"ngIf"],[1,"vit-container","click-events-disable"],[1,"vit-txt"],[3,"value"],[1,"illustration",3,"src","ngClass","dblclick"],["class","equiped-card",3,"src",4,"ngIf"],["class","current-status",4,"ngIf"],["class","animation damage-animation",4,"ngIf"],[1,"creature-shadow"],[1,"equiped-card",3,"src"],[1,"current-status"],["src","/assets/icons/poison.png",3,"ngClass",4,"ngIf"],["src","/assets/icons/poison.png",3,"ngClass"],[1,"animation","damage-animation"],["src","/assets/gifs/explosion.gif"]],template:function(e,t){1&e&&p.nc(0,_e,10,16,"div",0),2&e&&p.bc("ngIf",!t.card.sm.values.clans.includes("Hex"))},directives:[r.j,r.h],styles:['.board-battler[_ngcontent-%COMP%]{width:100px;height:100px;z-index:9999}.board-battler[_ngcontent-%COMP%], .tooltip[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.tooltip[_ngcontent-%COMP%]{position:absolute;height:80px;background-color:rgba(0,0,0,.8);overflow:hidden;text-align:center;font-size:.8em;width:100%;padding:3px;top:-80px;border-radius:5px}.edge-container[_ngcontent-%COMP%]{width:100%;height:50%;display:flex;justify-content:space-around;align-items:center}ion-img[_ngcontent-%COMP%]{height:100%}.board-edge[_ngcontent-%COMP%]{height:100%;max-width:30%;background-color:transparent;padding:3px;border-radius:5px}.can-move[_ngcontent-%COMP%]{background-color:#fa9d1c}.can-attack[_ngcontent-%COMP%]{background-color:#f85859}.can-deffend[_ngcontent-%COMP%]{background-color:#2d3e48}.can-special[_ngcontent-%COMP%]{background-color:#f9fdfe}.card-name[_ngcontent-%COMP%]{width:100%;height:50%;display:flex;justify-content:center;align-items:center}.illustration[_ngcontent-%COMP%]{filter:drop-shadow(0 0 5px white)}.vit-txt[_ngcontent-%COMP%]{position:absolute;z-index:1}.tooltip.hidden[_ngcontent-%COMP%]{display:none}.tooltip.visible[_ngcontent-%COMP%]{display:flex}.board-card-menu[_ngcontent-%COMP%]{position:absolute;width:320px;background-color:transparent;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;transition:.3s}.board-card-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{position:relative;width:100%;background-color:rgba(55,71,79,.6);border:1px solid #78909c;border-bottom-color:#607d8b;display:flex;justify-content:center;align-items:center;text-align:center}.board-card-menu[_ngcontent-%COMP%]   .menu-item.h1[_ngcontent-%COMP%]{font-weight:700}.card-right-menu[_ngcontent-%COMP%]{left:100%;top:0;width:160px}.card-top-menu[_ngcontent-%COMP%]{top:-100px;width:300px}.board-card-menu.hidden[_ngcontent-%COMP%]{display:none}.board-card-menu.visible[_ngcontent-%COMP%]{display:flex}.rival-illustration[_ngcontent-%COMP%]{transform:scaleX(-1)}.action-ring[_ngcontent-%COMP%]{position:absolute;border:5px solid #263238;border-radius:100%;width:100px;height:100px}.top-triangle[_ngcontent-%COMP%]{border-bottom:10px solid #263238;top:-21px}.bottom-triangle[_ngcontent-%COMP%], .top-triangle[_ngcontent-%COMP%]{width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;position:absolute;left:calc(50% - 8.5px)}.bottom-triangle[_ngcontent-%COMP%]{border-top:10px solid #263238;bottom:-40px}.left-triangle[_ngcontent-%COMP%]{border-right:10px solid #263238;left:-13px}.left-triangle[_ngcontent-%COMP%], .right-triangle[_ngcontent-%COMP%]{width:0;height:0;border-top:10px solid transparent;border-bottom:10px solid transparent;position:absolute;top:calc(50% - 8.5px)}.right-triangle[_ngcontent-%COMP%]{border-left:10px solid #263238;right:-13px}.action-ring[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:64px;bottom:-32px;left:calc(50% - 32px);height:64px;padding:10px}.action-ring[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%], .step-counter[_ngcontent-%COMP%]{position:absolute;background-color:#263238;border-radius:100%;border:3px solid #263238}.step-counter[_ngcontent-%COMP%]{width:32px;height:32px;display:flex;justify-content:center;align-items:center;font-size:1.1em;left:calc(50% - 16px);top:-16px}.progress-bar-text[_ngcontent-%COMP%]{color:#fff;z-index:1}app-chip[_ngcontent-%COMP%]{width:100%}.menu-item-red[_ngcontent-%COMP%]{background-color:#eb445a!important}.menu-item-blue[_ngcontent-%COMP%]{background-color:#3880ff!important}.creature-shadow[_ngcontent-%COMP%]{position:absolute;background-color:rgba(0,0,0,.5);bottom:0;width:60%;margin-left:20%;height:30px;border-radius:100%}.creature-shadow-red[_ngcontent-%COMP%]{border:2.5px solid #eb445a}.creature-shadow-blue[_ngcontent-%COMP%]{border:2.5px solid #3880ff}.action-img[_ngcontent-%COMP%]:hover:after{width:64px;height:64px;content:"x";background-color:#263238;top:-3px;left:-3px;position:absolute;border-radius:100%;font-size:3em;text-align:center;line-height:56px}.cast-animation[_ngcontent-%COMP%]{position:absolute;background-image:url(/assets/spritesheets/cast.png);top:calc(50% - 100px);left:calc(50% - 100px);width:200px;height:200px;background-size:1000px 600px;z-index:9999;-webkit-animation:playCastX .3s steps(5) infinite,playCastY .9s steps(3) infinite,playHide .9s steps(5) forwards;animation:playCastX .3s steps(5) infinite,playCastY .9s steps(3) infinite,playHide .9s steps(5) forwards}@-webkit-keyframes playCastX{0%{background-position-x:0}to{background-position-x:-1000px}}@keyframes playCastX{0%{background-position-x:0}to{background-position-x:-1000px}}@-webkit-keyframes playCastY{0%{background-position-y:0}to{background-position-y:-600px}}@keyframes playCastY{0%{background-position-y:0}to{background-position-y:-600px}}@-webkit-keyframes playHide{0%{opacity:1}to{opacity:0}}@keyframes playHide{0%{opacity:1}to{opacity:0}}.attack-animation[_ngcontent-%COMP%]{position:absolute;background-image:url(/assets/spritesheets/attack.png);top:calc(50% - 100px);left:calc(50% - 100px);width:200px;height:200px;background-size:600px 200px;z-index:9999;-webkit-animation:playAttackX .15s steps(3) infinite;animation:playAttackX .15s steps(3) infinite}@-webkit-keyframes playAttackX{0%{background-position-x:0}to{background-position-x:-600px}}@keyframes playAttackX{0%{background-position-x:0}to{background-position-x:-600px}}.menu[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%}.menu-info[_ngcontent-%COMP%]{width:200%;left:-210%}.menu-actions[_ngcontent-%COMP%], .menu-info[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;flex-direction:column;align-items:center}.menu-actions[_ngcontent-%COMP%]{right:-120%;width:100%}.menu-action[_ngcontent-%COMP%], .menu-item[_ngcontent-%COMP%]{border:1px solid #dedede;transition:.3s;width:100%;margin:1px 0;text-align:center;background-color:#000}.menu-action[_ngcontent-%COMP%]:hover{background-color:#232323;border:1px solid #fff}.vit-txt[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:.8em}.vit-container[_ngcontent-%COMP%]{position:absolute;width:100%;top:-18px;height:18px;display:flex;justify-content:center;align-items:center;border:1px solid #000;border-radius:5px;overflow:hidden}.vit-container[_ngcontent-%COMP%]   ion-progress-bar[_ngcontent-%COMP%]{position:absolute;left:0;transition:.3s;height:100%;--background:#dedede;--progress-background:#8b0000;--buffer-background:#121212}.rival-battler[_ngcontent-%COMP%]   ion-progress-bar[_ngcontent-%COMP%]{--progress-background:#00008b}.animation[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;z-index:9999}.animation[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{position:relative;left:-25%;top:-25%;z-index:9999;width:150%;height:150%}.equiped-card[_ngcontent-%COMP%]{position:absolute;left:-50%;bottom:-50%;width:128px;height:128px;filter:drop-shadow(0 0 5px white)}@-webkit-keyframes heartbeat{0%{transform:scale(.75)}20%{transform:scale(1)}40%{transform:scale(.75)}60%{transform:scale(1)}80%{transform:scale(.75)}to{transform:scale(.75)}}@keyframes heartbeat{0%{transform:scale(.75)}20%{transform:scale(1)}40%{transform:scale(.75)}60%{transform:scale(1)}80%{transform:scale(.75)}to{transform:scale(.75)}}.current-status[_ngcontent-%COMP%]{position:absolute;width:64px;right:-32px;top:-32px}.current-status[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{filter:drop-shadow(0 0 3px white)}.current-status[_ngcontent-%COMP%]   ion-img.animated[_ngcontent-%COMP%]{filter:drop-shadow(0 0 7px purple);-webkit-animation:heartbeat .3s infinite;animation:heartbeat .3s infinite}']}),Oe);function ke(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",6),p.Wb("click",(function(){p.ic(n);var e=p.Yb().$implicit;return p.Yb(2).game.performAction(e)})),p.oc(1),p.Nb()}if(2&e){var r=p.Yb().$implicit;p.zb(1),p.qc(" ",r.text," ")}}function we(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",6),p.Wb("click",(function(){p.ic(n);var e=t.$implicit;return p.Yb(4).game.performAction(e)})),p.oc(1),p.Nb()}if(2&e){var r=t.$implicit;p.zb(1),p.qc(" ",r.text," ")}}function xe(e,t){if(1&e&&(p.Ob(0,"div",7),p.Ob(1,"div",8),p.nc(2,we,2,1,"div",9),p.Nb(),p.Mb(3,"app-card-mini",10),p.Nb()),2&e){var n=p.Yb().$implicit,r=p.Yb(2);p.zb(2),p.bc("ngForOf",n.source.actions),p.zb(1),p.dc("id","board-deck-",n.source.hash,""),p.bc("board",r.board)("card",n.source.card)("hideTooltip",!0)}}function Me(e,t){if(1&e&&(p.Ob(0,"div"),p.nc(1,ke,2,1,"div",4),p.nc(2,xe,4,5,"div",5),p.Nb()),2&e){var n=t.$implicit;p.zb(1),p.bc("ngIf","card"!==n.type),p.zb(1),p.bc("ngIf","card"===n.type)}}function Se(e,t){if(1&e&&(p.Ob(0,"div",2),p.nc(1,Me,3,2,"div",3),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.bc("ngForOf",n.game.getActions(n.profile))}}var Te,Re=((Te=function(){function e(){_classCallCheck(this,e),this.deck=[],this.isFullScreen=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.deck=this.profile.cards.getDeck(),this.selectedCard=this.deck[0]}},{key:"selectCard",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=this.deck,r=0;r<n.length;r++)n[r].sm.setValue("isSelected",!1);e.sm.setValue("isSelected",!e.sm.values.isSelected),this.selectedCard=e;case 3:case"end":return t.stop()}}),t,this)})))}},{key:"castBg",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.profile.sm.setState("castBg",{card:this.selectedCard,energyPool:this.profile.energyPool,board:this.board});case 1:case"end":return e.stop()}}),e,this)})))}},{key:"toggle",value:function(){this.profile.sm.toggle("showBoardDeck")}},{key:"getDeck",value:function(){return this.profile.cardsCaboodle.getFiltered("isInDeck",!0)}}]),e}()).\u0275fac=function(e){return new(e||Te)},Te.\u0275cmp=p.Fb({type:Te,selectors:[["app-board-deck"]],inputs:{profile:"profile",board:"board",game:"game"},decls:2,vars:1,consts:[[1,"main"],["class","deck",4,"ngIf"],[1,"deck"],[4,"ngFor","ngForOf"],["class","action",3,"click",4,"ngIf"],["style","position:relative",4,"ngIf"],[1,"action",3,"click"],[2,"position","relative"],[1,"card-actions"],["class","action",3,"click",4,"ngFor","ngForOf"],[3,"board","card","id","hideTooltip"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.nc(1,Se,2,1,"div",1),p.Nb()),2&e&&(p.zb(1),p.bc("ngIf",t.game))},directives:[r.j,r.i,R],styles:[".main[_ngcontent-%COMP%]{width:100%;height:256px;display:flex;justify-content:center;align-items:flex-end;overflow-x:scroll;overflow-y:hidden;transition:.3s}.main.fullscreen[_ngcontent-%COMP%]{left:0;width:100vw}.card-big[_ngcontent-%COMP%]{width:-webkit-min-content;width:-moz-min-content;width:min-content;height:100%;display:flex;justify-content:center;align-items:center;flex-wrap:wrap}.toggle[_ngcontent-%COMP%]{width:100%;text-align:center;color:#fff;height:32px;line-height:32px}.deck[_ngcontent-%COMP%]{pointer-events:all;display:flex;height:100%;justify-content:center;align-items:center;opacity:.4;transition:.3s}.deck[_ngcontent-%COMP%]   app-card[_ngcontent-%COMP%]:hover{box-shadow:0 0 25px #fff}.deck[_ngcontent-%COMP%]:hover{opacity:1}app-card[_ngcontent-%COMP%]{height:-webkit-min-content;height:-moz-min-content;height:min-content;margin:10px}app-card.actionHover[_ngcontent-%COMP%]{box-shadow:0 0 25px #fff}.action-menu[_ngcontent-%COMP%]{width:100%;text-align:center;margin-top:25px}.action-menu[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{border:1px solid transparent}.action-menu[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:hover{border:1px solid #fff}.selected[_ngcontent-%COMP%]{box-shadow:0 0 10px grey}.action[_ngcontent-%COMP%]{height:96px;width:96px;justify-content:center;text-align:center;background-color:#232323;color:#fff;border:1px solid #fff;margin:0 10px}.action[_ngcontent-%COMP%], .card-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.card-actions[_ngcontent-%COMP%]{position:absolute;top:-100%;height:100%;width:80%;left:10%;z-index:9999999;flex-direction:column;justify-content:flex-end}.card-actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{height:24px;z-index:9999999;width:100%}@media only screen and (max-width:1550px){.deck[_ngcontent-%COMP%]{opacity:1;position:fixed;bottom:0;height:unset;z-index:999}}"]}),Te);function De(e,t){if(1&e){var n=p.Pb();p.Ob(0,"app-dice",4),p.Wb("click",(function(){p.ic(n);var e=t.$implicit;return p.Yb().selectDice(e)})),p.Nb()}if(2&e){var r=t.$implicit;p.bc("ngClass",r.sm.values.isSelected?"selected":"")("dice",r)}}var Ee,Ne,Ie=((Ee=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"selectDice",value:function(e){this.profile.dice.getSelected().length<3&&e.sm.setState("selectFn-"+e.hash,{})}},{key:"clearSelectedDice",value:function(){for(var e=this.profile.dice.items,t=0;t<e.length;t++)e[t].sm.setState("unselectFn-"+e[t].hash,{})}}]),e}()).\u0275fac=function(e){return new(e||Ee)},Ee.\u0275cmp=p.Fb({type:Ee,selectors:[["app-dice-pool"]],inputs:{profile:"profile"},decls:7,vars:1,consts:[[1,"dice-pool"],[1,"player-dice-pool"],[3,"ngClass","dice","click",4,"ngFor","ngForOf"],[1,"clear-button",3,"click"],[3,"ngClass","dice","click"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.Ob(1,"p"),p.oc(2,"Pick your dice!"),p.Nb(),p.Ob(3,"div",1),p.nc(4,De,1,2,"app-dice",2),p.Nb(),p.Ob(5,"div",3),p.Wb("click",(function(){return t.clearSelectedDice()})),p.oc(6," Clear selected dice "),p.Nb(),p.Nb()),2&e&&(p.zb(4),p.bc("ngForOf",t.profile.dice.getDeck(!0)))},directives:[r.i,_,r.h],styles:['.dice-info-container[_ngcontent-%COMP%]{width:100%;position:relative}.dice-info[_ngcontent-%COMP%]{position:absolute;width:100%;left:100%;padding:10px;background-color:#121212;color:#fff;flex-direction:column;border-radius:10px;border:1px solid #000}.dice-info[_ngcontent-%COMP%], .dice-info-lvl[_ngcontent-%COMP%]{display:flex}.dice-info-lvl-1[_ngcontent-%COMP%], .dice-lvl-1[_ngcontent-%COMP%]{background-color:#b32d91}.dice-info-lvl-2[_ngcontent-%COMP%], .dice-lvl-2[_ngcontent-%COMP%]{background-color:#2d4eb3}.dice-info-lvl-3[_ngcontent-%COMP%], .dice-lvl-3[_ngcontent-%COMP%]{background-color:#562e73}.dice-info-lvl-4[_ngcontent-%COMP%], .dice-info-lvl-5[_ngcontent-%COMP%], .dice-lvl-4[_ngcontent-%COMP%], .dice-lvl-5[_ngcontent-%COMP%]{background-color:#e57e3a}.dice-info-face[_ngcontent-%COMP%]{border:1px solid #fff}ion-dice-area[_ngcontent-%COMP%]{display:flex;justify-content:space-around;align-items:center;width:100%;flex-direction:column}.dice-pool[_ngcontent-%COMP%], ion-dice-pool[_ngcontent-%COMP%]{display:flex}.dice-pool[_ngcontent-%COMP%]{flex-direction:column;width:50vw}app-dice[_ngcontent-%COMP%]{margin:25px}.dice-lvl[_ngcontent-%COMP%]{width:50px;height:50px;border:3px solid #fff;border-radius:7px;margin:3px}.selected-dice[_ngcontent-%COMP%]{height:100px}.player-dice-pool[_ngcontent-%COMP%], .selected-dice[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%}.player-dice-pool[_ngcontent-%COMP%]{flex-wrap:wrap;background-color:#37474f;border:1px solid #78909c;border-bottom-color:#607d8b;margin:5px 0}.dice-model[_ngcontent-%COMP%]{width:30px;height:30px;border:1px solid #fff;border-radius:5px;margin:3px;position:relative}.dice-model[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{overflow:hidden;border-radius:5px}.dice-model[_ngcontent-%COMP%]:hover:before{content:"";position:absolute;top:-240px;left:calc(50% - 75px);background-image:var(--src);background-position:50%;background-size:cover;width:150px;height:225px;border-radius:5px;border:1px solid #78909c;opacity:.8}.dice-model[_ngcontent-%COMP%]:hover:after{content:"";position:absolute;width:0;height:0;border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid #78909c;top:-14px}.selected[_ngcontent-%COMP%]{background:radial-gradient(hsla(0,0%,100%,.4),transparent)}.clear-button[_ngcontent-%COMP%]{display:flex;width:100%;height:64px;border-radius:10px;border:1px solid #fff;background-color:#000;justify-content:center;align-items:center;font-size:1.2em;margin-top:30px;color:#fff}']}),Ee),je=n("oLy0"),ze=n.n(je),Fe=n("VF+C"),Ae=n("aNXi"),Be=n("W5wi"),Le=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;_classCallCheck(this,e),this.items=[],this.interval=t}return _createClass(e,[{key:"append",value:function(e){this.items.push(e)}},{key:"prepend",value:function(e){this.items.unshift(e)}},{key:"delete",value:function(e){e<0||e>this.items.length||this.items.splice(e,1)}},{key:"pop",value:function(){return this.items.pop()}},{key:"shift",value:function(){return this.items.shift()}},{key:"popAll",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.pop(),e.t0=t,!e.t0){e.next=8;break}return e.next=5,t();case 5:return e.next=7,s.j.sleep(this.interval);case 7:this.popAll();case 8:case"end":return e.stop()}}),e,this)})))}},{key:"shiftAll",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.shift(),e.t0=t,!e.t0){e.next=8;break}return e.next=5,t();case 5:return e.next=7,s.j.sleep(this.interval);case 7:this.popAll();case 8:case"end":return e.stop()}}),e,this)})))}}]),e}(),Ye=function(){function e(t,n,r,i,o,a){_classCallCheck(this,e),this.nonce=0,this.from=t,this.to=n,this.payload=r,"ack"===this.payload.type||o||(this.nonce=a,a+=1),a&&(this.nonce=a),this.id=o||m.a.uuid(),this.ts=i||Date.now()}return _createClass(e,[{key:"toString",value:function(){var e=JSON.stringify(this);return m.a.base64.encode(e)}}]),e}(),Ue=function(){function e(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,e),this.tmpAddress="",this.peerId="",this.lastStanzaNonce=-1,this.stanzaQueue=new Le,this.lastNonce=0,this.nonceQueue=[],this.stanzaNonce=0,this.peerInitialized=!1,this.events=n,this.board=t,this.sm=new Fe.a(this.events,{gameHash:""}),this.initializeStateMachine();var a=localStorage.getItem("auth-token"),c="";if(a){var s=new Ae.a,d=Ae.a.claimFromString(a);s.fromPrivateKey(localStorage.getItem("privateKey"),d.payload.email),this.wallet=s,c=s.address}0===c.length&&(c=Date.now().toString(16));var l=m.a.getHash(c+Date.now().toString(16));this.sm.setValue("gameHash",l),this.tmpAddress=l,this.peer=new ze.a(l+"_"+i+"_"+o,{host:Be.a.signalingServers[0].host,port:Be.a.signalingServers[0].port,path:Be.a.signalingServers[0].path,key:Be.a.signalingServers[0].key}),this.peer.on("error",(function(e){})),this.peer.on("connection",(function(e){0===r.peerId.length&&(r.connectToPeer(e.peer),r.peerId=e.peer),e.send("open"),e.on("data",(function(e){var t=JSON.parse(m.a.base64.decode(e)),n=new Ye(t.from,t.to,t.payload,t.ts,t.id,t.nonce);r.on(n)})),e.on("open",(function(){}))}))}return _createClass(e,[{key:"action",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o,a,c,s,l,p,u,f,b,h,g,v,y,C;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.nonce===this.lastStanzaNonce+1){t.next=2;break}throw alert("Received out of sync stanza `"+e.payload.method+"`"),new Error("Received out of sync stanza"+e+this.lastStanzaNonce);case 2:if(this.lastStanzaNonce+=1,console.log("received nonce:",e.nonce),"turnFn"===e.payload.action.type&&(this.board.players.red.energyPool.sm.disable("canMint"),this.board.players.red.sm.disable("canRoll"),this.board.players.red.sm.disable("canCast"),this.board.players.red.sm.disable("isActiveTurn"),this.board.sm.enable("isPlayerTurn"),n=new d.a("turnBg",{player:this.board.players.red,game:this}),this.board.game.performAction(n)),"rollDiceBg"!==e.payload.action.type){t.next=30;break}r=e.payload.dice,i=this.board.players.blue.diceCaboodle.getFiltered("isInDeck",!0),o=0;case 6:if(!(o<r.length)){t.next=21;break}a=0;case 8:if(!(a<i.length)){t.next=18;break}if(t.t0=i[a].sm.values.originalHash!==r[o]||i[a].sm.values.isSelected,t.t0){t.next=15;break}return i[a].sm.enable("isSelected"),r.splice(o,1),t.next=15,m.a.sleep(500);case 15:a++,t.next=8;break;case 18:o++,t.next=6;break;case 21:c=Object.keys(e.payload.finalEnergy),s=0;case 23:if(!(s<c.length)){t.next=30;break}return this.board.players.blue.energyPool.sm.values[c[s]]=e.payload.finalEnergy[c[s]],t.next=27,m.a.sleep(100);case 27:s++,t.next=23;break;case 30:"castBg"===e.payload.action.type&&(l=this.board.players.blue.cardsCaboodle.getFiltered("isInDeck",!0).filter((function(t){return t.sm.values.originalHash===e.payload.card}))[0],p=new d.a("castBg",{board:this.board,game:this.board.game,profile:this.board.players.blue,card:l},!1),this.board.game.performAction(p)),"castFn"===e.payload.action.type&&(u=e.payload.cellKey.split(":"),f=(h=[Math.abs(10-parseInt(u[0])),Math.abs(16-parseInt(u[1]))]).join(":"),this.board.sm.setState("castFn",{cardHash:e.payload.cardHash,cellKey:f,preventPropagation:!0})),"unfoldFn"===e.payload.action.type&&(b=e.payload.cellKey.split(":"),h=[Math.abs(10-parseInt(b[0])),Math.abs(16-parseInt(b[1]))],this.board.getCellByKey(h.join(":")).sm.setState("clicked",{board:this.board,profile:this.board.players.blue,preventPropagation:!0})),"moveBg"===e.payload.action.type&&this.board.sm.setState("moveBg",{cardHash:e.payload.cardHash,preventPropagation:!0}),"battleBg"===e.payload.action.type&&this.board.sm.setState("battleBg",{cardHash:e.payload.cardHash,preventPropagation:!0}),"moveFn"===e.payload.action.type&&(g=e.payload.cellKey.split(":"),h=[Math.abs(10-parseInt(g[0])),Math.abs(16-parseInt(g[1]))],this.board.getCellByKey(h.join(":")).sm.setState("clicked",{board:this.board,profile:this.board.players.blue,preventPropagation:!0})),"battleFn"===e.payload.action.type&&(v=e.payload.cellKey.split(":"),h=[Math.abs(10-parseInt(v[0])),Math.abs(16-parseInt(v[1]))],this.board.getCellByKey(h.join(":")).sm.setState("clicked",{board:this.board,profile:this.board.players.blue,preventPropagation:!0})),"moveStp"===e.payload.action.type&&(y=new d.a("moveStp",{board:this.board,player:this.board.players.blue,action:{source:{card:this.board.sm.values.currentCard}}},!1),this.board.game.performAction(y)),"battleStp"===e.payload.action.type&&(C=new d.a("battleStp",{board:this.board,player:this.board.players.blue,action:{source:{card:this.board.sm.values.currentCard,board:this.board}}},!1),this.board.game.performAction(C));case 37:case"end":return t.stop()}}),t,this)})))}},{key:"on",value:function(e){if("ack"===e.payload.method){console.log("ack received");var t=this.stanzaQueue.items.filter((function(t,n){return t._i=n,t.id===e.payload.id||t.nonce===e.nonce}))[0];t&&this.stanzaQueue.delete(t._i),0===this.stanzaQueue.items.length?console.log("STANZA QUEUE EMPTY, RESUME CLICKABILITY"):console.log("STANZA QUEUE PENDING",this.stanzaQueue.items),console.log("ack stanza",e.payload)}if("ack"!==e.payload.method&&this.sendStanza({method:"ack",id:e.id,nonce:e.nonce}),"action"===e.payload.method)return this.action(e);e.payload.handshake&&this.sm.setState("handshakeBg",{stanza:e}),"castFn"===e.payload.type&&this.sm.events.emit("castFn",{cell:e.payload.cell,card:e.payload.card})}},{key:"sendStanza",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.connection){t.next=2;break}return t.abrupt("return");case 2:if(!["castBg","moveBg","battleBg","unfoldBg"].includes(e.method)){t.next=4;break}return t.abrupt("return");case 4:n=new Ye(this.wallet.address,this.connection.id||this.peerId,e),"ack"!==e.method&&(console.log("appending stanza to queue",n),this.stanzaQueue.append(n),n.nonce=this.stanzaNonce,this.stanzaNonce+=1),console.log("STANZA QUEUED, FREEZE CLICKABILITY"),console.log("sending unqueued stanza",n),this.connection.send(n.toString());case 6:case"end":return t.stop()}}),t,this)})))}},{key:"connectToPeer",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){if(n.connection||n.peerInitialized)return t();n.peerInitialized=!0,n.connection=n.peer.connect(e),n.connection.on("open",(function(){var r=new Ye(n.wallet.address,e,{handshake:!0,address:n.board.players.red.sm.values.address,deck:n.board.players.red.sm.values.activeDeck});n.connection.send(r.toString()),t()}))})));case 1:case"end":return t.stop()}}),t)})))}},{key:"initializeStateMachine",value:function(){var e=this;this.sm.addState("startTurn",{}),this.sm.addState("challengeBg",{},(function(t,n){if(!e.connection||!e.peerInitialized){e.connectToPeer(n.address);var r=new Ye(e.wallet.address,n.address,{handshake:!0,deck:e.board.players.red.sm.values.activeDeck});e.connection.send(r.toString())}})),this.sm.addState("handshakeBg",{},(function(t,n){var r=e.board.players.blue;r.sm.values.isCPU&&(r.dice=e.board.players.red.dice,r.sm.disable("isCPU"),r.sm.disable("isP2P"),r.initializeStateMachine()),n.gameType="P2P";for(var i=[],o=0;o<n.stanza.payload.deck.dice.length;o++)i.push(r.dice.getFiltered("originalHash",n.stanza.payload.deck.dice[o].originalHash)[0]);for(var a=0;a<i.length;a++)i[a]&&i[a].sm.setState("gainOwnership-"+i[a].hash,{profile:r,token:"P2P_TOKEN",claim:{payload:{user:"0XTOKEN",rel_id:m.a.getRandomInt(1e5)}}});for(var c=r.diceCaboodle.getFiltered("isOwned",!0),s=0;s<c.length;s++)c[s].sm.enable("isInDeck");for(var d=[],l=0;l<n.stanza.payload.deck.cards.length;l++)d.push(r.cards.getFiltered("originalHash",n.stanza.payload.deck.cards[l].originalHash)[0]);for(var p=0;p<d.length;p++)d[p]&&d[p].sm.setState("gainOwnership-"+d[p].hash,{profile:r,token:"P2P_TOKEN",claim:{payload:{user:"0XTOKEN",rel_id:m.a.getRandomInt(1e5)}}});for(var u=r.cardsCaboodle.getFiltered("isOwned",!0),f=0;f<u.length;f++)u[f].sm.enable("isInDeck");t.events.emit("handshakeFn",{gameType:"P2P",blue:r})})),this.sm.addState("castFn",{},(function(t,n){var r=new Ye(e.wallet.address,e.connection.id,{type:"castFn",card:t.values.currentCard.originalHash,cell:n.cell.key});e.connection.send(r.toString())}))}}]),e}(),We=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,i,o,a){var s;return _classCallCheck(this,n),(s=t.call(this,e,!1,void 0,!1)).sm.disable("isP2P"),s.sm.enable("isCPU"),s.alias=r,s.avatar=i,s.events=e,s.spawnDeck(o),s.spawnDiceDeck(a),s.sm.addState("gameBg",{isPlaying:!0,canCast:!0,isCasting:!1},(function(e,t){s.game=t.game})),s.sm.addState("turnBg",{isPlaying:!0,canCast:!0,isCasting:!1,canRoll:!0},(function(e,t){return Object(c.a)(_assertThisInitialized(s),void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.diceActions();case 2:return e.next=4,m.a.sleep(1500);case 4:return t=new d.a("turnFn",{player:this,opponent:this.game.red,board:this.game.board,isPlayer:!0}),n=this.game,r=setTimeout((function(){n.performAction(t)}),1e4),e.next=7,this.cardActions();case 7:return e.next=9,m.a.sleep(300);case 9:this.game.performAction(t),clearTimeout(r);case 11:case"end":return e.stop()}}),e,this)})))})),s}return _createClass(n,[{key:"diceActions",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(3!==this.diceCaboodle.getFiltered("isSelected",!0).length)for(t=this.diceCaboodle.items,n=0;n<3;n++)t[n].sm.enable("isSelected"),t[n].sm.enable("canRoll");"rollDiceBg"===(r=this.game.getActions(this))[0].type&&this.game.performAction(r[0]);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"cardActions",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,c,s,l,p,u,f,b,h,g,v,y,C,_,O,P,k,w,x,M,S,T,R,D,E,N,I,j,z;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,t=this.cardsCaboodle.getFiltered("isOnBoard",!0),n=0;n<t.length;n++)t[n].sm.setValue("canMove",!1);if(this.sm.disable("canMove"),0!==(j=this.game.getActions(this).filter((function(e){return"card"===e.type}))).length){e.next=5;break}return e.abrupt("return");case 5:if(r=j[0].source.actions.filter((function(e){return"moveBg"!==e.type}))[0],this.game.performAction(r),"castBg"!==r.type){e.next=21;break}return e.next=9,m.a.sleep(300);case 9:for(i=this.game.board.sm.values.cells.filter((function(e){return e.sm.values.classes.includes("possible-cast-tile")})),o=this.game.board.players.red.cardsCaboodle.getFiltered("isOnBoard",!0),a=[],c=0;c<o.length;c++)o[c].sm.values.clans.includes("Hex")||o[c].sm.values.clans.includes("Illusion")||a.push(o[c]);if(0===a.length)i[m.a.getRandomInt(i.length-1)].sm.setState("clicked",{board:this.game.board,profile:this});else{for(s=[],l=0;l<i.length;l++)for(p=0;p<a.length;p++)u=i[l],f=this.game.board.getCellByKey(a[p].sm.values.cellKey),b=m.a.getCellDistance(u,f),s.push({cell:u,distance:b});s.sort((function(e,t){return e.distance<t.distance?-1:e.distance>t.distance?1:0})),s[0].cell.sm.setState("clicked",{board:this.game.board,profile:this})}h=0;case 13:if(!(h<5)){e.next=21;break}return e.next=16,m.a.sleep(300);case 16:if(g=this.game.board.sm.values.cells.filter((function(e){return e.sm.values.classes.includes("possible-unfold-tile")})),0===a.length)g[m.a.getRandomInt(g.length-1)].sm.setState("clicked",{board:this.game.board,profile:this});else{for(v=[],y=0;y<g.length;y++)for(C=0;C<a.length;C++)_=g[y],O=this.game.board.getCellByKey(a[C].sm.values.cellKey),P=m.a.getCellDistance(_,O),v.push({cell:_,distance:P});v.sort((function(e,t){return e.distance<t.distance?-1:e.distance>t.distance?1:0})),v[0].cell.sm.setState("clicked",{board:this.game.board,profile:this})}case 18:h++,e.next=13;break;case 21:return e.next=23,m.a.sleep(500);case 23:if("moveBg"!==r.type){e.next=26;break}k=new d.a("moveStp",{action:r,board:this.game.board,player:this.game.board.players.blue}),this.game.performAction(k);case 26:if("battleBg"!==r.type){e.next=36;break}for(w=this.game.board.players.red.cardsCaboodle.getFiltered("isOnBoard",!0),x=[],M=0;M<w.length;M++)w[M].sm.values.clans.includes("Hex")||w[M].sm.values.clans.includes("Illusion")||x.push(w[M]);for(this.game.performAction(r),S=this.game.board.sm.values.cells.filter((function(e){return e.sm.values.classes.includes("possible-battle-tile")})),T=[],R=0;R<S.length;R++)for(D=0;D<x.length;D++)E=S[R],N=this.game.board.getCellByKey(x[D].sm.values.cellKey),I=m.a.getCellDistance(E,N),T.push({cell:E,distance:I});return T.sort((function(e,t){return e.distance<t.distance?-1:e.distance>t.distance?1:0})),T[0].distance<=r.source.card.sm.values.rng&&T[0].cell.sm.setState("clicked",{board:this.game.board,profile:this}),e.next=36,m.a.sleep(1e3);case 36:if(this.sm.disable("isActionActive"),e.t0=(j=this.game.getActions(this).filter((function(e){return"card"===e.type}))).length>0,!e.t0){e.next=43;break}return e.next=41,m.a.sleep(500);case 41:return e.next=43,this.cardActions();case 43:e.next=49;break;case 45:e.prev=45,e.t1=e.catch(0),z=new d.a("turnFn",{player:this,opponent:this.game.red,isPlayer:!0,board:this.game.board}),this.game.performAction(z);case 49:case"end":return e.stop()}}),e,this,[[0,45]])})))}},{key:"spawnDeck",value:function(e){for(var t=0;t<e.length;t++){var n=this.cards.getFiltered("originalHash",e[t])[0];n.sm.setState("gainOwnership-"+n.originalHash,{profile:this,token:this.alias.toUpperCase()+"_TOKEN",claim:{payload:{user:"0x"+this.alias.toUpperCase(),rel_id:m.a.getRandomInt(1e5)}}})}for(var r=this.cardsCaboodle.getFiltered("isOwned",!0),i=0;i<r.length;i++)r[i].sm.enable("isInDeck")}},{key:"spawnDiceDeck",value:function(e){for(var t=0;t<e.length;t++){var n=this.dice.getFiltered("originalHash",e[t])[0];n.sm.setState("gainOwnership-"+n.hash,{profile:this,token:"CHRISTA_TOKEN",claim:{payload:{user:"0XCHRISTA",rel_id:m.a.getRandomInt(1e5)}}})}for(var r=this.diceCaboodle.getFiltered("isOwned",!0),i=0;i<r.length;i++)r[i].sm.enable("isInDeck")}}]),n}(n("BEat").a),Ge=((Ne=function(){function e(){_classCallCheck(this,e),this.util=s.j}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ne)},Ne.\u0275cmp=p.Fb({type:Ne,selectors:[["app-dice-full"]],inputs:{dice:"dice"},decls:13,vars:24,consts:[[1,"dice-row"],[1,"dice-face"],[1,"dice-face-icon",3,"src"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.Ob(1,"div",1),p.Mb(2,"ion-img",2),p.Nb(),p.Ob(3,"div",1),p.Mb(4,"ion-img",2),p.Nb(),p.Ob(5,"div",1),p.Mb(6,"ion-img",2),p.Nb(),p.Ob(7,"div",1),p.Mb(8,"ion-img",2),p.Nb(),p.Ob(9,"div",1),p.Mb(10,"ion-img",2),p.Nb(),p.Ob(11,"div",1),p.Mb(12,"ion-img",2),p.Nb(),p.Nb()),2&e&&(p.zb(1),p.lc("background-color:",t.util.getAttributeColor(t.dice.faces[0]),""),p.zb(1),p.cc("src",t.util.getDiceFace(t.dice.faces[0])),p.zb(1),p.lc("background-color:",t.util.getAttributeColor(t.dice.faces[1]),"\n    "),p.zb(1),p.cc("src",t.util.getDiceFace(t.dice.faces[1])),p.zb(1),p.lc("background-color:",t.util.getAttributeColor(t.dice.faces[2]),"\n    "),p.zb(1),p.cc("src",t.util.getDiceFace(t.dice.faces[2])),p.zb(1),p.lc("background-color:",t.util.getAttributeColor(t.dice.faces[3]),""),p.zb(1),p.cc("src",t.util.getDiceFace(t.dice.faces[3])),p.zb(1),p.lc("background-color:",t.util.getAttributeColor(t.dice.faces[4]),""),p.zb(1),p.cc("src",t.util.getDiceFace(t.dice.faces[4])),p.zb(1),p.lc("background-color:",t.util.getAttributeColor(t.dice.faces[5]),""),p.zb(1),p.cc("src",t.util.getDiceFace(t.dice.faces[5])))},styles:[".dice-row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;border:3px solid #dedede;margin:5px 0}.dice-face[_ngcontent-%COMP%]{width:64px;height:64px;background-size:cover;background-position:50%;border:1px solid #fff}"]}),Ne);function Ve(e,t){if(1&e&&p.Mb(0,"app-card-mini",32),2&e){var n=t.$implicit,r=p.Yb(3);p.bc("card",n)("board",r.board)}}function He(e,t){if(1&e&&(p.Ob(0,"div",29),p.nc(1,Ve,1,2,"app-card-mini",30),p.Mb(2,"app-dice",31),p.Nb()),2&e){var n=p.Yb(2);p.zb(1),p.bc("ngForOf",n.newCards),p.zb(1),p.bc("dice",n.newDice[0])}}function qe(e,t){if(1&e&&(p.Ob(0,"div"),p.Mb(1,"ion-img",33),p.Nb()),2&e){var n=p.Yb(2);p.zb(1),p.cc("src",n.board.players.red.sm.values.avatar)}}function $e(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",7),p.Ob(1,"div",8),p.Ob(2,"div",9),p.Mb(3,"ion-img",10),p.Nb(),p.Ob(4,"p",11),p.oc(5),p.Nb(),p.Ob(6,"ion-button",12),p.Wb("click",(function(){return p.ic(n),p.Yb().showInventory()})),p.oc(7," Show Inventory "),p.Nb(),p.Ob(8,"ion-button",12),p.Wb("click",(function(){return p.ic(n),p.Yb().togglePlayModal()})),p.oc(9," Play (Local) "),p.Nb(),p.Ob(10,"ion-button",12),p.Wb("click",(function(){return p.ic(n),p.Yb().toggleOnlineModal()})),p.oc(11," Play (Online) "),p.Nb(),p.Ob(12,"ion-button",12),p.Wb("click",(function(){return p.ic(n),p.Yb().toggleLeaderboard()})),p.oc(13," Leaderboard "),p.Nb(),p.Nb(),p.Ob(14,"div",13),p.Ob(15,"ion-button",14),p.Wb("click",(function(){return p.ic(n),p.Yb().getBoosterPack()})),p.oc(16," PURCHASE BOOSTER PACK (300 COINS) "),p.Nb(),p.nc(17,He,3,2,"div",15),p.Nb(),p.Ob(18,"div",16),p.nc(19,qe,2,1,"div",17),p.Ob(20,"div"),p.Mb(21,"ion-input",18),p.Ob(22,"ion-button",12),p.Wb("click",(function(){return p.ic(n),p.Yb().updateAlias()})),p.oc(23," Update Alias "),p.Nb(),p.Nb(),p.Ob(24,"p",19),p.oc(25),p.Nb(),p.Ob(26,"p",20),p.oc(27),p.Nb(),p.Ob(28,"p",21),p.oc(29),p.Nb(),p.Nb(),p.Ob(30,"div",22),p.Ob(31,"ion-button",23),p.Wb("click",(function(){return p.ic(n),p.Yb().toggleHelp()})),p.oc(32," Help "),p.Nb(),p.Ob(33,"ion-button",12),p.Wb("click",(function(){return p.ic(n),p.Yb().fullscreen()})),p.oc(34," FULLSCREEN "),p.Nb(),p.Ob(35,"select",24),p.Wb("change",(function(){return p.ic(n),p.Yb().alterLanguage()})),p.Ob(36,"option",25),p.oc(37,"English"),p.Nb(),p.Ob(38,"option",26),p.oc(39,"Spanish"),p.Nb(),p.Ob(40,"option",27),p.oc(41,"Catalan"),p.Nb(),p.Nb(),p.Ob(42,"ion-button",28),p.Wb("click",(function(){return p.ic(n),p.Yb().logout()})),p.oc(43," LOG OUT "),p.Nb(),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.zb(5),p.qc("Version ",r.config.version,""),p.zb(12),p.bc("ngIf",r.newCards.length>0&&r.newDice.length>0),p.zb(2),p.bc("ngIf",r.board.players.red.sm.values.avatar),p.zb(2),p.cc("value",r.board.players.red.sm.values.alias),p.zb(4),p.qc("LVL: ",r.board.players.red.sm.values.lvl,""),p.zb(2),p.rc("Exp: ",r.board.players.red.sm.values.exp," / ",r.util.getExpToNextLevel(r.board.players.red.sm.values.lvl)," "),p.zb(2),p.qc("",r.board.players.red.sm.values.balance," coins")}}function Ke(e,t){1&e&&p.Mb(0,"app-dice-full",46),2&e&&p.bc("dice",t.$implicit)}function Je(e,t){if(1&e&&p.Mb(0,"app-card-mini",32),2&e){var n=t.$implicit,r=p.Yb(3);p.bc("card",n)("board",r.board)}}function Xe(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",37),p.Ob(1,"div",38),p.Ob(2,"div",39),p.Mb(3,"ion-img",40),p.Nb(),p.Ob(4,"div",41),p.Ob(5,"div",42),p.oc(6),p.Nb(),p.Ob(7,"ion-button",12),p.Wb("click",(function(){p.ic(n);var e=t.$implicit;return p.Yb(2).playWith(e.alias)})),p.oc(8," PLAY "),p.Nb(),p.Nb(),p.Nb(),p.Ob(9,"div",43),p.nc(10,Ke,1,1,"app-dice-full",44),p.Nb(),p.Ob(11,"div",45),p.nc(12,Je,1,2,"app-card-mini",30),p.Nb(),p.Nb()}if(2&e){var r=t.$implicit;p.zb(3),p.cc("src",r.avatar),p.zb(3),p.pc(r.alias),p.zb(4),p.bc("ngForOf",r.diceCaboodle.getFiltered("isInDeck",!0)),p.zb(2),p.bc("ngForOf",r.cardsCaboodle.getFiltered("isInDeck",!0))}}function Qe(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",34),p.nc(1,Xe,13,4,"div",35),p.Ob(2,"ion-img",36),p.Wb("click",(function(){return p.ic(n),p.Yb().togglePlayModal()})),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.zb(1),p.bc("ngForOf",r.getValues(r.opponents))}}function Ze(e,t){if(1&e&&(p.Ob(0,"div",62),p.Mb(1,"ion-img",63),p.Nb()),2&e){var n=p.Yb().$implicit;p.zb(1),p.cc("src",n.data.url)}}function et(e,t){if(1&e&&(p.Ob(0,"div",64),p.Ob(1,"p"),p.oc(2),p.Nb(),p.Ob(3,"p"),p.oc(4),p.Nb(),p.Nb()),2&e){var n=p.Yb().$implicit;p.zb(2),p.qc("Cards:",n.data.cards.length,""),p.zb(2),p.qc("Dice:",n.data.dice.length,"")}}function tt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"ion-button",14),p.Wb("click",(function(){p.ic(n);var e=p.Yb().$implicit;return p.Yb(2).editDeck(e)})),p.oc(1," Edit "),p.Nb()}}function nt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"ion-button",28),p.Wb("click",(function(){p.ic(n);var e=p.Yb().$implicit;return p.Yb(2).deactivateItem(e)})),p.oc(1," Deactivate "),p.Nb()}}function rt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"ion-button",12),p.Wb("click",(function(){p.ic(n);var e=p.Yb().$implicit;return p.Yb(2).activateItem(e)})),p.oc(1," Activate "),p.Nb()}}function it(e,t){if(1&e&&(p.Ob(0,"div",53),p.Ob(1,"div",54),p.oc(2),p.Nb(),p.nc(3,Ze,2,1,"div",55),p.nc(4,et,5,2,"div",56),p.Ob(5,"div",57),p.oc(6),p.Nb(),p.Ob(7,"div",58),p.nc(8,tt,2,0,"ion-button",59),p.nc(9,nt,2,0,"ion-button",60),p.nc(10,rt,2,0,"ion-button",61),p.Nb(),p.Nb()),2&e){var n=t.$implicit;p.zb(2),p.qc(" ",n.title," "),p.zb(1),p.bc("ngIf","avatar"===n.type),p.zb(1),p.bc("ngIf","deck"===n.type&&n.data.cards&&n.data.dice),p.zb(2),p.qc(" \xb7 ",n.type.toUpperCase()," \xb7 "),p.zb(2),p.bc("ngIf","deck"===n.type),p.zb(1),p.bc("ngIf",1===n.active),p.zb(1),p.bc("ngIf",0===n.active)}}function ot(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",47),p.Ob(1,"div",48),p.nc(2,it,11,7,"div",49),p.Nb(),p.Ob(3,"div",50),p.Ob(4,"div",51),p.Mb(5,"ion-input",52),p.Ob(6,"ion-button",12),p.Wb("click",(function(){return p.ic(n),p.Yb().createEmptyDeck()})),p.oc(7," Add Deck "),p.Nb(),p.Nb(),p.Nb(),p.Ob(8,"ion-img",36),p.Wb("click",(function(){return p.ic(n),p.Yb().closeInventoryModal()})),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.zb(2),p.bc("ngForOf",r.board.players.red.sm.values.inventory)}}function at(e,t){1&e&&(p.Ob(0,"div",71),p.Ob(1,"div",72),p.Mb(2,"ion-img",73),p.Nb(),p.Nb())}function ct(e,t){1&e&&(p.Ob(0,"div",71),p.Ob(1,"div",72),p.Mb(2,"ion-img",74),p.Nb(),p.Nb())}function st(e,t){1&e&&(p.Ob(0,"div",71),p.Ob(1,"div",72),p.Mb(2,"ion-img",75),p.Nb(),p.Nb())}function dt(e,t){if(1&e&&(p.Ob(0,"div",71),p.oc(1),p.Nb()),2&e){var n=p.Yb().index;p.zb(1),p.qc(" ",n+1," ")}}function lt(e,t){if(1&e&&(p.Ob(0,"div",69),p.nc(1,at,3,0,"div",70),p.nc(2,ct,3,0,"div",70),p.nc(3,st,3,0,"div",70),p.nc(4,dt,2,1,"div",70),p.Ob(5,"div",53),p.oc(6),p.Nb(),p.Ob(7,"div",53),p.oc(8),p.Nb(),p.Ob(9,"div",53),p.oc(10),p.Nb(),p.Nb()),2&e){var n=t.$implicit,r=t.index;p.zb(1),p.bc("ngIf",0===r),p.zb(1),p.bc("ngIf",1===r),p.zb(1),p.bc("ngIf",2===r),p.zb(1),p.bc("ngIf",r>2),p.zb(2),p.pc(n.alias),p.zb(2),p.pc(n.level),p.zb(2),p.pc(n.create_timestamp_utc.split("T")[0])}}function pt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",65),p.Ob(1,"div",66),p.Ob(2,"div",67),p.Ob(3,"div",53),p.oc(4,"#"),p.Nb(),p.Ob(5,"div",53),p.oc(6,"Alias"),p.Nb(),p.Ob(7,"div",53),p.oc(8,"LVL"),p.Nb(),p.Ob(9,"div",53),p.oc(10,"Joined"),p.Nb(),p.Nb(),p.nc(11,lt,11,7,"div",68),p.Nb(),p.Ob(12,"ion-img",36),p.Wb("click",(function(){return p.ic(n),p.Yb().toggleLeaderboard()})),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.zb(11),p.bc("ngForOf",r.leaderboard)}}function ut(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",82),p.Wb("dblclick",(function(){p.ic(n);var e=t.$implicit;return p.Yb(3).challengePlayer(e)})),p.Ob(1,"div",53),p.oc(2),p.Nb(),p.Ob(3,"div",53),p.oc(4),p.Nb(),p.Ob(5,"div",53),p.oc(6),p.Nb(),p.Nb()}if(2&e){var r=t.$implicit;p.zb(2),p.pc(r.alias),p.zb(2),p.pc(r.level),p.zb(2),p.pc(r.status.toUpperCase())}}function ft(e,t){if(1&e&&(p.Ob(0,"div",78),p.Ob(1,"div",79),p.Ob(2,"div",80),p.oc(3,"ALIAS"),p.Nb(),p.Ob(4,"div",80),p.oc(5,"LEVEL"),p.Nb(),p.Ob(6,"div",80),p.oc(7,"STATUS"),p.Nb(),p.Nb(),p.nc(8,ut,7,3,"div",81),p.Nb()),2&e){var n=p.Yb(2);p.zb(8),p.bc("ngForOf",n.userPool)}}function bt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",76),p.nc(1,ft,9,1,"div",77),p.Ob(2,"ion-img",36),p.Wb("click",(function(){return p.ic(n),p.Yb().toggleOnlineModal()})),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.zb(1),p.bc("ngIf",r.userPool.length>0)}}function ht(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",83),p.Ob(1,"div",84),p.Wb("click",(function(){return p.ic(n),p.Yb().pickDeck("todd")})),p.Ob(2,"div",85),p.Mb(3,"ion-img",86),p.Nb(),p.Ob(4,"div",87),p.oc(5,"[SD] Todd's Deck"),p.Nb(),p.Ob(6,"div",88),p.Ob(7,"div",89),p.Mb(8,"ion-img",63),p.oc(9," water "),p.Nb(),p.Ob(10,"div",89),p.Mb(11,"ion-img",63),p.oc(12," wind "),p.Nb(),p.Ob(13,"div",89),p.Mb(14,"ion-img",63),p.oc(15," light "),p.Nb(),p.Nb(),p.Nb(),p.Ob(16,"div",84),p.Wb("click",(function(){return p.ic(n),p.Yb().pickDeck("marla")})),p.Ob(17,"div",85),p.Mb(18,"ion-img",90),p.Nb(),p.Ob(19,"div",87),p.oc(20,"[SD] Marla's Deck"),p.Nb(),p.Ob(21,"div",88),p.Ob(22,"div",89),p.Mb(23,"ion-img",63),p.oc(24," forest "),p.Nb(),p.Ob(25,"div",89),p.Mb(26,"ion-img",63),p.oc(27," metal "),p.Nb(),p.Ob(28,"div",89),p.Mb(29,"ion-img",63),p.oc(30," dark "),p.Nb(),p.Nb(),p.Nb(),p.Ob(31,"div",84),p.Wb("click",(function(){return p.ic(n),p.Yb().pickDeck("travis")})),p.Ob(32,"div",85),p.Mb(33,"ion-img",91),p.Nb(),p.Ob(34,"div",87),p.oc(35,"[SD] Travis's Deck"),p.Nb(),p.Ob(36,"div",88),p.Ob(37,"div",89),p.Mb(38,"ion-img",63),p.oc(39," fire "),p.Nb(),p.Ob(40,"div",89),p.Mb(41,"ion-img",63),p.oc(42," thunder "),p.Nb(),p.Ob(43,"div",89),p.Mb(44,"ion-img",63),p.oc(45," aether "),p.Nb(),p.Nb(),p.Nb(),p.Ob(46,"div",92),p.oc(47," Select a deck to start playing with "),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.zb(8),p.cc("src",r.util.getDiceFace("water")),p.zb(3),p.cc("src",r.util.getDiceFace("wind")),p.zb(3),p.cc("src",r.util.getDiceFace("light")),p.zb(9),p.cc("src",r.util.getDiceFace("forest")),p.zb(3),p.cc("src",r.util.getDiceFace("metal")),p.zb(3),p.cc("src",r.util.getDiceFace("dark")),p.zb(9),p.cc("src",r.util.getDiceFace("fire")),p.zb(3),p.cc("src",r.util.getDiceFace("thunder")),p.zb(3),p.cc("src",r.util.getDiceFace("aether"))}}function gt(e,t){if(1&e&&(p.Ob(0,"div",97),p.oc(1),p.Nb()),2&e){var n=t.$implicit;p.zb(1),p.qc(" ",n.title," ")}}function mt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",93),p.Ob(1,"div",94),p.nc(2,gt,2,1,"div",95),p.Nb(),p.Mb(3,"div",96),p.Ob(4,"ion-img",36),p.Wb("click",(function(){return p.ic(n),p.Yb().togglePathsModal()})),p.Nb(),p.Nb()}if(2&e){var r=p.Yb();p.zb(2),p.bc("ngForOf",r.board.players.red.sm.values.paths)}}var vt,yt=((vt=function(){function e(){_classCallCheck(this,e),this.util=s.j,this.config=s.i,this.newCards=[],this.newDice=[],this.players=[],this.alias="",this.balance=-1,this.experience=-1,this.level=-1,this.opponents={},this.leaderboard=[],this.userPool=[],this.isDeckPicked=!1}return _createClass(e,[{key:"ngOnInit",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("auth-token")){e.next=3;break}return e.abrupt("return",[]);case 3:return n=new s.h,r=s.h.claimFromString(t),n.fromPrivateKey(localStorage.getItem("privateKey"),r.payload.email),this.wallet=n,e.next=8,this.board.players.red.getBalance();case 8:return this.balance=e.sent,e.next=11,this.board.players.red.getExperience();case 11:this.experience=e.sent,this.level=s.j.getLevelFromExp(this.experience),this.opponents.Clyde=new We(this.board.events,"Clyde","assets/avatars/con34.png",["b035d051fd254742a8cbde2fd2bcd9b78fce6eec6a2d1ddb763690ff3d6607bc","09fdd7630b9ff03fe7f08945664ab3b156c7c2b97235aee3c96667c0e00afc15","a63d0ff52abb2bd6c111c284eda1ad8acc72185c3517b6d23ce865691c982b08","89e5b132cf23d885614755849525f6c34be4b49101aff33571f85c362264f1e0","fb65394b9087e30a7abdf0edaa93e2df78a25494a81213d3598553abdc4e0ea5","44f7e69a4848032601ff2acc6f6692798ca6c6ca75c3190fd7a6a008570857a1","614990f76a0909f8412e1114a5ab853747e786fbf3eaad377b625f200d8db073"],["70771907da67b202e5fb265d0e4184084e10d500af4d58cfd389b2678845c6f9","70771907da67b202e5fb265d0e4184084e10d500af4d58cfd389b2678845c6f9","70771907da67b202e5fb265d0e4184084e10d500af4d58cfd389b2678845c6f9","70771907da67b202e5fb265d0e4184084e10d500af4d58cfd389b2678845c6f9","70771907da67b202e5fb265d0e4184084e10d500af4d58cfd389b2678845c6f9"]),this.opponents["Deity Christa"]=new We(this.board.events,"Deity Christa","assets/avatars/con5.png",["0d18f6208ace9939ad1b6c308f8e68bebec9355b9ef2dd03f6f06ff2f3e2607a","76a184c6d9d4293d0c353ee6fe5d4f06d3175f2a4dae36031e235eabe2a4cff5","f9436538561491bc13beb7b844bcee9951b0069db99c00b3459cd639b59ab9a0","1dc9c93e70884e899a65990422462e09d1db08776940a6a48cda4d6a23acbb93","76d065b47b5313cc61d25cd174bf4e475acb45e4a45b21c4e626409b2d2de6c2","56eda163911da67bfbdafbd389e88e17426ff42b36e6fbc775ac4cfe1499edd6","f9436538561491bc13beb7b844bcee9951b0069db99c00b3459cd639b59ab9a0"],["c8f00de74a205ebbfb0fa10ec495670a3c3687f399ee9cdcd0c540a77241036e","d4287ca85b264c3e59bd5f8a381ce1c3614a011915acd7730b0c62ddddd3278a","51589fb62a1d8ccec805563c3def9256b25a7595f72c3a5ada7b518f54af5534","c8f00de74a205ebbfb0fa10ec495670a3c3687f399ee9cdcd0c540a77241036e","c8f00de74a205ebbfb0fa10ec495670a3c3687f399ee9cdcd0c540a77241036e"]),this.opponents.Ruby=new We(this.board.events,"Ruby","assets/avatars/con29.png",["b8b0e174b76cf94f10760b23daa80b07b703e3f4e650e4ea6714425dff724876","17057ec3fcf444574a20946534d5786386ca5e940d7762197bfb30a68946230c","b8b0e174b76cf94f10760b23daa80b07b703e3f4e650e4ea6714425dff724876","b8b0e174b76cf94f10760b23daa80b07b703e3f4e650e4ea6714425dff724876","17057ec3fcf444574a20946534d5786386ca5e940d7762197bfb30a68946230c","250da14744527ff1be53642dd9b2447a7f534699ecaecf15de021eb56a088f4a","250da14744527ff1be53642dd9b2447a7f534699ecaecf15de021eb56a088f4a"],["53f33bd233993aacb403f48666bdaf1d46f413accc261de562d4a631c5d8b4db","53f33bd233993aacb403f48666bdaf1d46f413accc261de562d4a631c5d8b4db","53f33bd233993aacb403f48666bdaf1d46f413accc261de562d4a631c5d8b4db","53f33bd233993aacb403f48666bdaf1d46f413accc261de562d4a631c5d8b4db","53f33bd233993aacb403f48666bdaf1d46f413accc261de562d4a631c5d8b4db"]),this.opponents["Stingy Jack"]=new We(this.board.events,"Stingy Jack","assets/avatars/con22.png",["de26c4bf2e4434432c46f6c5aa7bafd9897644b7a62688990a3648e4c1cab50e","56eda163911da67bfbdafbd389e88e17426ff42b36e6fbc775ac4cfe1499edd6","e5d62ac6ccbb55929fddb19cf8e8147ee09cbdb32a5715057af17a189a7804cb","9153f4432a7e5be6cc7873fecbbec3f45c9014ad0bee67234cadd6e3398f2b7b","b153509af326a4f66dcf09c1f0eb5ac080187499134539f1260a8016464664ce","1e93d68c4826c519838f1f9bc96a17a5aa41656408b564ca1c30a2df530a7de4","cf9d8fe30e974d7cfec1acc48c3375fbc6b01d1f85befb3063e329f4d0f10983"],["072c4b818c1f1e47046d243a3e34fbeda5665e662221f16e4ff65c0762849ee3","072c4b818c1f1e47046d243a3e34fbeda5665e662221f16e4ff65c0762849ee3","072c4b818c1f1e47046d243a3e34fbeda5665e662221f16e4ff65c0762849ee3","072c4b818c1f1e47046d243a3e34fbeda5665e662221f16e4ff65c0762849ee3","072c4b818c1f1e47046d243a3e34fbeda5665e662221f16e4ff65c0762849ee3"]),this.opponents["Rookie Todd"]=new We(this.board.events,"Rookie Todd","assets/avatars/con37.png",["1df2083139e52af76218fec9852dc3e93396ace3bcb1a49ad19c365c7f472df3","cd6ac8832503e5af0f0b5f9f808d8aba16e99d0653f5a080901876ad84d4a4d0","89e5b132cf23d885614755849525f6c34be4b49101aff33571f85c362264f1e0","6c7adfac5b33c549492263424ffa03eeac48d52d0380677ad91dc1c6a27707ef","fb65394b9087e30a7abdf0edaa93e2df78a25494a81213d3598553abdc4e0ea5","44f7e69a4848032601ff2acc6f6692798ca6c6ca75c3190fd7a6a008570857a1","2a0b85c5b1551e9745efe1b01191cccfcc5f57bd4726e809e9a95891af326fdd","b76a014f6907f69bd2ed6ef036ae0ac1d317524c6943533b55cd82bfd5951a6c","6879e090838f2544314c17598555637ac8ac2d1fd34e3a538b276a227874bf83","8a9b770f286822fe307889dfd64c0e0d23980317ac34dc469786a0f449011917"],["d1ef825fbe0fd75661bbb27f0849510444d5ecee984fec8e7459246e7da7545c","d1ef825fbe0fd75661bbb27f0849510444d5ecee984fec8e7459246e7da7545c","a2a0ad6f1c5114ddcbff0c6009109c7fe75bec1da4e4fda60cc476756564fb70","a2a0ad6f1c5114ddcbff0c6009109c7fe75bec1da4e4fda60cc476756564fb70","d1ef825fbe0fd75661bbb27f0849510444d5ecee984fec8e7459246e7da7545c"]),this.opponents["Rookie Marla"]=new We(this.board.events,"Rookie Marla","assets/avatars/con12.png",["a2936861bcbb1cecba2e79193ac8d3b4cb8b19c1b48d8e59f6d4dc385561c4d8","b8b0e174b76cf94f10760b23daa80b07b703e3f4e650e4ea6714425dff724876","57c997f421e58c3cce4e3dfd15f2658906c74c80493652aa8c6ebe7d609237df","09fdd7630b9ff03fe7f08945664ab3b156c7c2b97235aee3c96667c0e00afc15","a63d0ff52abb2bd6c111c284eda1ad8acc72185c3517b6d23ce865691c982b08","f9436538561491bc13beb7b844bcee9951b0069db99c00b3459cd639b59ab9a0","853785361951f48b956138dcdc6332cffcc3b920f270017f8253db8bfbb82b88","56eda163911da67bfbdafbd389e88e17426ff42b36e6fbc775ac4cfe1499edd6","e420f637b0da5af8c60d9eddce4f97aec2083418f27925b912d3b5ba3670d57f","b0b537493734277f4c841d9464d22c51fc78998dba73c7600722659f0e5a0382"],["0cd90ec304d4c17c20d3e5744f559b742536acc075c47cc87f763bd92e5ecdca","0cd90ec304d4c17c20d3e5744f559b742536acc075c47cc87f763bd92e5ecdca","bdabd4e4dd212c09d5cd11b1dff8f457c69f0ede88cc86f3b813241af9cbae6b","0cd90ec304d4c17c20d3e5744f559b742536acc075c47cc87f763bd92e5ecdca","bdabd4e4dd212c09d5cd11b1dff8f457c69f0ede88cc86f3b813241af9cbae6b"]),this.opponents["Rookie Travis"]=new We(this.board.events,"Rookie Travis","assets/avatars/con10.png",["57d3c734f1bb39d2bf8dfe021ba648d26e4a7325bdd7bde0fc3b47e304e8b0ab","617da94edbe8b9eefb57553284c161da2c743743d62572a3ddd7319e28448a76","1dc9c93e70884e899a65990422462e09d1db08776940a6a48cda4d6a23acbb93","2968522cb9b6c5f42347083a427d142f80232381161eecaab68d61636156ede6","d39cc4be23f5cb26d0fe8a3ab67f492a3d76e90da69ea78a862605c77ddd4bfd","eb4c2234dd04c1966486264a72ab79bcd9c632d40732f543a9d138429799f938","78924cee13a675c1bb94a88497a60b73c116e1ee98c71be4e566cd0d216f02d1","e5d62ac6ccbb55929fddb19cf8e8147ee09cbdb32a5715057af17a189a7804cb","4628d670374b1fa761e0cc8752931e05c6a06ccf90a2faf7adf9e36a879b5cdd","4bb2c2c9f4065f57e0dbb7df7a516520848c91028249dc5f630923defbd235ee"],["31413b2a5950c0b3e021bb21220cce8a485c8302e86950d515c6fb535a6aa427","31413b2a5950c0b3e021bb21220cce8a485c8302e86950d515c6fb535a6aa427","8d22a7361794945791cf60490ee3987f7525f16daa3aeeb401cbebcf31c6845d","8d22a7361794945791cf60490ee3987f7525f16daa3aeeb401cbebcf31c6845d","31413b2a5950c0b3e021bb21220cce8a485c8302e86950d515c6fb535a6aa427"]),(i=localStorage.getItem("language"))&&(document.querySelector("#languages").value=i);case 22:case"end":return e.stop()}}),e,this)})))}},{key:"getUsersPool",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"proposeMatch",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.querySelector("#partner-address").value.trim();case 1:case"end":return e.stop()}}),e)})))}},{key:"deckEditor",value:function(){this.board.players.red.sm.enable("isModalVisible"),this.board.players.red.sm.disable("deckReady")}},{key:"logout",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.clear(),window.location.reload();case 1:case"end":return e.stop()}}),e)})))}},{key:"mintCoin",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.board.players.red.sm.values.isBusy||this.board.players.red.sm.setState("mintCoinBg",{httpMessenger:this.httpMessenger});case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getBoosterPack",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.board.players.red.getBalance();case 2:this.board.players.red.events.on("purchaseFn",(function(e){t.newCards=e.cards,t.newDice=e.dice})),this.board.players.red.events.emit("purchaseBg",{profile:this.board.players.red,httpMessenger:this.httpMessenger});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"winGame",value:function(){this.board.sm.events.emit("gameFn",{isPlayer:!0,player:this.board.players.red,httpMessenger:this.httpMessenger})}},{key:"postDeck",value:function(){this.board.players.red.postDeck(this.httpMessenger,this.board.players.red.sm.values.activeDeck.title,{cards:this.board.players.red.sm.values.activeDeck.cards,dice:this.board.players.red.sm.values.activeDeck.dice},1)}},{key:"fullscreen",value:function(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}},{key:"toggleHelp",value:function(){this.board.sm.toggle("showHelp")}},{key:"playWith",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=this.opponents[e]).sm.disable("isP2P"),n.sm.enable("isCPU"),this.board.events.emit("handshakeFn",{gameType:"CPU",opponent:n});case 2:case"end":return t.stop()}}),t,this)})))}},{key:"togglePlayModal",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.board.sm.toggle("showOpponentsModal");case 1:case"end":return e.stop()}}),e,this)})))}},{key:"alterLanguage",value:function(){var e=document.querySelector("#languages");localStorage.setItem("language",e.value),window.location.reload()}},{key:"showInventory",value:function(){this.board.sm.enable("displayInventory")}},{key:"closeInventoryModal",value:function(){this.board.sm.disable("displayInventory")}},{key:"createEmptyDeck",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=document.querySelector("#deck-name").value,e.next=4,this.board.players.red.postDeck(this.httpMessenger,t);case 4:return e.next=6,this.board.players.red.getInventory();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})))}},{key:"editDeck",value:function(e){console.log("editDeck",e),this.board.players.red.sm.values.activeDeck.title=e.title,this.board.players.red.sm.values.activeDeck.cards=e.data.cards,this.board.players.red.sm.values.activeDeck.dice=e.data.dice,this.board.players.red.sm.enable("isModalVisible"),this.board.players.red.sm.disable("deckReady")}},{key:"activateItem",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("activating",e),t.t0="avatar"===e.type,!t.t0){t.next=5;break}return t.next=5,this.board.players.red.addAvatar(this.httpMessenger,e.data.url,e.data.title,1);case 5:if(t.t1="deck"===e.type,!t.t1){t.next=12;break}return this.board.players.red.sm.values.activeDeck.title=e.title,this.board.players.red.sm.values.activeDeck.cards=e.data.cards,this.board.players.red.sm.values.activeDeck.dice=e.data.dice,t.next=12,this.postDeck();case 12:return t.next=14,s.j.sleep(500);case 14:return t.next=16,this.board.players.red.getInventory();case 16:case"end":return t.stop()}}),t,this)})))}},{key:"toggleLeaderboard",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.board.players.red.sm.values.showLeaderboard){e.next=4;break}this.board.players.red.sm.disable("showLeaderboard"),e.next=7;break;case 4:return e.next=6,this.getLeaderboard();case 6:this.board.players.red.sm.enable("showLeaderboard");case 7:case"end":return e.stop()}}),e,this)})))}},{key:"getLeaderboard",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.httpMessenger.get("/leaderboard");case 3:t=e.sent,console.log(t),this.leaderboard=t,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"updateAlias",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0!==(t=document.querySelector("#alias").value).trim().length){e.next=4;break}return e.abrupt("return");case 4:return this.board.players.alias=t,this.board.players.red.sm.setValue("alias",t),e.next=8,this.board.players.red.updateAlias(this.httpMessenger,t);case 8:window.location.reload(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})))}},{key:"deactivateItem",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"toggleOnlineModal",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.board.players.red.p2p||(this.board.players.red.p2p=new Ue(this.board,this.board.events,this.board.players.red.alias,this.board.players.red.sm.values.lvl)),e.next=4,this.httpMessenger.getUrl("http://"+s.i.signalingServers[0].host+":"+s.i.signalingServers[0].port+"/pool");case 4:this.userPool=e.sent,this.intervalId=setInterval((function(){return Object(c.a)(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.httpMessenger.getUrl("http://"+s.i.signalingServers[0].host+":"+s.i.signalingServers[0].port+"/pool");case 2:this.userPool=e.sent;case 3:case"end":return e.stop()}}),e,this)})))}),5e3),this.board.sm.values.isOnlineModalVisible&&clearInterval(this.intervalId),this.board.sm.toggle("isOnlineModalVisible"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})))}},{key:"hostOnlineGame",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"challengePlayer",value:function(e){this.board.sm.enable("isPlayerChallenging"),this.board.events.emit("challengeBg",{gameType:"P2P",address:e.address})}},{key:"pickDeck",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isDeckPicked){t.next=2;break}return t.abrupt("return");case 2:return this.isDeckPicked=!0,console.log("selected",e,"deck"),n=[],r=[],i="",o="","todd"===e&&(i="[SD] Todd's Deck",o="assets/avatars/con37.png",n.push("d1ef825fbe0fd75661bbb27f0849510444d5ecee984fec8e7459246e7da7545c"),n.push("d1ef825fbe0fd75661bbb27f0849510444d5ecee984fec8e7459246e7da7545c"),n.push("d1ef825fbe0fd75661bbb27f0849510444d5ecee984fec8e7459246e7da7545c"),n.push("a2a0ad6f1c5114ddcbff0c6009109c7fe75bec1da4e4fda60cc476756564fb70"),n.push("a2a0ad6f1c5114ddcbff0c6009109c7fe75bec1da4e4fda60cc476756564fb70"),r.push("1df2083139e52af76218fec9852dc3e93396ace3bcb1a49ad19c365c7f472df3"),r.push("cd6ac8832503e5af0f0b5f9f808d8aba16e99d0653f5a080901876ad84d4a4d0"),r.push("89e5b132cf23d885614755849525f6c34be4b49101aff33571f85c362264f1e0"),r.push("6c7adfac5b33c549492263424ffa03eeac48d52d0380677ad91dc1c6a27707ef"),r.push("fb65394b9087e30a7abdf0edaa93e2df78a25494a81213d3598553abdc4e0ea5"),r.push("44f7e69a4848032601ff2acc6f6692798ca6c6ca75c3190fd7a6a008570857a1"),r.push("2a0b85c5b1551e9745efe1b01191cccfcc5f57bd4726e809e9a95891af326fdd"),r.push("b76a014f6907f69bd2ed6ef036ae0ac1d317524c6943533b55cd82bfd5951a6c"),r.push("6879e090838f2544314c17598555637ac8ac2d1fd34e3a538b276a227874bf83"),r.push("8a9b770f286822fe307889dfd64c0e0d23980317ac34dc469786a0f449011917")),"marla"===e&&(i="[SD] Marla's Deck",o="assets/avatars/con12.png",n.push("bdabd4e4dd212c09d5cd11b1dff8f457c69f0ede88cc86f3b813241af9cbae6b"),n.push("bdabd4e4dd212c09d5cd11b1dff8f457c69f0ede88cc86f3b813241af9cbae6b"),n.push("0cd90ec304d4c17c20d3e5744f559b742536acc075c47cc87f763bd92e5ecdca"),n.push("0cd90ec304d4c17c20d3e5744f559b742536acc075c47cc87f763bd92e5ecdca"),n.push("0cd90ec304d4c17c20d3e5744f559b742536acc075c47cc87f763bd92e5ecdca"),r.push("a2936861bcbb1cecba2e79193ac8d3b4cb8b19c1b48d8e59f6d4dc385561c4d8"),r.push("b8b0e174b76cf94f10760b23daa80b07b703e3f4e650e4ea6714425dff724876"),r.push("57c997f421e58c3cce4e3dfd15f2658906c74c80493652aa8c6ebe7d609237df"),r.push("09fdd7630b9ff03fe7f08945664ab3b156c7c2b97235aee3c96667c0e00afc15"),r.push("a63d0ff52abb2bd6c111c284eda1ad8acc72185c3517b6d23ce865691c982b08"),r.push("f9436538561491bc13beb7b844bcee9951b0069db99c00b3459cd639b59ab9a0"),r.push("853785361951f48b956138dcdc6332cffcc3b920f270017f8253db8bfbb82b88"),r.push("56eda163911da67bfbdafbd389e88e17426ff42b36e6fbc775ac4cfe1499edd6"),r.push("e420f637b0da5af8c60d9eddce4f97aec2083418f27925b912d3b5ba3670d57f"),r.push("b0b537493734277f4c841d9464d22c51fc78998dba73c7600722659f0e5a0382")),"travis"===e&&(i="[SD] Travis's Deck",o="assets/avatars/con10.png",n.push("8d22a7361794945791cf60490ee3987f7525f16daa3aeeb401cbebcf31c6845d"),n.push("8d22a7361794945791cf60490ee3987f7525f16daa3aeeb401cbebcf31c6845d"),n.push("31413b2a5950c0b3e021bb21220cce8a485c8302e86950d515c6fb535a6aa427"),n.push("31413b2a5950c0b3e021bb21220cce8a485c8302e86950d515c6fb535a6aa427"),n.push("31413b2a5950c0b3e021bb21220cce8a485c8302e86950d515c6fb535a6aa427"),r.push("57d3c734f1bb39d2bf8dfe021ba648d26e4a7325bdd7bde0fc3b47e304e8b0ab"),r.push("617da94edbe8b9eefb57553284c161da2c743743d62572a3ddd7319e28448a76"),r.push("1dc9c93e70884e899a65990422462e09d1db08776940a6a48cda4d6a23acbb93"),r.push("2968522cb9b6c5f42347083a427d142f80232381161eecaab68d61636156ede6"),r.push("d39cc4be23f5cb26d0fe8a3ab67f492a3d76e90da69ea78a862605c77ddd4bfd"),r.push("eb4c2234dd04c1966486264a72ab79bcd9c632d40732f543a9d138429799f938"),r.push("78924cee13a675c1bb94a88497a60b73c116e1ee98c71be4e566cd0d216f02d1"),r.push("e5d62ac6ccbb55929fddb19cf8e8147ee09cbdb32a5715057af17a189a7804cb"),r.push("4628d670374b1fa761e0cc8752931e05c6a06ccf90a2faf7adf9e36a879b5cdd"),r.push("4bb2c2c9f4065f57e0dbb7df7a516520848c91028249dc5f630923defbd235ee")),t.next=10,this.board.players.red.grantCards(this.httpMessenger,r);case 10:return t.next=12,this.board.players.red.grantDice(this.httpMessenger,n);case 12:return t.next=14,this.board.players.red.postDeck(this.httpMessenger,i,{cards:r,dice:n},1);case 14:return t.next=16,this.board.players.red.addAvatar(this.httpMessenger,o,e,1);case 16:window.location.reload();case 17:case"end":return t.stop()}}),t,this)})))}},{key:"getValues",value:function(e){return Object.values(e)}},{key:"togglePathsModal",value:function(){this.board.sm.toggle("showPathsModal")}}]),e}()).\u0275fac=function(e){return new(e||vt)},vt.\u0275cmp=p.Fb({type:vt,selectors:[["app-matchmaking"]],inputs:{board:"board",httpMessenger:"httpMessenger"},decls:7,vars:7,consts:[["class","main",4,"ngIf"],["class","opponents-modal",4,"ngIf"],["class","inventory-modal",4,"ngIf"],["class","leaderboard",4,"ngIf"],["class","online-modal",4,"ngIf"],["class","starter-decks-modal",4,"ngIf"],["class","paths-modal",4,"ngIf"],[1,"main"],[1,"container","top-left"],[1,"logo"],["src","/assets/logo.png"],[1,"sm",2,"text-align","center"],["color","primary",3,"click"],[1,"container","bottom-right"],["color","success",3,"click"],["class","new-card-container",4,"ngIf"],[1,"container","top-right"],[4,"ngIf"],["placeholder","Alias","id","alias",3,"value"],[1,"bg"],[1,"sm"],[1,"md"],[1,"container","bottom-left"],["color","warning",3,"click"],["id","languages",3,"change"],["value","en_US"],["value","es_ES"],["value","ca_CA"],["color","medium",3,"click"],[1,"new-card-container"],[3,"card","board",4,"ngFor","ngForOf"],[1,"new-dice",3,"dice"],[3,"card","board"],[1,"profile-avatar",3,"src"],[1,"opponents-modal"],["class","opponent",4,"ngFor","ngForOf"],["src","assets/icons/cancel.png",1,"close-modal",3,"click"],[1,"opponent"],[1,"left-part"],[1,"avatar-outer"],[1,"avatar",3,"src"],[1,"menu"],[1,"avatar-name"],[1,"dice-deck"],[3,"dice",4,"ngFor","ngForOf"],[1,"card-deck"],[3,"dice"],[1,"inventory-modal"],[1,"items"],["class","item",4,"ngFor","ngForOf"],[1,"actions"],[1,"action"],["id","deck-name","placeholder","Deck Name"],[1,"item"],[1,"item-title"],["class","item-avatar",4,"ngIf"],["class","item-deck-info",4,"ngIf"],[1,"item-type"],[1,"item-actions"],["color","success",3,"click",4,"ngIf"],["color","medium",3,"click",4,"ngIf"],["color","primary",3,"click",4,"ngIf"],[1,"item-avatar"],[3,"src"],[1,"item-deck-info"],[1,"leaderboard"],[1,"board"],[1,"header","row"],["class","row body",4,"ngFor","ngForOf"],[1,"row","body"],["class","item item-trophy",4,"ngIf"],[1,"item","item-trophy"],[1,"trophy"],["src","/assets/icons/trophy-1.png"],["src","/assets/icons/trophy-2.png"],["src","/assets/icons/trophy-3.png"],[1,"online-modal"],["class","user-pool",4,"ngIf"],[1,"user-pool"],[1,"user"],[1,"item","item-title"],["class","user",3,"dblclick",4,"ngFor","ngForOf"],[1,"user",3,"dblclick"],[1,"starter-decks-modal"],[1,"deck-choice",3,"click"],[1,"avatar"],["src","/assets/avatars/con37.png"],[1,"title"],[1,"attributes"],[1,"attribute"],["src","/assets/avatars/con12.png"],["src","/assets/avatars/con10.png"],[1,"info-text"],[1,"paths-modal"],[1,"paths","panel"],["class","path",4,"ngFor","ngForOf"],[1,"quests","panel"],[1,"path"]],template:function(e,t){1&e&&(p.nc(0,$e,44,8,"div",0),p.nc(1,Qe,3,1,"div",1),p.nc(2,ot,9,1,"div",2),p.nc(3,pt,13,1,"div",3),p.nc(4,bt,3,1,"div",4),p.nc(5,ht,48,9,"div",5),p.nc(6,mt,5,1,"div",6)),2&e&&(p.bc("ngIf",t.wallet),p.zb(1),p.bc("ngIf",t.board.sm.values.showOpponentsModal),p.zb(1),p.bc("ngIf",t.board.sm.values.displayInventory),p.zb(1),p.bc("ngIf",t.board.players.red.sm.values.showLeaderboard),p.zb(1),p.bc("ngIf",t.board.sm.values.isOnlineModalVisible),p.zb(1),p.bc("ngIf",t.board.players.red.sm.values.showStarterDeckPicker),p.zb(1),p.bc("ngIf",t.board.sm.values.showPathsModal))},directives:[r.j,r.i,_,R,Ge],styles:[".main[_ngcontent-%COMP%]{position:fixed;width:calc(100vw - 20px);height:calc(100vh - 20px);top:10px;left:10px;background-color:#343434;border-radius:5px;background-image:url(/assets/backgrounds/main-menu.jpg);background-size:cover;background-position:50%;justify-content:space-evenly;padding:20px 0;flex-direction:column}.main[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]{display:flex;align-items:center}.row[_ngcontent-%COMP%]{width:100%;justify-content:center}.user-pool[_ngcontent-%COMP%]{width:95%}.user-pool[_ngcontent-%COMP%]   .pool-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;transition:.3s}.user-pool[_ngcontent-%COMP%]   .pool-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:30%;text-align:center}.user-pool[_ngcontent-%COMP%]   .pool-item[_ngcontent-%COMP%]:not(.header):hover{background-color:#232323}.user-pool[_ngcontent-%COMP%]   .pool-item.header[_ngcontent-%COMP%]{font-weight:900;text-transform:uppercase}.direct-connect-panel[_ngcontent-%COMP%]{width:95%;display:flex;justify-content:center;align-items:center;flex-direction:column}ion-input[_ngcontent-%COMP%]{border:1px solid #000;color:#fff;width:100%;text-align:center}.actions[_ngcontent-%COMP%], .player-info[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;margin:0 10px;width:40%;height:100%}.player-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{background-color:#121212;color:#fff;padding:10px}.actions.purchase[_ngcontent-%COMP%]{width:60%;min-height:256px;margin-top:20px}.new-card-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.new-dice[_ngcontent-%COMP%]{margin:0 50px}.container[_ngcontent-%COMP%]{position:fixed;background-color:rgba(0,0,0,.9);color:#fff;display:flex;justify-content:center;align-items:center;flex-direction:column;padding:30px;min-width:400px}.container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:600px;padding:5px 10px;text-align:right}.container[_ngcontent-%COMP%]   .sm[_ngcontent-%COMP%]{font-size:.8em}.container[_ngcontent-%COMP%]   .md[_ngcontent-%COMP%]{font-size:1.2em}.container[_ngcontent-%COMP%]   .bg[_ngcontent-%COMP%]{font-size:1.5em}.container[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}.top-left[_ngcontent-%COMP%]{top:20px;left:20px}.top-right[_ngcontent-%COMP%]{top:20px;right:20px;align-items:flex-end}.profile-avatar[_ngcontent-%COMP%]{width:128px;height:128px;border:1px solid #fff;border-radius:5px;overflow:hidden}.profile-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.bottom-left[_ngcontent-%COMP%]{bottom:20px;left:20px}.bottom-right[_ngcontent-%COMP%]{bottom:20px;right:20px}.logo[_ngcontent-%COMP%]{width:400px}.logo[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:100%;filter:drop-shadow(0 0 3px white);transition:.5s}.logo[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]:hover{filter:drop-shadow(0 0 7px white)}.opponents-modal[_ngcontent-%COMP%]{position:fixed;background-color:rgba(0,0,0,.9);width:95vw;left:2.5vw;height:95vh;top:2.5vh;color:#fff;overflow-x:hidden;overflow-y:scroll;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;box-shadow:0 0 50px #000;border:1px solid #000;border-radius:5px}.opponents-modal[_ngcontent-%COMP%]   .opponent[_ngcontent-%COMP%]{position:relative;width:800px;margin:20px;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;background-color:#232323;border:1px solid #343434;padding:10px;border-radius:10px}.opponents-modal[_ngcontent-%COMP%]   .alias[_ngcontent-%COMP%]{font-size:2em;position:absolute;bottom:0;width:100%;background-color:rgba(0,0,0,.6);text-align:center}.opponents-modal[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:100%;height:100%}.opponents-modal[_ngcontent-%COMP%]   .card-deck[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;margin:20px;max-width:700px}.opponents-modal[_ngcontent-%COMP%]   .avatar-outer[_ngcontent-%COMP%]{position:relative;width:160px;height:160px;border:3px solid #fff;border-radius:10px;overflow:hidden}.opponents-modal[_ngcontent-%COMP%]   .left-part[_ngcontent-%COMP%]{width:300px;margin:20px 50px 20px 20px}.opponents-modal[_ngcontent-%COMP%]   .left-part[_ngcontent-%COMP%], .opponents-modal[_ngcontent-%COMP%]   .left-part[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.opponents-modal[_ngcontent-%COMP%]   .left-part[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%], .opponents-modal[_ngcontent-%COMP%]   .left-part[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}.opponents-modal[_ngcontent-%COMP%]   .left-part[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .opponents-modal[_ngcontent-%COMP%]   .left-part[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:20px}.opponents-modal[_ngcontent-%COMP%]   .left-part[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:1.5em;text-align:center}.close-modal[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;transition:.3s}.close-modal[_ngcontent-%COMP%]:hover{filter:drop-shadow(0 0 3px white)}#languages[_ngcontent-%COMP%], #languages[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000;width:100%;padding:10px;text-align:center}#languages[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{font-size:1.2em}.inventory-modal[_ngcontent-%COMP%]{width:100vw;height:100vh;background-color:rgba(0,0,0,.9);color:#fff;position:fixed;top:0;left:0;display:flex;justify-content:center;align-items:center}.inventory-modal[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]{width:70%;background-color:#000;height:95%;border:1px solid #343434;border-radius:10px;display:flex;justify-content:center;align-items:flex-start;flex-wrap:wrap;overflow-y:scroll}.inventory-modal[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{width:300px;height:400px;margin:10px;border:1px solid #fff;border-radius:10px;overflow:hidden;display:flex;justify-content:space-between;align-items:center;flex-direction:column;padding-bottom:20px;background-color:#343434}.inventory-modal[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-avatar[_ngcontent-%COMP%]{width:128px;border:1px solid #fff;border-radius:3px;overflow:hidden}.inventory-modal[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-type[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:1em;padding:5px 0}.inventory-modal[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{width:100%;text-align:center;font-size:1.2em;padding:10px 0;background-color:#fff;color:#000}.inventory-modal[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-deck-info[_ngcontent-%COMP%]{border:1px solid #fff;border-radius:3px;justify-content:space-evenly;width:128px;height:128px}.inventory-modal[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%], .inventory-modal[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .item-deck-info[_ngcontent-%COMP%]{background-color:#000;display:flex;align-items:center;flex-direction:column}.inventory-modal[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{width:20%;height:95%;border:1px solid #343434;overflow-y:scroll;border-radius:10px;justify-content:center}.inventory-modal[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{background-color:#fff;color:#000}.inventory-modal[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%], .inventory-modal[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%}.leaderboard[_ngcontent-%COMP%]{position:fixed;top:0;left:0;background-color:rgba(0,0,0,.9);width:100vw;height:100vh;color:#fff;display:flex;justify-content:center;align-items:center}.leaderboard[_ngcontent-%COMP%]   .board[_ngcontent-%COMP%]{width:60%;min-width:600px;height:80%;display:flex;justify-content:flex-start;overflow-y:scroll;align-items:center;flex-direction:column}.leaderboard[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center}.leaderboard[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{width:200px;text-align:center;margin:5px;padding:10px 0}.leaderboard[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:nth-child(2n){background-color:#232323}.leaderboard[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]:nth-child(odd){background-color:#454545}.leaderboard[_ngcontent-%COMP%]   .row.header[_ngcontent-%COMP%]{background-color:#fff;color:#000;font-size:1.2em}.avatar-name[_ngcontent-%COMP%]{border:1px solid #fff;width:100%;padding:5px 0;text-align:center}#alias[_ngcontent-%COMP%]{background-color:#fff;color:#000}.item-trophy[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:1.5em;font-weight:700}.trophy[_ngcontent-%COMP%]{width:64px}.trophy[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{filter:drop-shadow(0 0 1px white)}.online-modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0,0,0,.9);display:flex;justify-content:space-evenly;align-items:center}.online-modal[_ngcontent-%COMP%]   .item-title[_ngcontent-%COMP%]{font-weight:700;font-size:1.2em}.online-modal[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{text-align:center;width:30%}.online-modal[_ngcontent-%COMP%]   .user-pool[_ngcontent-%COMP%]{border:1px solid #454545;background-color:#000;width:60%;height:80vh;border-radius:10px;overflow-y:scroll;display:flex;flex-direction:column;align-items:center;justify-content:flex-start}.online-modal[_ngcontent-%COMP%]   .user-pool[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{width:70%;background-color:#232323;padding:10px;margin:5px 0;color:#fff;display:flex;justify-content:space-between;align-items:center;border:1px solid #000;transition:.3s}.online-modal[_ngcontent-%COMP%]   .user-pool[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]:hover{border:1px solid #fff}@media only screen and (max-width:1550px){.main[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:flex-start;overflow-y:scroll}.main[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative;top:unset;left:unset;right:unset;bottom:unset;margin:10px 0;width:900px;max-width:100%;text-align:center}.opponent[_ngcontent-%COMP%]{max-width:100%}.container.top-right[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;text-align:center}.bg[_ngcontent-%COMP%], .md[_ngcontent-%COMP%], .sm[_ngcontent-%COMP%]{text-align:center!important}}.starter-decks-modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0,0,0,.9);display:flex;justify-content:center;align-items:center}.starter-decks-modal[_ngcontent-%COMP%]   .info-text[_ngcontent-%COMP%]{position:absolute;bottom:25px;color:#fff;background-color:#000;padding:10px 20px;border:1px solid #343434;font-size:1.5em}.starter-decks-modal[_ngcontent-%COMP%]   .deck-choice[_ngcontent-%COMP%]{width:300px;height:400px;margin:0 10px;border:5px solid #dedede;display:flex;justify-content:center;align-items:center;flex-direction:column;border-radius:10px;background-color:#232323;transition:.3s}.starter-decks-modal[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#fff;width:100%;text-align:center;margin:10px 0}.starter-decks-modal[_ngcontent-%COMP%]   .deck-choice[_ngcontent-%COMP%]:hover{box-shadow:0 0 25px #fff}.starter-decks-modal[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:256px;border:1px solid #fff;border-radius:5px;overflow:hidden}.starter-decks-modal[_ngcontent-%COMP%]   .attribute[_ngcontent-%COMP%], .starter-decks-modal[_ngcontent-%COMP%]   .attributes[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.starter-decks-modal[_ngcontent-%COMP%]   .attribute[_ngcontent-%COMP%]{background-color:#000;border:1px solid #343434;padding:5px;margin:5px;border-radius:5px;color:#fff;flex-direction:column;text-transform:uppercase}.starter-decks-modal[_ngcontent-%COMP%]   .attribute[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:32px}.paths-modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0,0,0,.9);display:flex;justify-content:center;align-items:center}.paths-modal[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{background-color:#000;border:1px solid #343434;border-radius:10px;overflow-y:scroll;display:flex;justify-content:flex-start;align-items:center;flex-direction:column;height:90%;width:40%;margin:5%}.paths-modal[_ngcontent-%COMP%]   .path[_ngcontent-%COMP%]{background-color:#232323;border:#343434;color:#fff}"]}),vt);function Ct(e,t){if(1&e){var n=p.Pb();p.Ob(0,"app-dice-full",15),p.Wb("dblclick",(function(){p.ic(n);var e=t.$implicit;return p.Yb(2).selectAndClick(e)})),p.Nb()}if(2&e){var r=t.$implicit;p.bc("ngClass",r.sm.values.isSelected?"selected":"")("dice",r)}}function _t(e,t){if(1&e&&(p.Ob(0,"p"),p.oc(1),p.Nb()),2&e){var n=p.Yb(2);p.zb(1),p.qc("Dice Deck (",n.profile.diceCaboodle.getFiltered("isInDeck",!0).length,"/5)")}}function Ot(e,t){if(1&e){var n=p.Pb();p.Ob(0,"app-dice-full",15),p.Wb("dblclick",(function(){p.ic(n);var e=t.$implicit;return p.Yb(2).deselectAndClick(e)})),p.Nb()}if(2&e){var r=t.$implicit;p.bc("ngClass",r.sm.values.isSelected?"selected":"")("dice",r)}}function Pt(e,t){if(1&e&&(p.Ob(0,"div",11),p.Ob(1,"p"),p.oc(2),p.Nb(),p.Ob(3,"p"),p.oc(4),p.Nb(),p.Ob(5,"div",12),p.nc(6,Ct,1,2,"app-dice-full",13),p.Nb(),p.nc(7,_t,2,1,"p",14),p.Ob(8,"div",12),p.nc(9,Ot,1,2,"app-dice-full",13),p.Nb(),p.Nb()),2&e){var n=p.Yb();p.zb(2),p.pc(n.profile.sm.values.activeDeck.title),p.zb(2),p.qc("Dice Collection (",n.profile.diceCaboodle.getFiltered("isInDeck",!1).length,")"),p.zb(2),p.bc("ngForOf",n.getDiceDeck()),p.zb(1),p.bc("ngIf",n.profile.sm.values.canModifyDeck),p.zb(2),p.bc("ngForOf",n.profile.diceCaboodle.getFiltered("isInDeck",!0))}}var kt=function(e){return{hidden:e}};function wt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"app-card-mini",16),p.Wb("dblclick",(function(){p.ic(n);var e=t.$implicit;return p.Yb().selectAndClick(e)})),p.Nb()}if(2&e){var r=t.$implicit,i=p.Yb();p.bc("card",r)("board",i.board)("ngClass",p.fc(3,kt,r.sm.values.isInDeck))}}function xt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"app-card-mini",17),p.Wb("dblclick",(function(){p.ic(n);var e=t.$implicit;return p.Yb().deselectAndClick(e)})),p.Nb()}if(2&e){var r=t.$implicit,i=p.Yb();p.bc("card",r)("board",i.board)}}function Mt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",18),p.Wb("click",(function(){p.ic(n);var e=t.$implicit;return p.Yb().setFilterAttribute(e)})),p.Mb(1,"ion-img",19),p.Nb()}if(2&e){var r=t.$implicit,i=p.Yb();p.Bb("attribute-filter-item filter-item filter-item-",r,""),p.zb(1),p.cc("src",i.util.getDiceFace(r))}}var St,Tt=((St=function(){function e(){_classCallCheck(this,e),this.util=s.j,this.isCardSelected=!1,this.isDiceSelected=!1,this.filters={attribute:"",cost:-1}}return _createClass(e,[{key:"ngOnInit",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.profile.sm.values.wallet&&this.profile.loadActiveDeck();case 1:case"end":return e.stop()}}),e,this)})))}},{key:"selectCard",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.clearSelectedDice(),this.clearSelectedCards(),this.isDiceSelected=!1,this.isCardSelected=!0,n=this.profile.cardsCaboodle.getFiltered("originalHash",e.originalHash),e.sm.toggle("isSelected"),(r=n.filter((function(e){return!e.sm.values.isInDeck}))[0])||(r=e),r.sm.enable("isSelected");case 5:case"end":return t.stop()}}),t,this)})))}},{key:"selectDeckCard",value:function(e){this.clearSelectedCards(),e.sm.toggle("isSelected")}},{key:"selectDice",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.clearSelectedDice(),this.clearSelectedCards(),this.isDiceSelected=!0,this.isCardSelected=!1,e.sm.setValue("isSelected",!e.sm.values.isSelected);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"addToDeck",value:function(){this.isCardSelected&&!this.isDiceSelected&&this.addCardsToDeck(),this.isDiceSelected&&!this.isCardSelected&&this.addDiceToDeck()}},{key:"rmFromDeck",value:function(){}},{key:"viewItem",value:function(){}},{key:"addCardsToDeck",value:function(){for(var e=this.profile.cardsCaboodle.getFiltered("isSelected",!0),t=0;t<e.length;t++)e[t].sm.enable("isInDeck");this.clearSelectedCards()}},{key:"clearSelectedCards",value:function(){for(var e=this.profile.cardsCaboodle.items,t=0;t<e.length;t++)e[t].sm.setState("deselected-"+e[t].hash);for(var n=this.profile.cards.items,r=0;r<n.length;r++)n[r].sm.setState("deselected-"+n[r].hash)}},{key:"clearSelectedDice",value:function(){for(var e=this.profile.diceCaboodle.items,t=0;t<e.length;t++)e[t].sm.setState("deselected-"+e[t].hash)}},{key:"rmCardsFromDeck",value:function(){for(var e=this.profile.cardsCaboodle.getFiltered("isSelected",!0),t=0;t<e.length;t++)e[t].sm.setState("rmFromDeck-"+e[t].hash);this.clearSelectedCards()}},{key:"addDiceToDeck",value:function(){for(var e=this.profile.diceCaboodle.getFiltered("isSelected",!0),t=0;t<e.length;t++)e[t].sm.setState("addToDeck-"+e[t].hash);this.clearSelectedDice()}},{key:"rmDiceFromDeck",value:function(){for(var e=this.profile.diceCaboodle.getFiltered("isSelected",!0),t=0;t<e.length;t++)e[t].sm.setState("rmFromDeck-"+e[t].hash);this.clearSelectedDice()}},{key:"getBoosterPack",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.profile.getBalance();case 2:this.profile.events.on("purchaseFn",(function(e){})),this.profile.events.emit("purchaseBg",{profile:this.profile,httpMessenger:this.httpMessenger});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"storeLocalDeck",value:function(){var e=this.profile.cardsCaboodle.getFiltered("isInDeck",!0).map((function(e){return{hash:e.hash,originalHash:e.originalHash}}));localStorage.setItem("deck",JSON.stringify(e));var t=this.profile.diceCaboodle.getFiltered("isInDeck",!0).map((function(e){return{hash:e.hash,originalHash:e.originalHash}}));localStorage.setItem("dice-deck",JSON.stringify(t))}},{key:"closeModal",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storeRemoteDeck();case 2:return e.next=4,this.profile.getInventory();case 4:this.profile.sm.enable("deckReady");case 5:case"end":return e.stop()}}),e,this)})))}},{key:"selectAndClick",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e instanceof s.c,!t.t0){t.next=4;break}return t.next=4,this.selectDice(e);case 4:if(t.t1=e instanceof s.b,!t.t1){t.next=8;break}return t.next=8,this.selectCard(e);case 8:this.addToDeck();case 9:case"end":return t.stop()}}),t,this)})))}},{key:"deselectAndClick",value:function(e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e instanceof s.c,!t.t0){t.next=5;break}return t.next=4,this.selectDice(e);case 4:this.rmDiceFromDeck();case 5:if(t.t1=e instanceof s.b,!t.t1){t.next=10;break}return t.next=9,this.selectCard(e);case 9:this.rmCardsFromDeck();case 10:case"end":return t.stop()}}),t,this)})))}},{key:"getFilterCosts",value:function(){var e=[];return this.profile.cards.items.filter((function(t){return!e.includes(t.cost)&&(e.push(t.cost),!0)})),e}},{key:"getFiltersAttributes",value:function(){var e=[];return this.profile.cards.items.filter((function(t){return!e.includes(t.attribute)&&(e.push(t.attribute),!0)})),e}},{key:"setFilterAttribute",value:function(e){var t=document.querySelectorAll(".attribute-filter-item"),n=!0;document.querySelector(".filter-item-"+e).classList.contains("active")&&(n=!1);for(var r=0;r<t.length;r++)t[r].classList.remove("active");n?(this.filters.attribute=e,document.querySelector(".filter-item-"+e).classList.add("active")):this.filters.attribute=""}},{key:"getCardsDeck",value:function(){var e=this,t=this.profile.cardsCaboodle.getFiltered("isInDeck",!0).map((function(e){return e.sm.values.originalHash}));if(""===this.filters.attribute&&this.filters.cost<0)return this.profile.cards.getFiltered("isOwned",!0,"attribute").filter((function(e){return!t.includes(e.sm.values.originalHash)}));var n=this.profile.cards.getFiltered("isOwned",!0,"attribute");return n.filter((function(t){return""!==e.filters.attribute?e.filters.cost>=0?!n.includes(t.sm.values.originalHash)&&t.cost===e.filters.cost&&t.attribute===e.filters.attribute:!n.includes(t.sm.values.originalHash)&&t.attribute===e.filters.attribute:e.filters.cost>=0?!n.includes(t.sm.values.originalHash)&&t.cost===e.filters.cost&&t.attribute===e.filters.attribute:void 0}))}},{key:"getDiceDeck",value:function(){var e=this;return""===this.filters.attribute&&this.filters.cost<0?this.profile.diceCaboodle.getFiltered("isInDeck",!1,"color"):this.profile.diceCaboodle.getFiltered("isInDeck",!1,"color").filter((function(t){if(""!==e.filters.attribute)return t.faces.includes(e.filters.attribute)}))}},{key:"storeRemoteDeck",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.profile.cardsCaboodle.getFiltered("isInDeck",!0),n=this.profile.diceCaboodle.getFiltered("isInDeck",!0),r=[],i=0;i<t.length;i++)r.push({hash:t[i].sm.values.hash,originalHash:t[i].originalHash});for(o=[],a=0;a<n.length;a++)o.push({hash:n[a].sm.values.hash,originalHash:n[a].originalHash});return this.profile.sm.values.activeDeck.cards=r,this.profile.sm.values.activeDeck.dice=o,e.next=8,this.profile.postDeck(this.httpMessenger,this.profile.sm.values.activeDeck.title,{dice:o,cards:r},1);case 8:case"end":return e.stop()}}),e,this)})))}}]),e}()).\u0275fac=function(e){return new(e||St)},St.\u0275cmp=p.Fb({type:St,selectors:[["app-card-collection"]],inputs:{profile:"profile",httpMessenger:"httpMessenger",board:"board"},decls:15,vars:7,consts:[[1,"main"],["class","collection-side dice-side",4,"ngIf"],[1,"deck-side",3,"ngClass"],[1,"grid","card-collection"],[3,"card","board","ngClass","dblclick",4,"ngFor","ngForOf"],[1,"card-deck-grid"],[3,"card","board","dblclick",4,"ngFor","ngForOf"],[1,"filters-container"],[1,"filter","attribute-filter"],[3,"class","click",4,"ngFor","ngForOf"],["src","assets/icons/cancel.png",1,"close-modal",3,"click"],[1,"collection-side","dice-side"],[1,"dice-grid"],[3,"ngClass","dice","dblclick",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngClass","dice","dblclick"],[3,"card","board","ngClass","dblclick"],[3,"card","board","dblclick"],[3,"click"],[1,"filter-icon",3,"src"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.nc(1,Pt,10,5,"div",1),p.Ob(2,"div",2),p.Ob(3,"p"),p.oc(4),p.Nb(),p.Ob(5,"div",3),p.nc(6,wt,1,5,"app-card-mini",4),p.Nb(),p.Ob(7,"p"),p.oc(8),p.Nb(),p.Ob(9,"div",5),p.nc(10,xt,1,2,"app-card-mini",6),p.Nb(),p.Nb(),p.Ob(11,"div",7),p.Ob(12,"div",8),p.nc(13,Mt,2,4,"div",9),p.Nb(),p.Nb(),p.Ob(14,"ion-img",10),p.Wb("click",(function(){return t.closeModal()})),p.Nb(),p.Nb()),2&e&&(p.zb(1),p.bc("ngIf",t.profile.sm.values.canModifyDeck),p.zb(1),p.bc("ngClass",t.profile.sm.values.canModifyDeck?"":"cannot-edit"),p.zb(2),p.qc("Card Collection (",t.profile.cardsCaboodle.getFiltered("isOwned",!0).length,")"),p.zb(2),p.bc("ngForOf",t.getCardsDeck()),p.zb(2),p.qc("Card Deck (",t.profile.cardsCaboodle.getFiltered("isInDeck",!0).length,"/7)"),p.zb(2),p.bc("ngForOf",t.profile.cardsCaboodle.getFiltered("isInDeck",!0)),p.zb(3),p.bc("ngForOf",t.getFiltersAttributes()))},directives:[r.j,r.h,r.i,Ge,R],styles:[".grid[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#000;border:1px solid #343434;overflow-y:scroll;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;max-height:60%}.card-view-menu[_ngcontent-%COMP%]{font-size:5em!important}.main[_ngcontent-%COMP%]{display:flex;width:100vw;height:100vh;justify-content:space-evenly;align-items:center}.buttons[_ngcontent-%COMP%], .collection-side[_ngcontent-%COMP%], .deck-side[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;position:relative}.collection-side[_ngcontent-%COMP%], .deck-side[_ngcontent-%COMP%]{width:40%;height:95vh}p[_ngcontent-%COMP%]{width:100%;font-size:1.3em;color:#fff;text-align:center}.buttons[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:64px;height:64px;color:#fff;font-size:2em;display:flex;justify-content:center;align-items:center;border:1px solid #fff;margin:10px}app-card-mini[_ngcontent-%COMP%]{border:3px solid #000}app-card-mini.selected[_ngcontent-%COMP%]{border:3px solid #fff;border-radius:5px}app-dice.selected[_ngcontent-%COMP%]{background:radial-gradient(hsla(0,0%,100%,.4),transparent)}.card-collection[_ngcontent-%COMP%]{position:relative}.play-overlay[_ngcontent-%COMP%]{position:absolute;height:100%;background-color:hsla(0,0%,100%,.6);font-size:3em;font-weight:700;color:#000;letter-spacing:5px}.dice-grid[_ngcontent-%COMP%], .play-overlay[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center}.dice-grid[_ngcontent-%COMP%]{flex-wrap:wrap;height:40%;background-color:#000;border:1px solid #343434;margin:10px 0;overflow-x:hidden;overflow-y:scroll}.close-modal[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;transition:.3s}.close-modal[_ngcontent-%COMP%]:hover{filter:drop-shadow(0 0 3px white)}.deck-side.cannot-edit[_ngcontent-%COMP%]{width:100%;height:320px;bottom:0;position:absolute}.dice-side[_ngcontent-%COMP%]{max-width:420px}.deck-side[_ngcontent-%COMP%]{width:calc(100% - 500px)}.card-deck-grid[_ngcontent-%COMP%]{width:100%;height:200px;overflow-x:scroll;display:flex;justify-content:flex-start;align-items:center;background-color:#000;border:1px solid #343434}.card-collection[_ngcontent-%COMP%]   app-card-mini[_ngcontent-%COMP%]{margin:15px}.card-deck-grid[_ngcontent-%COMP%]   app-card-mini[_ngcontent-%COMP%]{margin:0 20px}.filters-container[_ngcontent-%COMP%]{position:fixed;width:100vw;height:auto;color:#fff;top:15px;left:0;justify-content:space-evenly}.filter[_ngcontent-%COMP%], .filters-container[_ngcontent-%COMP%]{display:flex;align-items:center}.filter[_ngcontent-%COMP%]{justify-content:center}.filter-item[_ngcontent-%COMP%]{margin:5px}.attribute-filter[_ngcontent-%COMP%]   .filter-item[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:100%;border:1px solid #fff;overflow:hidden}.filter-icon[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:100%;border:1px solid #fff}.attribute-filter-item.active[_ngcontent-%COMP%]{background-color:#428cff}"]}),St);function Rt(e,t){if(1&e&&(p.Ob(0,"div",19),p.Mb(1,"ion-img",20),p.Ob(2,"div",4),p.oc(3),p.Nb(),p.Nb()),2&e){var n=p.Yb();p.zb(3),p.pc(n.card.sm.values.vit)}}function Dt(e,t){if(1&e&&p.Mb(0,"ion-img",21),2&e){var n=p.Yb();p.cc("src",n.card.sm.values.equipedCard.battlerUrl)}}function Et(e,t){if(1&e&&(p.Ob(0,"div",24),p.Ob(1,"p"),p.Ob(2,"b"),p.oc(3),p.Nb(),p.Nb(),p.Ob(4,"p"),p.oc(5),p.Nb(),p.Ob(6,"p"),p.Ob(7,"b"),p.oc(8,"Cost:"),p.Nb(),p.oc(9),p.Nb(),p.Nb()),2&e){var n=t.$implicit,r=p.Yb(2);p.zb(3),p.pc(r.board.abilityCollection.get(n).name),p.zb(2),p.pc(r.board.abilityCollection.get(n).description),p.zb(4),p.rc(" x",r.board.abilityCollection.get(n).cost," ",r.board.abilityCollection.get(n).attribute.toUpperCase(),"")}}function Nt(e,t){if(1&e&&(p.Ob(0,"div",22),p.nc(1,Et,10,4,"div",23),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.bc("ngForOf",n.card.abilities)}}function It(e,t){if(1&e&&(p.Ob(0,"span"),p.oc(1),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.qc("/ ",n.card.cooldown,"")}}function jt(e,t){if(1&e&&(p.Ob(0,"div",25),p.Ob(1,"b"),p.oc(2,"Range: "),p.Nb(),p.oc(3),p.Nb()),2&e){var n=p.Yb();p.zb(3),p.qc("",n.card.sm.values.rng," ")}}function zt(e,t){if(1&e&&(p.Ob(0,"div",26),p.Mb(1,"ion-img",27),p.Ob(2,"div",4),p.oc(3),p.Nb(),p.Nb()),2&e){var n=p.Yb();p.zb(3),p.pc(n.card.sm.values.mov)}}function Ft(e,t){if(1&e&&(p.Ob(0,"div",28),p.Mb(1,"ion-img",29),p.Ob(2,"div",4),p.oc(3),p.Nb(),p.Nb()),2&e){var n=p.Yb();p.zb(3),p.pc(n.card.sm.values.btl)}}var At,Bt=((At=function(){function e(){_classCallCheck(this,e),this.util=s.j}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"closeCardView",value:function(){this.board.sm.values.cardInDisplay=!1}},{key:"getTranslatedClans",value:function(){for(var e=this.card.clans,t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join(" \xb7 ")}}]),e}()).\u0275fac=function(e){return new(e||At)},At.\u0275cmp=p.Fb({type:At,selectors:[["app-card-full"]],inputs:{card:"card",board:"board"},decls:25,vars:16,consts:[[1,"main"],[1,"card-outer"],[1,"stat","cost","icon-bg"],["src","/assets/card-resources/sun.png"],[1,"stat-value"],[1,"stat","attribute"],[3,"src"],["class","stat vit icon-bg",4,"ngIf"],[1,"illustration",3,"src"],["class","equiped-weapon",3,"src",4,"ngIf"],[1,"title"],[1,"clans"],["class","abilities",4,"ngIf"],[1,"cooldown"],[4,"ngIf"],["class","range",4,"ngIf"],["class","stat mov icon-bg",4,"ngIf"],["class","stat btl icon-bg",4,"ngIf"],["src","assets/icons/cancel.png",1,"close-modal",3,"click"],[1,"stat","vit","icon-bg"],["src","/assets/card-resources/heart.png"],[1,"equiped-weapon",3,"src"],[1,"abilities"],["class","ability",4,"ngFor","ngForOf"],[1,"ability"],[1,"range"],[1,"stat","mov","icon-bg"],["src","/assets/card-resources/boot.png"],[1,"stat","btl","icon-bg"],["src","/assets/card-resources/fist.png"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.Ob(1,"div",1),p.Ob(2,"div",2),p.Mb(3,"ion-img",3),p.Ob(4,"div",4),p.oc(5),p.Nb(),p.Nb(),p.Ob(6,"div",5),p.Mb(7,"ion-img",6),p.Nb(),p.nc(8,Rt,4,1,"div",7),p.Mb(9,"ion-img",8),p.nc(10,Dt,1,1,"ion-img",9),p.Ob(11,"div",10),p.oc(12),p.Nb(),p.Ob(13,"div",11),p.oc(14),p.Nb(),p.nc(15,Nt,2,1,"div",12),p.Ob(16,"div",13),p.Ob(17,"b"),p.oc(18,"Cooldown: "),p.Nb(),p.oc(19),p.nc(20,It,2,1,"span",14),p.Nb(),p.nc(21,jt,4,1,"div",15),p.nc(22,zt,4,1,"div",16),p.nc(23,Ft,4,1,"div",17),p.Nb(),p.Nb(),p.Ob(24,"ion-img",18),p.Wb("click",(function(){return t.closeCardView()})),p.Nb()),2&e&&(p.zb(1),p.lc("background-image:url(",t.card.backgroundUrl,");"),p.zb(4),p.pc(t.card.sm.values.cost),p.zb(2),p.cc("src",t.util.getDiceFace(t.card.attribute)),p.zb(1),p.bc("ngIf",!t.card.sm.values.clans.includes("Hex")&&!t.card.sm.values.clans.includes("Illusion")),p.zb(1),p.cc("src",t.card.battlerUrl),p.zb(1),p.bc("ngIf",t.card.sm.values.equipedCard),p.zb(2),p.qc(" ",t.card.title," "),p.zb(2),p.qc(" ",t.getTranslatedClans()," "),p.zb(1),p.bc("ngIf",t.card.abilities.length>0),p.zb(4),p.qc("",t.card.sm.values.cooldown," "),p.zb(1),p.bc("ngIf",t.card.sm.values.cooldown!==t.card.cooldown),p.zb(1),p.bc("ngIf",!t.card.sm.values.clans.includes("Hex")&&!t.card.sm.values.clans.includes("Illusion")),p.zb(1),p.bc("ngIf",!t.card.sm.values.clans.includes("Hex")&&!t.card.sm.values.clans.includes("Illusion")),p.zb(1),p.bc("ngIf",!t.card.sm.values.clans.includes("Hex")&&!t.card.sm.values.clans.includes("Illusion")))},directives:[r.j,r.i],styles:[".main[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.card-outer[_ngcontent-%COMP%]{height:80vh;width:60vh;border:5px solid #fff;border-radius:3px;background-repeat:repeat;position:relative}.illustration[_ngcontent-%COMP%]{position:absolute;top:64px;width:70%;left:15%;filter:drop-shadow(0 0 10px white)}.stat[_ngcontent-%COMP%]{color:#000;position:absolute;width:96px;height:96px;background-size:cover;background-position:50%;font-size:1.2em;background-color:#000;border:3px solid #fff;border-radius:3px}.stat[_ngcontent-%COMP%], .stat[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.stat[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{z-index:1;width:100%;height:100%;font-size:2em}.cost[_ngcontent-%COMP%]{top:-32px;left:-32px}.mov[_ngcontent-%COMP%]{left:-32px}.btl[_ngcontent-%COMP%], .mov[_ngcontent-%COMP%]{bottom:-32px}.btl[_ngcontent-%COMP%], .vit[_ngcontent-%COMP%]{right:-32px}.vit[_ngcontent-%COMP%]{top:-32px}.attribute[_ngcontent-%COMP%]{width:128px;height:128px;top:-64px;left:calc(50% - 64px);background-color:#000;border-radius:100%;border:3px solid #fff;overflow:hidden}.attribute[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:100%}.vit[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{position:relative;top:-3px}.icon-bg[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.icon-bg[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{position:absolute;width:80%;height:80%;filter:drop-shadow(0 0 3px black)}.title[_ngcontent-%COMP%]{top:500px;width:90%;background-color:#fff;left:5%;height:64px;font-size:1.4em;text-align:center}.clans[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;border:3px solid #000}.clans[_ngcontent-%COMP%]{top:570px;width:80%;left:10%;background-color:#dedede;font-size:1.1em}.abilities[_ngcontent-%COMP%]{position:absolute;width:98%;left:1%;top:600px;display:flex;justify-content:center;align-items:center}.ability[_ngcontent-%COMP%]{background-color:#fff;color:#000;min-width:40%;font-size:.8em;margin:5px;text-align:center}.close-modal[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;transition:.3s}.close-modal[_ngcontent-%COMP%]:hover{filter:drop-shadow(0 0 3px white)}.cooldown[_ngcontent-%COMP%]{top:72px;left:-32px}.cooldown[_ngcontent-%COMP%], .range[_ngcontent-%COMP%]{position:absolute;background-color:#000;color:#fff;font-size:1.3em;padding:10px;border:3px solid #fff;border-radius:5px}.range[_ngcontent-%COMP%]{bottom:72px;right:-32px}.clans[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{color:#000}.equiped-weapon[_ngcontent-%COMP%]{position:absolute;top:200px;left:0;width:384px;filter:drop-shadow(0 0 10px white)}"]}),At);function Lt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",1),p.Ob(1,"p"),p.oc(2,"Access"),p.Nb(),p.Mb(3,"ion-input",2),p.Mb(4,"ion-input",3),p.Ob(5,"p",4),p.oc(6,"min 8 chars, 1 symbol (!,$,%,&,@,#),"),p.Mb(7,"br"),p.oc(8," 1 uppercase letter, 1 lowercase letter,"),p.Mb(9,"br"),p.oc(10," 1 number"),p.Nb(),p.Ob(11,"div",5),p.Ob(12,"ion-button",6),p.Wb("click",(function(){return p.ic(n),p.Yb().register()})),p.oc(13,"Register"),p.Nb(),p.Ob(14,"span"),p.oc(15,"or"),p.Nb(),p.Ob(16,"ion-button",6),p.Wb("click",(function(){return p.ic(n),p.Yb().auth()})),p.oc(17,"Sign in"),p.Nb(),p.Nb(),p.Nb()}}function Yt(e,t){if(1&e&&(p.Ob(0,"div",1),p.Ob(1,"p"),p.oc(2,"Your account"),p.Nb(),p.Mb(3,"ion-input",7),p.Mb(4,"ion-input",7),p.Ob(5,"p"),p.oc(6,"Your balance"),p.Nb(),p.Mb(7,"ion-input",7),p.Ob(8,"div",5),p.Ob(9,"ion-button",8),p.oc(10,"Log out"),p.Nb(),p.Nb(),p.Nb()),2&e){var n=p.Yb();p.zb(3),p.cc("value",n.email),p.zb(1),p.cc("value",n.address),p.zb(3),p.cc("value",n.balance)}}var Ut,Wt,Gt=((Wt=function(){function e(){_classCallCheck(this,e),this.hasAuthToken=!1,this.address="",this.email="",this.balance=0}return _createClass(e,[{key:"ngOnInit",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i,o,a,c,d,l,p,u,f=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("failSafe")){e.next=2;break}return e.abrupt("return",(localStorage.clear(),localStorage.setItem("failSafe","true"),window.location.reload()));case 2:if(!(t=localStorage.getItem("auth-token"))){e.next=28;break}return n=new s.h,r=s.h.claimFromString(t),n.fromPrivateKey(localStorage.getItem("privateKey"),r.payload.email),this.profile.sm.values.wallet||this.profile.sm.setValue("wallet",n),this.profile.events.on("setValue",(function(e){f.profile.sm.setValue(e.key,e.value)})),this.profile.sm.events.emit("setValue",{key:"email",value:r.payload.email}),this.profile.sm.events.emit("setValue",{key:"address",value:n.address}),e.next=12,this.profile.getBalance();case 12:return e.next=14,this.profile.getAlias();case 14:return this.profile.sm.events.emit("authFn",{}),e.next=17,this.profile.getCards();case 17:for(i=e.sent,o=0;o<i.length;o++)a=i[o],c=s.h.claimFromString(a),this.profile.events.emit("gainOwnership-"+c.payload.card,{token:a,claim:c,profile:this.profile});return e.next=21,this.profile.getDice();case 21:for(d=e.sent,l=0;l<d.length;l++)p=d[l],u=s.h.claimFromString(p),this.profile.events.emit("gainOwnership-"+u.payload.dice,{token:p,claim:u,profile:this.profile});return e.next=25,this.profile.getInventory();case 25:this.starterDecks(),this.profile.loadActiveDeck(),this.profile.sm.enable("deckReady");case 28:return e.next=30,s.j.sleep(500);case 30:document.querySelector(".splash").classList.add("hide");case 31:case"end":return e.stop()}}),e,this)})))}},{key:"register",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.profile.sm.values.isBusy){e.next=2;break}return e.abrupt("return");case 2:t=document.querySelector('ion-input[name="email"]').value.toString().trim(),n=document.querySelector('ion-input[name="password"]').value.toString().trim(),this.profile.events.emit("registerBg",{email:t,password:n,httpMessenger:this.httpMessenger});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"auth",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.profile.sm.values.isBusy){e.next=2;break}return e.abrupt("return");case 2:t=document.querySelector('ion-input[name="email"]').value.toString().trim(),n=document.querySelector('ion-input[name="password"]').value.toString().trim(),this.profile.events.emit("authBg",{email:t,password:n,httpMessenger:this.httpMessenger});case 4:case"end":return e.stop()}}),e,this)})))}},{key:"starterDecks",value:function(){var e=this.profile.sm.values.inventory;console.log("red player",e),e.filter((function(e){return"deck"===e.type&&e.title.indexOf("[SD")>=0})).length>0||this.profile.sm.enable("showStarterDeckPicker")}}]),e}()).\u0275fac=function(e){return new(e||Wt)},Wt.\u0275cmp=p.Fb({type:Wt,selectors:[["app-auth-modal"]],inputs:{events:"events",profile:"profile",httpMessenger:"httpMessenger"},decls:2,vars:2,consts:[["class","modal auth-modal",4,"ngIf"],[1,"modal","auth-modal"],["name","email","placeholder","Email","type","email"],["name","password","placeholder","Password","type","password"],[1,"tip"],[1,"button-container"],["color","dark",3,"click"],["type","text","disabled","true",3,"value"],["color","dark"]],template:function(e,t){1&e&&(p.nc(0,Lt,18,0,"div",0),p.nc(1,Yt,11,3,"div",0)),2&e&&(p.bc("ngIf",!t.hasAuthToken),p.zb(1),p.bc("ngIf",t.hasAuthToken))},directives:[r.j],styles:[".modal[_ngcontent-%COMP%]{font-family:Avenir;width:500px;display:flex;justify-content:center;align-items:center;flex-direction:column;font-size:1.2em;background-color:#1e1e1e;padding:20px;color:#fff;box-shadow:0 0 20px #000}ion-input[_ngcontent-%COMP%]{background-color:#343434;width:80%;border-top:1px solid #121212;border-bottom:1px solid #121212;margin:10px 0;text-align:center}.button-container[_ngcontent-%COMP%]{width:80%;display:flex;justify-content:space-evenly;align-items:center;margin:20px 0}p.tip[_ngcontent-%COMP%]{width:100%;font-size:.8em;text-align:center}"]}),Wt),Vt=((Ut=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"closeModal",value:function(){this.board.sm.toggle("showHelp")}}]),e}()).\u0275fac=function(e){return new(e||Ut)},Ut.\u0275cmp=p.Fb({type:Ut,selectors:[["app-help"]],inputs:{board:"board"},decls:81,vars:0,consts:[[1,"main"],[1,"title"],[1,"info-container","general"],[1,"subtitle"],[1,"info-container","cards"],[1,"info-container","dice"],[1,"info-container","deck-editor"],[1,"info-container","board"],["src","assets/icons/cancel.png",1,"close-modal",3,"click"]],template:function(e,t){1&e&&(p.Ob(0,"div",0),p.Ob(1,"div",1),p.oc(2,"Welcome to Dice Guardians ALPHA"),p.Nb(),p.Ob(3,"div",2),p.Ob(4,"p",3),p.oc(5,"General"),p.Nb(),p.Ob(6,"p"),p.oc(7,'On the main menu click "FULLSCREEN" to get the best experience'),p.Nb(),p.Ob(8,"p"),p.oc(9,"Dice Guardians is a deck building 1v1 dungeon crawler"),p.Nb(),p.Ob(10,"p"),p.oc(11,"You gain EXP and coin for every won game"),p.Nb(),p.Ob(12,"p"),p.oc(13,"Coin can be exchanged for booster packs, which contain at least 3 cards and 1 dice"),p.Nb(),p.Nb(),p.Ob(14,"div",4),p.Ob(15,"p",3),p.oc(16,"The Cards"),p.Nb(),p.Ob(17,"p"),p.oc(18,"Cards show 4 attributes in their miniatures; cost, vitality, movement and battle"),p.Nb(),p.Ob(19,"p"),p.Ob(20,"b"),p.oc(21,"Cost:"),p.Nb(),p.oc(22," How much energy of a determined type must be used to cast the creature into the board"),p.Nb(),p.Ob(23,"p"),p.Ob(24,"b"),p.oc(25,"Vitality:"),p.Nb(),p.oc(26," How much damage this creature can take once on the board"),p.Nb(),p.Ob(27,"p"),p.Ob(28,"b"),p.oc(29,"Movement:"),p.Nb(),p.oc(30," How many titles this creature can advance on the board every turn"),p.Nb(),p.Ob(31,"p"),p.Ob(32,"b"),p.oc(33,"Battle:"),p.Nb(),p.oc(34," How much damage this creature inflicts to an opponent's vitality when attacking on the board"),p.Nb(),p.Ob(35,"p"),p.oc(36,"The background color of the card determines it's Attribute, which is the type of energy necessary to cast the creature"),p.Nb(),p.Nb(),p.Ob(37,"div",5),p.Ob(38,"p",3),p.oc(39,"The Dice"),p.Nb(),p.Ob(40,"p"),p.oc(41,"Dice are your main source of energy on the game"),p.Nb(),p.Ob(42,"p"),p.oc(43,"Every turn you roll 3 dice and collect the energy on the rolled faces"),p.Nb(),p.Ob(44,"p"),p.oc(45,"You can then use that energy to cast creatures into the board"),p.Nb(),p.Ob(46,"p"),p.oc(47,"As an example, creatures of the Water attribute will require Water dice crests rolled"),p.Nb(),p.Nb(),p.Ob(48,"div",6),p.Ob(49,"p",3),p.oc(50,"The Deck Editor"),p.Nb(),p.Ob(51,"p"),p.oc(52,'You can access the deck builder with the "DECK EDITOR" button on the top-left panel'),p.Nb(),p.Ob(53,"p"),p.oc(54,"The containers at the top show your collection of dice and cards"),p.Nb(),p.Ob(55,"p"),p.oc(56,"Double click on any to add them to your deck"),p.Nb(),p.Ob(57,"p"),p.oc(58,"Even tho it's not inforced we encourage the usage of decks with 5 dice and 7 cards"),p.Nb(),p.Nb(),p.Ob(59,"div",7),p.Ob(60,"p",3),p.oc(61,"The Board"),p.Nb(),p.Ob(62,"p"),p.oc(63,"Start your turn by selecting and rolling your dice"),p.Nb(),p.Ob(64,"p"),p.oc(65,"Your accumulated energy will display on the right side of the board"),p.Nb(),p.Ob(66,"p"),p.oc(67,"If you accumulated enough energy to cast a creature it's card will show in the bottom menu"),p.Nb(),p.Ob(68,"p"),p.oc(69,"The tiles where the cast can be conducted will be highlightened in the field"),p.Nb(),p.Ob(70,"p"),p.oc(71,"After casting you can unfold 5 more floor tiles"),p.Nb(),p.Ob(72,"p"),p.oc(73,"Both your and your enemie's creatures will require floor tiles to walk on"),p.Nb(),p.Ob(74,"p"),p.oc(75,"After the cast you can either move or battle with the creature on the board"),p.Nb(),p.Ob(76,"p"),p.oc(77,"Every turn you'll have the chance to move once and battle once with every creature on the board"),p.Nb(),p.Ob(78,"p"),p.oc(79,"The first to take 5 enemies down (reduce their Vitality to 0) wins"),p.Nb(),p.Nb(),p.Ob(80,"ion-img",8),p.Wb("click",(function(){return t.closeModal()})),p.Nb(),p.Nb())},styles:[".main[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;color:#fff;overflow-y:scroll;width:100%;height:100vh}.title[_ngcontent-%COMP%]{font-size:2em;width:100%;font-weight:900;text-align:center;margin:20px 0}.info-container[_ngcontent-%COMP%]{width:80%;margin:10px;background-color:#000;border:1px solid #343434}.info-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .subtitle[_ngcontent-%COMP%]{text-align:center;width:100%}.subtitle[_ngcontent-%COMP%]{font-size:1.5em;font-weight:700}.close-modal[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;transition:.3s}.close-modal[_ngcontent-%COMP%]:hover{filter:drop-shadow(0 0 3px white)}"]}),Ut);function Ht(e,t){if(1&e&&p.Mb(0,"app-board-battler",17),2&e){var n=t.$implicit,r=p.Yb();p.mc("\n          left:",n.sm.values.x,"px;\n          top:",n.sm.values.y,"px;\n        "),p.bc("board",r.board)("profile",r.board.players.blue)("card",n)}}function qt(e,t){if(1&e&&p.Mb(0,"app-board-battler",17),2&e){var n=t.$implicit,r=p.Yb();p.mc("\n          left:",n.sm.values.x,"px;\n          top:",n.sm.values.y,"px;\n        "),p.bc("board",r.board)("profile",r.board.players.red)("card",n)}}function $t(e,t){if(1&e&&(p.Ob(0,"div",18),p.Mb(1,"app-board-deck",19),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.bc("board",n.board)("profile",n.board.players.red)("game",n.game)}}function Kt(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",20),p.Ob(1,"ion-img",21),p.Wb("click",(function(){return p.ic(n),p.Yb().closeDiceModal()})),p.Nb(),p.Mb(2,"app-dice-pool",22),p.Nb()}if(2&e){var r=p.Yb();p.zb(2),p.bc("profile",r.board.players.red)}}function Jt(e,t){if(1&e&&(p.Ob(0,"div",20),p.Mb(1,"ion-img",23),p.Mb(2,"app-matchmaking",24),p.Nb()),2&e){var n=p.Yb();p.zb(2),p.bc("board",n.board)("httpMessenger",n.httpMessenger)}}function Xt(e,t){if(1&e&&(p.Ob(0,"div",20),p.Mb(1,"app-card-collection",25),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.bc("httpMessenger",n.httpMessenger)("profile",n.board.players.red)("board",n.board)}}function Qt(e,t){if(1&e&&(p.Ob(0,"div",20),p.Mb(1,"app-card-full",26),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.bc("card",n.board.sm.values.cardInDisplay)("board",n.board)}}function Zt(e,t){if(1&e&&(p.Ob(0,"div",20),p.Mb(1,"ion-img",23),p.Mb(2,"app-auth-modal",27),p.Nb()),2&e){var n=p.Yb();p.zb(2),p.bc("httpMessenger",n.httpMessenger)("events",n.events)("profile",n.board.players.red)}}function en(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",30),p.Ob(1,"p"),p.oc(2,"Congratulations!"),p.Nb(),p.Ob(3,"p"),p.oc(4,"You won"),p.Nb(),p.Ob(5,"p"),p.oc(6,"\ud83e\udd73\ud83e\udd73\ud83e\udd73\ud83e\udd73\ud83e\udd73"),p.Nb(),p.Ob(7,"p"),p.oc(8),p.Nb(),p.Ob(9,"p"),p.oc(10),p.Nb(),p.Ob(11,"p"),p.oc(12,"\xa0"),p.Nb(),p.Ob(13,"p"),p.oc(14),p.Nb(),p.Ob(15,"p"),p.oc(16),p.Nb(),p.Ob(17,"p"),p.oc(18),p.Nb(),p.Ob(19,"p"),p.Ob(20,"ion-button",14),p.Wb("click",(function(){return p.ic(n),p.Yb(2).reload()})),p.oc(21," Back to Lobby "),p.Nb(),p.Nb(),p.Nb()}if(2&e){var r=p.Yb(2);p.zb(8),p.qc("+",r.board.sm.values.wonCoin," coins"),p.zb(2),p.qc("",r.board.players.red.sm.values.balance," coins"),p.zb(4),p.qc("+",r.board.sm.values.wonExp," EXP"),p.zb(2),p.rc("",r.board.players.red.sm.values.exp,"/",r.util.getExpToNextLevel(r.board.players.red.sm.values.lvl),""),p.zb(2),p.qc("LVL: ",r.board.players.red.sm.values.lvl,"")}}function tn(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",30),p.Ob(1,"p"),p.oc(2,"Bummer, you lost!"),p.Nb(),p.Ob(3,"p"),p.oc(4,"\ud83d\ude22\ud83d\ude22\ud83d\ude22\ud83d\ude22\ud83d\ude22"),p.Nb(),p.Ob(5,"p"),p.oc(6,"There are no rewards"),p.Nb(),p.Ob(7,"p"),p.Ob(8,"ion-button",14),p.Wb("click",(function(){return p.ic(n),p.Yb(2).reload()})),p.oc(9," Back to Lobby "),p.Nb(),p.Nb(),p.Nb()}}function nn(e,t){if(1&e&&(p.Ob(0,"div",28),p.nc(1,en,22,6,"div",29),p.nc(2,tn,10,0,"div",29),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.bc("ngIf",n.board.sm.values.isGameWon),p.zb(1),p.bc("ngIf",n.board.sm.values.isGameLost)}}function rn(e,t){if(1&e&&(p.Ob(0,"div",20),p.Mb(1,"app-help",31),p.Nb()),2&e){var n=p.Yb();p.zb(1),p.bc("board",n.board)}}function on(e,t){if(1&e){var n=p.Pb();p.Ob(0,"div",32),p.Ob(1,"div",33),p.Wb("click",(function(){return p.ic(n),p.Yb().scrollLeft()})),p.Mb(2,"ion-img",34),p.Nb(),p.Ob(3,"div",35),p.Wb("click",(function(){return p.ic(n),p.Yb().scrollRight()})),p.Mb(4,"ion-img",36),p.Nb(),p.Nb()}}function an(e,t){1&e&&p.Mb(0,"div",37)}var cn,sn,dn,ln=function(e){return{translucid:e}},pn=[{path:"",component:(cn=function(){function e(t){var n=this;_classCallCheck(this,e),this.util=s.j,this.events=s.d,this.isModalVisible=!1,this.email="",this.address="",this.balance=0,this.isDrawerVisible=!0,this.isCardCollectionModalVisible=!0,this.httpClient=t,this.httpMessenger=new s.f(this.httpClient),this.events.on("isDrawerVisible",(function(e){n.isDrawerVisible=!n.isDrawerVisible})),this.board=new s.a(this.events),this.board.players.red=new s.g(this.events,!0,this.httpMessenger),this.initializePaths(),this.board.players.blue=new s.g(this.events,!1,this.httpMessenger),this.isModalVisible=!0;var r=!1;this.board.events.on("handshakeFn",(function(e){return Object(c.a)(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("CPU"!==e.gameType){t.next=2;break}return t.abrupt("return",(r=!0,this.game=new d.b(this.board.players.red,e.opponent,this.board,!0),this.game.board.sm.disable("isP2PGame"),void this.game.board.sm.enable("isCPUGame")));case 2:if(t.t0="P2P"!==e.gameType||r,t.t0){t.next=10;break}return r=!0,t.next=7,this.board.players.red.p2p.connectToPeer(e.address);case 7:this.board.sm.enable("isP2PGame"),this.game=new d.b(this.board.players.red,e.blue,this.board,this.board.sm.values.isPlayerChallenging),this.board.game=this.game;case 10:case"end":return t.stop()}}),t,this)})))}))}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"triggerModal",value:function(){this.isModalVisible=!this.isModalVisible}},{key:"toggleDrawerMenu",value:function(){this.isDrawerVisible=!this.isDrawerVisible}},{key:"toggleCardCollectionModal",value:function(){this.isCardCollectionModalVisible=!this.isCardCollectionModalVisible}},{key:"closeDeckModal",value:function(){this.board.players.red.sm.disable("isModalVisible"),this.board.players.red.sm.disable("showBoardDeck")}},{key:"closeDiceModal",value:function(){this.board.players.red.sm.disable("isModalVisible"),this.board.players.red.sm.disable("showDicePool")}},{key:"testMint",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("testMint");case 1:case"end":return e.stop()}}),e)})))}},{key:"mouseOverToggle",value:function(e){document.querySelector("#board-deck-"+e.hash).classList.toggle("actionHover")}},{key:"closeCollectionModal",value:function(){this.board.players.red.sm.enable("deckReady")}},{key:"reload",value:function(){window.location.reload()}},{key:"logout",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.clear(),window.location.reload();case 1:case"end":return e.stop()}}),e)})))}},{key:"scrollRight",value:function(){document.querySelector("#main-container").scrollLeft+=.75*document.querySelector("body").clientWidth}},{key:"scrollLeft",value:function(){document.querySelector("#main-container").scrollLeft-=.75*document.querySelector("body").clientWidth}},{key:"scrollTop",value:function(){document.querySelector("#main-container").scrollTop-=document.querySelector("body").clientHeight/3}},{key:"scrollBottom",value:function(){document.querySelector("#main-container").scrollTop+=document.querySelector("body").clientHeight/3}},{key:"initializePaths",value:function(){var e=new l("Guardian Path",[],[]);this.board.players.red.sm.values.paths.push(e);var t=new l("Patron Path",[],[]);this.board.players.red.sm.values.paths.push(t);var n=new l("Forest Path",[],[]);this.board.players.red.sm.values.paths.push(n);var r=new l("Miner Path",[],[]);this.board.players.red.sm.values.paths.push(r)}}]),e}(),cn.\u0275fac=function(e){return new(e||cn)(p.Lb(u.a))},cn.\u0275cmp=p.Fb({type:cn,selectors:[["app-arena"]],decls:46,vars:21,consts:[["id","main-container",1,"main"],[3,"board","game"],[1,"board-battlers-container",3,"ngClass"],[3,"board","profile","card","style",4,"ngFor","ngForOf"],["class","player-red-deck",4,"ngIf"],[1,"menu-drawer",3,"ngClass"],[1,"info"],[3,"click"],[1,"button"],[1,"extra"],["class","modal",4,"ngIf"],["class","game-over-overlay",4,"ngIf"],[1,"splash"],["src","assets/spinner.gif",1,"spinner"],["color","transparent",3,"click"],["class","scroll-directions",4,"ngIf"],["class","p2p-click-blocker",4,"ngIf"],[3,"board","profile","card"],[1,"player-red-deck"],[3,"board","profile","game"],[1,"modal"],["src","assets/icons/cancel.png",1,"close-modal",3,"click"],[3,"profile"],["src","assets/icons/cancel.png",1,"close-modal"],[3,"board","httpMessenger"],[3,"httpMessenger","profile","board"],[3,"card","board"],[3,"httpMessenger","events","profile"],[1,"game-over-overlay"],["class","game-over",4,"ngIf"],[1,"game-over"],[3,"board"],[1,"scroll-directions"],[1,"direction","direction-left",3,"click"],["src","/assets/icons/left.png"],[1,"direction","direction-right",3,"click"],["src","/assets/icons/right.png"],[1,"p2p-click-blocker"]],template:function(e,t){1&e&&(p.Ob(0,"ion-content"),p.Ob(1,"div",0),p.Mb(2,"app-board",1),p.Ob(3,"div",2),p.nc(4,Ht,1,7,"app-board-battler",3),p.nc(5,qt,1,7,"app-board-battler",3),p.Nb(),p.nc(6,$t,2,3,"div",4),p.Nb(),p.Ob(7,"div",5),p.Ob(8,"ion-list"),p.Ob(9,"ion-item"),p.Ob(10,"ion-label",6),p.oc(11),p.Nb(),p.Nb(),p.Ob(12,"ion-item"),p.Ob(13,"ion-label",6),p.oc(14),p.Nb(),p.Nb(),p.Ob(15,"ion-item"),p.Ob(16,"ion-label",6),p.oc(17),p.Nb(),p.Nb(),p.Ob(18,"ion-item",7),p.Wb("click",(function(){return t.toggleCardCollectionModal()})),p.Ob(19,"ion-label",8),p.oc(20,"Card Collection"),p.Nb(),p.Nb(),p.Ob(21,"ion-item"),p.Ob(22,"ion-label",8),p.oc(23,"Get Booster Pack (300 coins)"),p.Nb(),p.Nb(),p.Ob(24,"ion-item"),p.Ob(25,"ion-label",9),p.oc(26,"Credits"),p.Nb(),p.Nb(),p.Ob(27,"ion-item",7),p.Wb("click",(function(){return t.logout()})),p.Ob(28,"ion-label",9),p.oc(29,"Log Out"),p.Nb(),p.Nb(),p.Ob(30,"ion-item",7),p.Wb("click",(function(){return t.toggleDrawerMenu()})),p.Ob(31,"ion-label",8),p.oc(32,"Close Menu"),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.nc(33,Kt,3,1,"div",10),p.nc(34,Jt,3,2,"div",10),p.nc(35,Xt,2,3,"div",10),p.nc(36,Qt,2,2,"div",10),p.nc(37,Zt,3,3,"div",10),p.nc(38,nn,3,2,"div",11),p.Ob(39,"div",12),p.Mb(40,"ion-img",13),p.Ob(41,"ion-button",14),p.Wb("click",(function(){return t.logout()})),p.oc(42," Log out "),p.Nb(),p.Nb(),p.nc(43,rn,2,1,"div",10),p.nc(44,on,5,0,"div",15),p.nc(45,an,1,0,"div",16)),2&e&&(p.zb(2),p.bc("board",t.board)("game",t.game),p.zb(1),p.bc("ngClass",p.fc(19,ln,t.board.players.red.sm.values.isActionActive)),p.zb(1),p.bc("ngForOf",t.board.players.blue.cardsCaboodle.getFiltered("isOnBoard",!0)),p.zb(1),p.bc("ngForOf",t.board.players.red.cardsCaboodle.getFiltered("isOnBoard",!0)),p.zb(1),p.bc("ngIf",t.board.players.red.sm.values.deckReady),p.zb(1),p.bc("ngClass",t.board.players.red.sm.values.isDrawerVisible?"visible":"hidden"),p.zb(4),p.pc(t.board.players.red.sm.values.address),p.zb(3),p.pc(t.board.players.red.sm.values.email),p.zb(3),p.qc("",t.board.players.red.sm.values.balance," coins"),p.zb(16),p.bc("ngIf",t.board.players.red.sm.values.isModalVisible&&t.board.players.red.sm.values.showDicePool),p.zb(1),p.bc("ngIf",t.board.players.red.sm.values.isModalVisible&&!t.board.players.red.sm.values.isPlaying),p.zb(1),p.bc("ngIf",t.board.players.red.sm.values.isModalVisible&&!t.board.players.red.sm.values.deckReady),p.zb(1),p.bc("ngIf",t.board.players.red.sm.values.isLoggedIn&&t.board.sm.values.cardInDisplay),p.zb(1),p.bc("ngIf",t.board.players.red.sm.values.isModalVisible&&!t.board.players.red.sm.values.isLoggedIn),p.zb(1),p.bc("ngIf",t.board.sm.values.isGameEnded),p.zb(5),p.bc("ngIf",t.board.sm.values.showHelp),p.zb(1),p.bc("ngIf",t.board.sm.values.isGameStarted),p.zb(1),p.bc("ngIf",t.game&&t.game.board.sm.values.blockP2PClick))},directives:[o.c,ue,r.h,r.i,r.j,o.g,o.e,o.f,o.d,o.b,Pe,Re,Ie,yt,Tt,Bt,Gt,Vt],styles:[".dice-container[_ngcontent-%COMP%]{justify-content:center;height:100px}.dice-container[_ngcontent-%COMP%], .main[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.main[_ngcontent-%COMP%]{position:relative;height:100%;justify-content:space-between;flex-direction:column}app-board[_ngcontent-%COMP%]{margin-top:100px}.modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:rgba(0,0,0,.9);display:flex;justify-content:center;align-items:center}.player-red-deck[_ngcontent-%COMP%]{pointer-events:none;position:absolute;bottom:0;left:0;width:100vw;height:256px}.close-modal[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;transition:.3s}.close-modal[_ngcontent-%COMP%]:hover{filter:drop-shadow(0 0 3px white)}.menu-drawer[_ngcontent-%COMP%]{transition:.3s;position:fixed;top:0;left:0;width:400px;max-width:100%;height:100vh;background-color:#232323;box-shadow:0 0 30px #000}.menu-drawer.visible[_ngcontent-%COMP%]{transform:translateX(0)}.menu-drawer.hidden[_ngcontent-%COMP%]{transform:translateX(-400px)}.info[_ngcontent-%COMP%]{border:1px solid #000}.button[_ngcontent-%COMP%], .info[_ngcontent-%COMP%]{text-align:center;padding:10px 0}.button[_ngcontent-%COMP%]{border:1px solid #fff}.extra[_ngcontent-%COMP%]{text-align:center}app-board-battler[_ngcontent-%COMP%]{position:absolute;transition:.3s}.board-battlers-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;pointer-events:none;width:100vw;height:100vh}.action-container[_ngcontent-%COMP%]{position:fixed;top:0;width:350px;background-color:rgba(0,0,0,.8);height:100%;left:0;overflow-y:scroll}.action-container[_ngcontent-%COMP%], .action-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.action-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{margin:10px 0;border:1px solid #fff;background-color:#000;color:#fff;width:140px;padding:20px 0}.action-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .simple-text[_ngcontent-%COMP%]{text-align:center}.action-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.action-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .card-action[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}.action-container[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]   .card-action-item[_ngcontent-%COMP%]{border:1px solid #fff;width:80%;left:10%;position:relative}.cast-action[_ngcontent-%COMP%]{background-color:#454545}.move-action[_ngcontent-%COMP%]{background-color:#01579b}.battle-action[_ngcontent-%COMP%]{background-color:#b71c1c}.cant-click[_ngcontent-%COMP%]{color:#5e5e5e}.translucid[_ngcontent-%COMP%]{opacity:.5}.splash[_ngcontent-%COMP%]{position:fixed;width:100vw;height:100vh;top:0;left:0;z-index:9999999;background-color:#343434;background-image:url(/assets/backgrounds/loading.jpg);background-size:cover;background-position:50%;display:flex;justify-content:center;align-items:center;flex-direction:column;opacity:1;visibility:visible;transition:.5s}.splash.hide[_ngcontent-%COMP%]{opacity:0;visibility:hidden}.spinner[_ngcontent-%COMP%]{width:128px;height:128px;background-color:#fff;border-radius:100%}.game-over-overlay[_ngcontent-%COMP%]{font-size:1.6em;position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#000;color:#fff;z-index:9.999999999999999e+42}.game-over[_ngcontent-%COMP%], .game-over-overlay[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column}.game-over[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center}.scroll-directions[_ngcontent-%COMP%]{display:none}@media only screen and (max-width:1550px){#main-container[_ngcontent-%COMP%]{width:100vw;overflow-x:scroll;overflow-y:scroll;align-items:flex-start;justify-content:flex-start;height:100vh}.energy-pool[_ngcontent-%COMP%]{left:0}app-board[_ngcontent-%COMP%]{margin-left:240px;height:150vh}.player-red-deck[_ngcontent-%COMP%]{position:fixed}.scroll-directions[_ngcontent-%COMP%]{display:block;position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none}.scroll-directions[_ngcontent-%COMP%]   .direction[_ngcontent-%COMP%]{width:64px;height:64px;position:absolute;pointer-events:all}.scroll-directions[_ngcontent-%COMP%]   .direction[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{filter:drop-shadow(0 0 5px black)}.scroll-directions[_ngcontent-%COMP%]   .direction-left[_ngcontent-%COMP%]{left:5px;top:calc(50vh - 32px)}.scroll-directions[_ngcontent-%COMP%]   .direction-top[_ngcontent-%COMP%]{top:5px;left:calc(50vw - 32px)}.scroll-directions[_ngcontent-%COMP%]   .direction-right[_ngcontent-%COMP%]{right:5px;top:calc(50vh - 32px)}.scroll-directions[_ngcontent-%COMP%]   .direction-bottom[_ngcontent-%COMP%]{bottom:5px;left:calc(50vw - 32px)}}.main[_ngcontent-%COMP%]{scroll-behavior:smooth}.p2p-click-blocker[_ngcontent-%COMP%]{position:fixed;z-index:99999;background-color:rgba(168,50,147,0);top:0;left:0;width:100vw;height:100vh}"]}),cn)}],un=((sn=function e(){_classCallCheck(this,e)}).\u0275mod=p.Jb({type:sn}),sn.\u0275inj=p.Ib({factory:function(e){return new(e||sn)},imports:[[a.i.forChild(pn)],a.i]}),sn),fn=n("j1ZV"),bn=((dn=function e(){_classCallCheck(this,e)}).\u0275mod=p.Jb({type:dn}),dn.\u0275inj=p.Ib({factory:function(e){return new(e||dn)},imports:[[r.b,i.a,o.i,un,fn.a]]}),dn)}}]);